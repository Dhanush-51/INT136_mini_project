[0m09:49:22.989732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BC759EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BC75A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BC759C70>]}


============================== 09:49:22.995732 | 3ec2b9fc-b3d5-4291-abe5-ba8abbafe36c ==============================
[0m09:49:22.995732 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:49:22.996732 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:49:22.997698 [info ] [MainThread]: dbt version: 1.7.4
[0m09:49:22.997698 [info ] [MainThread]: python version: 3.12.9
[0m09:49:22.998734 [info ] [MainThread]: python path: c:\Users\TottaraDhanush\DBT\.venv\Scripts\python.exe
[0m09:49:22.999698 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m09:49:23.004709 [info ] [MainThread]: Using profiles dir at C:\Users\TottaraDhanush\.dbt
[0m09:49:23.005769 [info ] [MainThread]: Using profiles.yml file at C:\Users\TottaraDhanush\.dbt\profiles.yml
[0m09:49:23.006712 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\TottaraDhanush\DBT\mini_project_dbt\dbt_project.yml
[0m09:49:23.101325 [info ] [MainThread]: Configuration:
[0m09:49:23.102360 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m09:49:23.103349 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:49:23.104281 [info ] [MainThread]: Required dependencies:
[0m09:49:23.105318 [debug] [MainThread]: Executing "git --help"
[0m09:49:23.211857 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:49:23.211857 [debug] [MainThread]: STDERR: "b''"
[0m09:49:23.212854 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:49:23.213854 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:49:23.213854 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:49:23.214855 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'mini_project_dbt'


[0m09:49:23.215855 [debug] [MainThread]: Command `dbt debug` failed at 09:49:23.215855 after 0.35 seconds
[0m09:49:23.216856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BB89A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BC2D5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254BC12D100>]}
[0m09:49:23.216856 [debug] [MainThread]: Flushing usage events
[0m09:50:48.125230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001698761A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001698761A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001698761A450>]}


============================== 09:50:48.136236 | 55b1eeff-c832-4418-a7f6-ba42b0649e0d ==============================
[0m09:50:48.136236 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:50:48.137204 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m09:50:48.138238 [info ] [MainThread]: dbt version: 1.7.4
[0m09:50:48.139239 [info ] [MainThread]: python version: 3.12.9
[0m09:50:48.139239 [info ] [MainThread]: python path: c:\Users\TottaraDhanush\DBT\.venv\Scripts\python.exe
[0m09:50:48.140240 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m09:50:48.850845 [info ] [MainThread]: Using profiles dir at C:\Users\TottaraDhanush\.dbt
[0m09:50:48.851846 [info ] [MainThread]: Using profiles.yml file at C:\Users\TottaraDhanush\.dbt\profiles.yml
[0m09:50:48.852813 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\TottaraDhanush\DBT\mini_project_dbt\dbt_project.yml
[0m09:50:48.854862 [info ] [MainThread]: adapter type: snowflake
[0m09:50:48.854862 [info ] [MainThread]: adapter version: 1.7.1
[0m09:50:48.956469 [info ] [MainThread]: Configuration:
[0m09:50:48.957437 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:50:48.957437 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:50:48.958437 [info ] [MainThread]: Required dependencies:
[0m09:50:48.959439 [debug] [MainThread]: Executing "git --help"
[0m09:50:49.169481 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:50:49.170480 [debug] [MainThread]: STDERR: "b''"
[0m09:50:49.171481 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:50:49.172480 [info ] [MainThread]: Connection:
[0m09:50:49.172480 [info ] [MainThread]:   account: RAQAING-LZ14569
[0m09:50:49.173483 [info ] [MainThread]:   user: Dhanush22
[0m09:50:49.174482 [info ] [MainThread]:   database: MINI_PROJECT_OUTPUT_DB
[0m09:50:49.174482 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m09:50:49.175481 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:50:49.175481 [info ] [MainThread]:   schema: PUBLIC
[0m09:50:49.176481 [info ] [MainThread]:   authenticator: None
[0m09:50:49.177482 [info ] [MainThread]:   private_key_path: None
[0m09:50:49.178481 [info ] [MainThread]:   token: None
[0m09:50:49.178481 [info ] [MainThread]:   oauth_client_id: None
[0m09:50:49.179483 [info ] [MainThread]:   query_tag: None
[0m09:50:49.180488 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:50:49.181482 [info ] [MainThread]:   host: None
[0m09:50:49.182480 [info ] [MainThread]:   port: None
[0m09:50:49.182480 [info ] [MainThread]:   proxy_host: None
[0m09:50:49.184484 [info ] [MainThread]:   proxy_port: None
[0m09:50:49.185485 [info ] [MainThread]:   protocol: None
[0m09:50:49.186486 [info ] [MainThread]:   connect_retries: 1
[0m09:50:49.187484 [info ] [MainThread]:   connect_timeout: None
[0m09:50:49.188487 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:50:49.189482 [info ] [MainThread]:   retry_all: False
[0m09:50:49.190483 [info ] [MainThread]:   insecure_mode: False
[0m09:50:49.191482 [info ] [MainThread]:   reuse_connections: None
[0m09:50:49.191482 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:50:49.192483 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:50:49.193482 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:50:49.194480 [debug] [MainThread]: On debug: select 1 as id
[0m09:50:49.194480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:50.828284 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:50:50.829284 [debug] [MainThread]: On debug: Close
[0m09:50:50.968942 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:50:50.969945 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:50:50.970943 [debug] [MainThread]: Command `dbt debug` succeeded at 09:50:50.970943 after 2.96 seconds
[0m09:50:50.970943 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:50:50.971977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169874F9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016987647500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001698732F320>]}
[0m09:50:50.971977 [debug] [MainThread]: Flushing usage events
[0m09:53:23.132450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97D592570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97D592870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97D5920F0>]}


============================== 09:53:23.145920 | a9590d0a-7d21-4b94-b70a-a8aa9bcc0c1b ==============================
[0m09:53:23.145920 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:53:23.146921 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m09:53:23.147921 [info ] [MainThread]: dbt version: 1.7.4
[0m09:53:23.147921 [info ] [MainThread]: python version: 3.12.9
[0m09:53:23.148921 [info ] [MainThread]: python path: c:\Users\TottaraDhanush\DBT\.venv\Scripts\python.exe
[0m09:53:23.149921 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m09:53:23.821916 [info ] [MainThread]: Using profiles dir at C:\Users\TottaraDhanush\.dbt
[0m09:53:23.822919 [info ] [MainThread]: Using profiles.yml file at C:\Users\TottaraDhanush\.dbt\profiles.yml
[0m09:53:23.823918 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\TottaraDhanush\DBT\mini_project_dbt\dbt_project.yml
[0m09:53:23.824918 [info ] [MainThread]: adapter type: snowflake
[0m09:53:23.825919 [info ] [MainThread]: adapter version: 1.7.1
[0m09:53:23.949689 [info ] [MainThread]: Configuration:
[0m09:53:23.949689 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:53:23.950689 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:53:23.951688 [info ] [MainThread]: Required dependencies:
[0m09:53:23.952688 [debug] [MainThread]: Executing "git --help"
[0m09:53:24.142722 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:53:24.143732 [debug] [MainThread]: STDERR: "b''"
[0m09:53:24.143732 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:53:24.144735 [info ] [MainThread]: Connection:
[0m09:53:24.145730 [info ] [MainThread]:   account: RAQAING-LZ14569
[0m09:53:24.145730 [info ] [MainThread]:   user: Dhanush22
[0m09:53:24.146730 [info ] [MainThread]:   database: MINI_PROJECT_OUTPUT_DB
[0m09:53:24.146730 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m09:53:24.147730 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:53:24.148730 [info ] [MainThread]:   schema: PUBLIC
[0m09:53:24.148730 [info ] [MainThread]:   authenticator: None
[0m09:53:24.149730 [info ] [MainThread]:   private_key_path: None
[0m09:53:24.150730 [info ] [MainThread]:   token: None
[0m09:53:24.151732 [info ] [MainThread]:   oauth_client_id: None
[0m09:53:24.152730 [info ] [MainThread]:   query_tag: None
[0m09:53:24.152730 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:53:24.153731 [info ] [MainThread]:   host: None
[0m09:53:24.154730 [info ] [MainThread]:   port: None
[0m09:53:24.155731 [info ] [MainThread]:   proxy_host: None
[0m09:53:24.157735 [info ] [MainThread]:   proxy_port: None
[0m09:53:24.158745 [info ] [MainThread]:   protocol: None
[0m09:53:24.159731 [info ] [MainThread]:   connect_retries: 1
[0m09:53:24.160730 [info ] [MainThread]:   connect_timeout: None
[0m09:53:24.160730 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:53:24.161736 [info ] [MainThread]:   retry_all: False
[0m09:53:24.161736 [info ] [MainThread]:   insecure_mode: False
[0m09:53:24.162731 [info ] [MainThread]:   reuse_connections: None
[0m09:53:24.163730 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:53:24.164732 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:53:24.165732 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:53:24.166731 [debug] [MainThread]: On debug: select 1 as id
[0m09:53:24.166731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:25.545835 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:53:25.546835 [debug] [MainThread]: On debug: Close
[0m09:53:25.711355 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:53:25.713357 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:53:25.715357 [debug] [MainThread]: Command `dbt debug` succeeded at 09:53:25.715357 after 2.69 seconds
[0m09:53:25.716357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:53:25.716357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97D1BF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97E667260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A97D5B5BB0>]}
[0m09:53:25.717356 [debug] [MainThread]: Flushing usage events
[0m10:12:59.979008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F51ADA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F51AD9A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F51AD98E0>]}


============================== 10:12:59.993621 | 59d64639-761d-4261-a460-63ad8be1f830 ==============================
[0m10:12:59.993621 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:12:59.995425 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m10:13:01.069113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53626FF0>]}
[0m10:13:01.174702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53593BC0>]}
[0m10:13:01.176706 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:13:01.199765 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:13:01.201734 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:13:01.202672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53593BC0>]}
[0m10:13:03.668465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m10:13:03.675763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53928CB0>]}
[0m10:13:03.718265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53928680>]}
[0m10:13:03.718265 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:13:03.719282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F539D78F0>]}
[0m10:13:03.722103 [info ] [MainThread]: 
[0m10:13:03.723079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:03.725086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:13:03.742119 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:13:03.742119 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:13:03.743121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:04.878179 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:13:04.880179 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:13:05.019295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_PUBLIC'
[0m10:13:05.029296 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_PUBLIC"
[0m10:13:05.030299 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_PUBLIC"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.PUBLIC limit 10000
[0m10:13:05.030299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:05.561731 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:13:05.562705 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_PUBLIC: Close
[0m10:13:05.709076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53ABD700>]}
[0m10:13:05.710077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:13:05.711076 [info ] [MainThread]: 
[0m10:13:05.719151 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:13:05.720152 [info ] [Thread-1 (]: 1 of 4 START sql table model PUBLIC.staging_country_region ..................... [RUN]
[0m10:13:05.722158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:13:05.722158 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:13:05.733149 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:13:05.737152 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:13:05.723150 => 10:13:05.736152
[0m10:13:05.737152 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:13:05.773476 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:13:05.777474 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:13:05.777474 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.PUBLIC.staging_country_region
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        COUNTRY,
        REGION
    FROM raw_data.public.COUNTRY_REGION_TABLE
)

SELECT * FROM source
        );
[0m10:13:05.778511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:07.221669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:13:07.244669 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:13:05.738151 => 10:13:07.243669
[0m10:13:07.244669 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:13:07.383629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53D571A0>]}
[0m10:13:07.384629 [info ] [Thread-1 (]: 1 of 4 OK created sql table model PUBLIC.staging_country_region ................ [[32mSUCCESS 1[0m in 1.66s]
[0m10:13:07.385626 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:13:07.386627 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:13:07.386627 [info ] [Thread-1 (]: 2 of 4 START sql table model PUBLIC.staging_customers_table .................... [RUN]
[0m10:13:07.388627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:13:07.388627 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:13:07.391629 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:13:07.393627 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:13:07.388627 => 10:13:07.392626
[0m10:13:07.393627 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:13:07.397628 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:13:07.398628 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:13:07.399628 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.PUBLIC.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:13:07.399628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:08.616021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:13:08.619054 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:13:07.394630 => 10:13:08.619054
[0m10:13:08.619054 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:13:08.757096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53D707D0>]}
[0m10:13:08.758095 [info ] [Thread-1 (]: 2 of 4 OK created sql table model PUBLIC.staging_customers_table ............... [[32mSUCCESS 1[0m in 1.37s]
[0m10:13:08.759068 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:13:08.760093 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:13:08.760093 [info ] [Thread-1 (]: 3 of 4 START sql table model PUBLIC.staging_products_table ..................... [RUN]
[0m10:13:08.762129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:13:08.762129 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:13:08.765102 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:13:08.767106 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:13:08.762129 => 10:13:08.766128
[0m10:13:08.767106 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:13:08.771132 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:13:08.773102 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:13:08.774127 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.PUBLIC.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:13:08.774127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:09.738557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:13:09.741558 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:13:08.768103 => 10:13:09.740557
[0m10:13:09.741558 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:13:09.889088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53D70FB0>]}
[0m10:13:09.890088 [info ] [Thread-1 (]: 3 of 4 OK created sql table model PUBLIC.staging_products_table ................ [[32mSUCCESS 1[0m in 1.13s]
[0m10:13:09.891089 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:13:09.891089 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:13:09.892088 [info ] [Thread-1 (]: 4 of 4 START sql table model PUBLIC.staging_transactions_table ................. [RUN]
[0m10:13:09.893087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:13:09.894088 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:13:09.897087 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:13:09.899095 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:13:09.894088 => 10:13:09.898087
[0m10:13:09.899095 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:13:09.902090 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:13:09.904090 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:13:09.905089 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.PUBLIC.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:13:09.905089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:11.148797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:13:11.151832 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:13:09.899095 => 10:13:11.151832
[0m10:13:11.152796 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:13:11.286900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d64639-761d-4261-a460-63ad8be1f830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F53E33F50>]}
[0m10:13:11.286900 [info ] [Thread-1 (]: 4 of 4 OK created sql table model PUBLIC.staging_transactions_table ............ [[32mSUCCESS 1[0m in 1.39s]
[0m10:13:11.288902 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:13:11.290904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:11.290904 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:13:11.291926 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_PUBLIC' was properly closed.
[0m10:13:11.291926 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m10:13:11.292928 [info ] [MainThread]: 
[0m10:13:11.292928 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m10:13:11.294902 [debug] [MainThread]: Command end result
[0m10:13:11.305902 [info ] [MainThread]: 
[0m10:13:11.307926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:11.308916 [info ] [MainThread]: 
[0m10:13:11.309906 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:13:11.310916 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:11.310916 after 11.46 seconds
[0m10:13:11.311901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F50C35100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5192BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F519678F0>]}
[0m10:13:11.311901 [debug] [MainThread]: Flushing usage events
[0m10:14:09.733663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AFC9A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AFC9A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AFC9A180>]}


============================== 10:14:09.739697 | 6990b799-9546-41ff-a70e-45d9103a7d24 ==============================
[0m10:14:09.739697 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:14:09.740700 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:14:10.284459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B17DF440>]}
[0m10:14:10.392075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B17824B0>]}
[0m10:14:10.393436 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:14:10.404443 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:14:10.430090 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:14:10.431093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1985B50>]}
[0m10:14:11.674507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m10:14:11.680540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1CF5A00>]}
[0m10:14:11.692523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1BA3830>]}
[0m10:14:11.692523 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:14:11.693509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1C6B0B0>]}
[0m10:14:11.695541 [info ] [MainThread]: 
[0m10:14:11.697507 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:14:11.700508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:14:11.717506 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:14:11.717506 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:14:11.718542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:13.331389 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m10:14:13.333390 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:14:13.474480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB, now create_MINI_PROJECT_OUTPUT_DB_staging)
[0m10:14:13.475507 [debug] [ThreadPool]: Creating schema "database: "MINI_PROJECT_OUTPUT_DB"
schema: "staging"
"
[0m10:14:13.481483 [debug] [ThreadPool]: Using snowflake connection "create_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:14:13.482480 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "create_MINI_PROJECT_OUTPUT_DB_staging"} */
create schema if not exists MINI_PROJECT_OUTPUT_DB.staging
[0m10:14:13.482480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:13.891257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:14:13.893257 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:14:14.065866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m10:14:14.075867 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:14:14.076866 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:14:14.076866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:14.605822 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m10:14:14.607855 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:14:14.746832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B18C6150>]}
[0m10:14:14.747826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:14:14.748804 [info ] [MainThread]: 
[0m10:14:14.753371 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:14:14.753371 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.staging_country_region .................... [RUN]
[0m10:14:14.755360 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:14:14.756345 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:14:14.766378 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:14:14.767345 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:14:14.756345 => 10:14:14.767345
[0m10:14:14.768350 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:14:14.808344 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:14:14.811345 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:14:14.811345 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        COUNTRY,
        REGION
    FROM raw_data.public.COUNTRY_REGION_TABLE
)

SELECT * FROM source
        );
[0m10:14:14.812377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:14:15.994290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:14:16.016318 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:14:14.769346 => 10:14:16.016318
[0m10:14:16.017290 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:14:16.164719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B200BE00>]}
[0m10:14:16.165689 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.41s]
[0m10:14:16.166687 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:14:16.167687 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:14:16.168179 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:14:16.168796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:14:16.169833 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:14:16.172803 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:14:16.174801 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:14:16.169833 => 10:14:16.174801
[0m10:14:16.175803 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:14:16.179807 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:14:16.182803 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:14:16.183849 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:14:16.183849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:17.454661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:14:17.457687 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:14:16.175803 => 10:14:17.457687
[0m10:14:17.457687 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:14:17.597249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1FE1580>]}
[0m10:14:17.598248 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.43s]
[0m10:14:17.599251 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:14:17.600250 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:14:17.600250 [info ] [Thread-1 (]: 3 of 4 START sql table model staging.staging_products_table .................... [RUN]
[0m10:14:17.601257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:14:17.602287 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:14:17.605282 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:14:17.607311 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:14:17.602287 => 10:14:17.606284
[0m10:14:17.607311 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:14:17.611251 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:14:17.612251 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:14:17.613281 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:14:17.613281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:18.843036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:14:18.846035 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:14:17.608285 => 10:14:18.845036
[0m10:14:18.846035 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:14:18.985938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1FDFCB0>]}
[0m10:14:18.986938 [info ] [Thread-1 (]: 3 of 4 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.38s]
[0m10:14:18.988941 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:14:18.988941 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:14:18.989941 [info ] [Thread-1 (]: 4 of 4 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:14:18.991940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:14:18.991940 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:14:18.994977 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:14:18.995977 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:14:18.991940 => 10:14:18.995977
[0m10:14:18.996940 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:14:18.999974 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:14:19.001942 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:14:19.002968 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:14:19.002968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:19.911517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:14:19.914517 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:14:18.996940 => 10:14:19.913516
[0m10:14:19.914517 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:14:20.054294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6990b799-9546-41ff-a70e-45d9103a7d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B1FDFBF0>]}
[0m10:14:20.055826 [info ] [Thread-1 (]: 4 of 4 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.06s]
[0m10:14:20.057831 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:14:20.059832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:20.059832 [debug] [MainThread]: Connection 'create_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:14:20.060830 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:14:20.060830 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m10:14:20.061858 [info ] [MainThread]: 
[0m10:14:20.061858 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m10:14:20.064833 [debug] [MainThread]: Command end result
[0m10:14:20.077861 [info ] [MainThread]: 
[0m10:14:20.078854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:20.079842 [info ] [MainThread]: 
[0m10:14:20.080835 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:14:20.082833 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:20.081832 after 10.45 seconds
[0m10:14:20.082833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AF738680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AF9DF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219AFA424B0>]}
[0m10:14:20.083832 [debug] [MainThread]: Flushing usage events
[0m10:20:43.989804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B5AAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B5AA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B5AA210>]}


============================== 10:20:44.001910 | 68b01d7f-87d0-4547-82b1-e8e084efc5a0 ==============================
[0m10:20:44.001910 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:20:44.002937 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:20:44.981550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B605C10>]}
[0m10:20:45.096050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33BE4AFF0>]}
[0m10:20:45.097430 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:20:45.119437 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:20:45.151262 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:20:45.152261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B606F90>]}
[0m10:20:47.728545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D37D4C0>]}
[0m10:20:47.754006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D25B650>]}
[0m10:20:47.755005 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:20:47.756005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D287440>]}
[0m10:20:47.758003 [info ] [MainThread]: 
[0m10:20:47.760005 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:20:47.761005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:20:47.777523 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:20:47.777523 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:20:47.778523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:49.018286 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:20:49.020286 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:20:49.163189 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:20:49.163189 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:20:49.164189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:49.687318 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:20:49.688318 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:20:49.829890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB, now create_MINI_PROJECT_OUTPUT_DB_mart)
[0m10:20:49.830888 [debug] [ThreadPool]: Creating schema "database: "MINI_PROJECT_OUTPUT_DB"
schema: "mart"
"
[0m10:20:49.837889 [debug] [ThreadPool]: Using snowflake connection "create_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:20:49.837889 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "create_MINI_PROJECT_OUTPUT_DB_mart"} */
create schema if not exists MINI_PROJECT_OUTPUT_DB.mart
[0m10:20:49.838886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:50.401278 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:50.402278 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:20:50.548382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_mart'
[0m10:20:50.558424 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:20:50.559456 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:20:50.559456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:50.939790 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:20:50.941791 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:20:51.079633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_mart, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m10:20:51.082658 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:20:51.083855 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:20:51.083855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:51.616972 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:20:51.618973 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:20:51.760476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D712AE0>]}
[0m10:20:51.762471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:51.763489 [info ] [MainThread]: 
[0m10:20:51.768329 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:20:51.769330 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:20:51.770328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:20:51.770328 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:20:51.780848 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:20:51.782847 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:20:51.770328 => 10:20:51.782847
[0m10:20:51.783849 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:20:51.826881 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:20:51.829844 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:20:51.829844 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        COUNTRY,
        REGION
    FROM raw_data.public.COUNTRY_REGION_TABLE
)

SELECT * FROM source
        );
[0m10:20:51.830842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:20:52.702388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:52.729386 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:20:51.783849 => 10:20:52.729386
[0m10:20:52.730388 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:20:52.865605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D89F860>]}
[0m10:20:52.866593 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.10s]
[0m10:20:52.868609 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:20:52.868609 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:20:52.869626 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:20:52.870590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:20:52.871593 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:20:52.874831 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:20:52.875817 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:20:52.871593 => 10:20:52.874831
[0m10:20:52.876804 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:20:52.879806 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:20:52.881803 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:20:52.882838 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:20:52.882838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:53.645851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:53.648851 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:20:52.876804 => 10:20:53.648851
[0m10:20:53.649870 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:20:54.059737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D8A5490>]}
[0m10:20:54.060711 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.19s]
[0m10:20:54.061384 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:20:54.062430 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:20:54.062430 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:20:54.063418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:20:54.064420 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:20:54.068415 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:20:54.069416 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:20:54.064420 => 10:20:54.069416
[0m10:20:54.069416 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:20:54.072416 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:20:54.074955 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:20:54.074955 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:20:54.075991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:55.067764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:55.070764 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:20:54.070417 => 10:20:55.070764
[0m10:20:55.071764 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:20:55.213898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D85C2C0>]}
[0m10:20:55.214934 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.15s]
[0m10:20:55.215899 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:20:55.216898 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:20:55.216898 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:20:55.218900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:20:55.218900 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:20:55.222899 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:20:55.223918 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:20:55.219933 => 10:20:55.223918
[0m10:20:55.224898 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:20:55.227900 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:20:55.229914 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:20:55.230898 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:20:55.230898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:56.117240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:56.120242 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:20:55.224898 => 10:20:56.120242
[0m10:20:56.121240 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:20:56.257936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D8A7E00>]}
[0m10:20:56.257936 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.04s]
[0m10:20:56.259247 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:20:56.260293 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:20:56.261332 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:20:56.262340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:20:56.262340 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:20:56.268334 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:20:56.270301 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:20:56.263333 => 10:20:56.269298
[0m10:20:56.270301 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:20:56.274302 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:20:56.278832 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:20:56.278832 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:20:56.279866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:57.073058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:20:57.076022 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:20:56.271340 => 10:20:57.076022
[0m10:20:57.077039 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:20:57.212083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b01d7f-87d0-4547-82b1-e8e084efc5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33D789D30>]}
[0m10:20:57.213081 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m10:20:57.214081 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:20:57.216082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:57.217082 [debug] [MainThread]: Connection 'create_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m10:20:57.217082 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:20:57.217082 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:20:57.218080 [info ] [MainThread]: 
[0m10:20:57.219081 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m10:20:57.221083 [debug] [MainThread]: Command end result
[0m10:20:57.231081 [info ] [MainThread]: 
[0m10:20:57.232081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:57.233110 [info ] [MainThread]: 
[0m10:20:57.234115 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:20:57.236116 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:57.235082 after 13.37 seconds
[0m10:20:57.236116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B478650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B5AA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33B5AAE40>]}
[0m10:20:57.237115 [debug] [MainThread]: Flushing usage events
[0m10:26:35.478053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C7240B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C7240B1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C72408920>]}


============================== 10:26:35.484045 | a015158d-aedd-47c0-b645-dd2a9753e442 ==============================
[0m10:26:35.484045 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:26:35.486012 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m10:26:36.039212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C73DEEFF0>]}
[0m10:26:36.144849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C71237EC0>]}
[0m10:26:36.146659 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:26:36.156695 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:26:36.265746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:36.266747 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\mart\customer_churn.sql
[0m10:26:36.430888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C743819A0>]}
[0m10:26:36.442889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C741D02C0>]}
[0m10:26:36.443889 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:26:36.444917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C74059370>]}
[0m10:26:36.446925 [info ] [MainThread]: 
[0m10:26:36.448930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:36.449923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:26:36.466890 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:26:36.467925 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:26:36.467925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:37.632895 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:26:37.634896 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:26:37.778562 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:26:37.779562 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:26:37.779562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:38.171075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:26:38.173076 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:26:38.311184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m10:26:38.320768 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:26:38.320768 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:26:38.320768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:38.844400 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:26:38.846400 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:26:38.993532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m10:26:38.997537 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:26:38.997537 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:26:38.998538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:39.367534 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:26:39.369533 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:26:39.507641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C74382870>]}
[0m10:26:39.508677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:39.509645 [info ] [MainThread]: 
[0m10:26:39.514233 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:26:39.514233 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:26:39.516158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:26:39.516158 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:26:39.525191 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:26:39.526187 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:26:39.517187 => 10:26:39.526187
[0m10:26:39.527159 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:26:39.568158 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:26:39.570158 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:26:39.571159 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        COUNTRY,
        REGION
    FROM raw_data.public.COUNTRY_REGION_TABLE
)

SELECT * FROM source
        );
[0m10:26:39.571159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:26:40.736740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:40.760772 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:26:39.527159 => 10:26:40.759774
[0m10:26:40.760772 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:26:40.899696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C74439880>]}
[0m10:26:40.900701 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.38s]
[0m10:26:40.901702 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:26:40.902704 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:26:40.902704 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:26:40.904702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:26:40.904702 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:26:40.907702 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:26:40.908701 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:26:40.904702 => 10:26:40.908701
[0m10:26:40.909712 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:26:40.912701 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:26:40.913701 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:26:40.915208 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:26:40.916217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:41.691804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:41.694805 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:26:40.909712 => 10:26:41.693804
[0m10:26:41.694805 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:26:41.831018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C746ADD60>]}
[0m10:26:41.832020 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 0.93s]
[0m10:26:41.832986 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:26:41.834018 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:26:41.834018 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:26:41.835990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:26:41.835990 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:26:41.839019 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:26:41.840985 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:26:41.837018 => 10:26:41.840030
[0m10:26:41.840985 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:26:41.902059 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:26:41.903023 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:26:41.904057 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:26:41.904057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:42.665425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:42.667423 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:26:41.840985 => 10:26:42.667423
[0m10:26:42.668423 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:26:42.806786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C742A0E00>]}
[0m10:26:42.806786 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 0.97s]
[0m10:26:42.808789 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:26:42.808789 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:26:42.809789 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:26:42.810787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:26:42.811787 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:26:42.814818 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:26:42.816325 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:26:42.811787 => 10:26:42.816325
[0m10:26:42.817335 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:26:42.820362 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:26:42.823361 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:26:42.823361 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:26:42.824364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:43.739279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:43.741279 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:26:42.817335 => 10:26:43.741279
[0m10:26:43.742279 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:26:43.880922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C7431BE60>]}
[0m10:26:43.880922 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.07s]
[0m10:26:43.882923 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:26:43.882923 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:26:43.883924 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:26:43.884925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:26:43.885922 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:26:43.888923 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:26:43.890937 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:26:43.885922 => 10:26:43.889923
[0m10:26:43.890937 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:26:43.893957 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:26:43.895960 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:26:43.895960 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -1, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:26:43.896957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:44.870015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:26:44.873016 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:26:43.890937 => 10:26:44.872015
[0m10:26:44.873016 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:26:45.011967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a015158d-aedd-47c0-b645-dd2a9753e442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C7464E3C0>]}
[0m10:26:45.011967 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.13s]
[0m10:26:45.013947 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:26:45.015955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:45.016945 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:26:45.016945 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m10:26:45.016945 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:26:45.016945 [info ] [MainThread]: 
[0m10:26:45.018476 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m10:26:45.021505 [debug] [MainThread]: Command end result
[0m10:26:45.032482 [info ] [MainThread]: 
[0m10:26:45.034484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:45.035508 [info ] [MainThread]: 
[0m10:26:45.036485 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:26:45.038483 [debug] [MainThread]: Command `dbt run` succeeded at 10:26:45.038483 after 9.65 seconds
[0m10:26:45.038483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C73F44C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C740886E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C71FECF50>]}
[0m10:26:45.039484 [debug] [MainThread]: Flushing usage events
[0m10:51:27.013696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568912A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568912AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568912A090>]}


============================== 10:51:27.019696 | 98a3bbad-e980-40ab-ac6f-3754aa414745 ==============================
[0m10:51:27.019696 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:51:27.020752 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:51:27.644659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689A96FF0>]}
[0m10:51:27.750193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568AD98470>]}
[0m10:51:27.752193 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:51:27.775711 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:51:29.012896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:51:29.012896 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_customers_table.sql
[0m10:51:29.013899 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:51:29.013899 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\mart\customer_churn.sql
[0m10:51:29.175903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568AECA540>]}
[0m10:51:29.198801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B1603B0>]}
[0m10:51:29.199802 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:51:29.200801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B1C27E0>]}
[0m10:51:29.202803 [info ] [MainThread]: 
[0m10:51:29.204821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:51:29.205801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:51:29.220803 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:51:29.221804 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:51:29.221804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:30.304865 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:51:30.310814 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:51:30.478742 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:51:30.479740 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:51:30.480744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:31.042782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:51:31.047788 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:51:31.205138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_mart'
[0m10:51:31.218654 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:51:31.219654 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:51:31.219654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:31.798302 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:51:31.801311 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:51:31.942672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_mart, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m10:51:31.945705 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:51:31.945705 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:51:31.946705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:33.098205 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:51:33.105203 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:51:33.270977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568ADF9880>]}
[0m10:51:33.270977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:33.272007 [info ] [MainThread]: 
[0m10:51:33.283508 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:51:33.284533 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:51:33.286508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:51:33.286508 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:51:33.296545 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:51:33.298505 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:51:33.286508 => 10:51:33.298505
[0m10:51:33.299510 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:51:33.333105 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:51:33.336146 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:51:33.336146 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        customer_id IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
removing_duplicates AS (
    SELECT
        distinct *
    FROM
        removing_null_rows
),
changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:51:33.337140 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:35.429961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:51:35.453005 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:51:33.299510 => 10:51:35.453005
[0m10:51:35.454003 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:51:35.596448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568AF96330>]}
[0m10:51:35.599448 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 2.31s]
[0m10:51:35.603447 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:51:35.605448 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:51:35.608413 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:51:35.611438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:51:35.613389 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:51:35.617460 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:51:35.619452 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:51:35.614442 => 10:51:35.619452
[0m10:51:35.620455 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:51:35.624462 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:51:35.626450 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:51:35.627450 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source when customer_id is not null or customer_name is not null or company is not null
        );
[0m10:51:35.627450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:36.243245 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee1-0001-0892-0000-50e90002583e
[0m10:51:36.243245 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 26 unexpected 'customer_id'.
[0m10:51:36.244244 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:51:35.621454 => 10:51:36.243245
[0m10:51:36.244244 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:51:36.402941 [debug] [Thread-1 (]: Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:51:36.403935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B3975F0>]}
[0m10:51:36.404938 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model staging.staging_customers_table .......... [[31mERROR[0m in 0.79s]
[0m10:51:36.405901 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:51:36.405901 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:51:36.406934 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:51:36.408393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:51:36.409401 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:51:36.465043 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:51:36.466042 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:51:36.409401 => 10:51:36.466042
[0m10:51:36.466042 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:51:36.469042 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:51:36.471042 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:51:36.471042 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:51:36.472042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:37.681484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:51:37.684485 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:51:36.467043 => 10:51:37.684485
[0m10:51:37.685485 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:51:37.828057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B396570>]}
[0m10:51:37.831057 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.42s]
[0m10:51:37.835071 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:51:37.837069 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:51:37.838591 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:51:37.843620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:51:37.845609 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:51:37.857619 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:51:37.861618 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:51:37.846611 => 10:51:37.860611
[0m10:51:37.862661 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:51:37.868644 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:51:37.871605 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:51:37.872608 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:51:37.873610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:38.891183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:51:38.902181 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:51:37.863646 => 10:51:38.901182
[0m10:51:38.904181 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:51:39.051122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B415910>]}
[0m10:51:39.052123 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.21s]
[0m10:51:39.052730 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:51:39.053770 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:51:39.054769 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:51:39.055747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:51:39.056770 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:51:39.059790 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:51:39.061738 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:51:39.056770 => 10:51:39.060741
[0m10:51:39.061738 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:51:39.064773 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:51:39.067773 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:51:39.068771 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:51:39.068771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:40.303014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:51:40.307000 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:51:39.062774 => 10:51:40.305999
[0m10:51:40.307000 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:51:40.451829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a3bbad-e980-40ab-ac6f-3754aa414745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B36C7A0>]}
[0m10:51:40.451829 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.40s]
[0m10:51:40.453829 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:51:40.455372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:40.456413 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:51:40.456413 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:51:40.456413 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:51:40.457420 [info ] [MainThread]: 
[0m10:51:40.458414 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m10:51:40.460379 [debug] [MainThread]: Command end result
[0m10:51:40.470380 [info ] [MainThread]: 
[0m10:51:40.471380 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:51:40.472380 [info ] [MainThread]: 
[0m10:51:40.473419 [error] [MainThread]:   Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:51:40.474413 [info ] [MainThread]: 
[0m10:51:40.475379 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:51:40.476380 [debug] [MainThread]: Command `dbt run` failed at 10:51:40.476380 after 13.58 seconds
[0m10:51:40.477418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025688C69C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025688FFBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025688FFAE40>]}
[0m10:51:40.478384 [debug] [MainThread]: Flushing usage events
[0m10:53:19.514516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832DCE8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832DCE9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832DCEB2C0>]}


============================== 10:53:19.520514 | d5e096a6-1d4b-46b4-89c2-01d21366d288 ==============================
[0m10:53:19.520514 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:53:19.521525 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:53:20.034007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832E5BF320>]}
[0m10:53:20.135630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832DCE9B80>]}
[0m10:53:20.136597 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:53:20.145593 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:53:20.267128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:20.268128 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:53:20.428716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832F88CB00>]}
[0m10:53:20.439716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FA735F0>]}
[0m10:53:20.439716 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:53:20.440717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FC71DF0>]}
[0m10:53:20.442750 [info ] [MainThread]: 
[0m10:53:20.444750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:20.445875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:53:20.461885 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:53:20.462883 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:53:20.462883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:21.440134 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:53:21.443094 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:53:21.594401 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:53:21.595402 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:53:21.595402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:22.160955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:53:22.163918 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:53:22.318451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_mart'
[0m10:53:22.344040 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:53:22.344040 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:53:22.345039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:22.939290 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:22.941294 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:53:23.087962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_mart, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m10:53:23.098954 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:53:23.100948 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:53:23.101953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:23.502290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:53:23.504287 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:53:23.652589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832F88F320>]}
[0m10:53:23.656586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:23.659596 [info ] [MainThread]: 
[0m10:53:23.672746 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:53:23.674685 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:53:23.676685 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:53:23.677683 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:53:23.691713 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:53:23.692679 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:53:23.678681 => 10:53:23.692679
[0m10:53:23.693680 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:53:23.730299 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:53:23.732300 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:53:23.732300 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        CUSTOMER_ID IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
removing_duplicates AS (
    SELECT
        distinct *
    FROM
        removing_null_rows
),
changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:53:23.733300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:24.875194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:24.900194 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:53:23.693680 => 10:53:24.899196
[0m10:53:24.900194 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:53:25.045212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FEED850>]}
[0m10:53:25.048213 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.37s]
[0m10:53:25.052214 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:53:25.054214 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:53:25.055343 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:53:25.058054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:53:25.059092 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:53:25.064086 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:53:25.066043 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:53:25.060085 => 10:53:25.066043
[0m10:53:25.067060 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:53:25.072074 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:53:25.074074 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:53:25.074074 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source when customer_id is not null or customer_name is not null or company is not null
        );
[0m10:53:25.074074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:25.494445 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee3-0001-0878-0000-50e90002c2ba
[0m10:53:25.494445 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 26 unexpected 'customer_id'.
[0m10:53:25.495445 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:53:25.067060 => 10:53:25.495445
[0m10:53:25.495445 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:53:25.644045 [debug] [Thread-1 (]: Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:53:25.645044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FEE06E0>]}
[0m10:53:25.646048 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model staging.staging_customers_table .......... [[31mERROR[0m in 0.59s]
[0m10:53:25.647012 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:53:25.647012 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:53:25.648043 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:53:25.650045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:53:25.650045 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:53:25.707045 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:53:25.708045 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:53:25.650045 => 10:53:25.707045
[0m10:53:25.708045 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:53:25.712012 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:53:25.714014 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:53:25.715050 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:53:25.715050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:26.647775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:26.658786 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:53:25.709045 => 10:53:26.657772
[0m10:53:26.660788 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:53:26.802666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FEE03B0>]}
[0m10:53:26.803666 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.15s]
[0m10:53:26.804664 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:53:26.805665 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:53:26.805665 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:53:26.807676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:53:26.808665 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:53:26.812666 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:53:26.813686 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:53:26.808665 => 10:53:26.813686
[0m10:53:26.814667 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:53:26.818674 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:53:26.820674 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:53:26.821669 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:53:26.822675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:27.815131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:27.821127 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:53:26.814667 => 10:53:27.820131
[0m10:53:27.822133 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:53:27.965199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832F8E6CF0>]}
[0m10:53:27.965199 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.16s]
[0m10:53:27.967211 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:53:27.968219 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:53:27.968219 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:53:27.969217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:53:27.970252 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:53:27.973254 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:53:27.974253 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:53:27.970252 => 10:53:27.974253
[0m10:53:27.975219 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:53:27.978252 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:53:27.980252 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:53:27.980252 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:53:27.981252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.994284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:28.998274 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:53:27.975219 => 10:53:28.998274
[0m10:53:28.998274 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:53:29.147000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e096a6-1d4b-46b4-89c2-01d21366d288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FEB1340>]}
[0m10:53:29.149000 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.18s]
[0m10:53:29.152999 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:53:29.160946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:29.161953 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:53:29.161953 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:53:29.162937 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:53:29.162937 [info ] [MainThread]: 
[0m10:53:29.163937 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.72 seconds (8.72s).
[0m10:53:29.166972 [debug] [MainThread]: Command end result
[0m10:53:29.175935 [info ] [MainThread]: 
[0m10:53:29.176936 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:29.177940 [info ] [MainThread]: 
[0m10:53:29.178970 [error] [MainThread]:   Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:53:29.179936 [info ] [MainThread]: 
[0m10:53:29.180954 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:53:29.182938 [debug] [MainThread]: Command `dbt run` failed at 10:53:29.182938 after 9.75 seconds
[0m10:53:29.183944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832DBADD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832D7F8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832FF17C80>]}
[0m10:53:29.183944 [debug] [MainThread]: Flushing usage events
[0m10:53:52.048411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB687B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB687A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB687A750>]}


============================== 10:53:52.054410 | 118f52b9-0d18-40c6-b6d1-dba3b7dc06ba ==============================
[0m10:53:52.054410 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:53:52.055414 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m10:53:52.576930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB837F5C0>]}
[0m10:53:52.679550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB6959070>]}
[0m10:53:52.681552 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:53:52.690195 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:53:52.789446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:52.790446 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:53:52.948591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB88BCFB0>]}
[0m10:53:52.958573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB864BBF0>]}
[0m10:53:52.959556 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:53:52.960578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB87D5FD0>]}
[0m10:53:52.962590 [info ] [MainThread]: 
[0m10:53:52.963556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:52.965589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:53:52.980558 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:53:52.980558 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:53:52.981556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:54.102816 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:53:54.112709 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:53:54.264471 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:53:54.265471 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:53:54.266471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:54.930799 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:53:54.936803 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:53:55.089174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_mart'
[0m10:53:55.100136 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:53:55.101135 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:53:55.101135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:55.666313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:55.673311 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:53:55.826995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_mart, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m10:53:55.836995 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:53:55.837994 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:53:55.838995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:56.379282 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:53:56.384280 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:53:56.542983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB87F2270>]}
[0m10:53:56.546098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:56.549108 [info ] [MainThread]: 
[0m10:53:56.560638 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:53:56.560638 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:53:56.562669 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:53:56.562669 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:53:56.573669 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:53:56.574637 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:53:56.563646 => 10:53:56.574637
[0m10:53:56.575639 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:53:56.611673 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:53:56.614669 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:53:56.614669 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        customer_id IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
removing_duplicates AS (
    SELECT
        *,
        ROW_NUMBER() OVER (PARTITION BY customer_id,country,region ORDER BY customer_id ASC) AS row_number
    FROM
        removing_null_rows
),
changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
    WHERE
        row_number = 1
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:53:56.615670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:57.518569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:57.542555 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:53:56.576638 => 10:53:57.542555
[0m10:53:57.543555 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:53:57.687310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB8A64410>]}
[0m10:53:57.690306 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.12s]
[0m10:53:57.694305 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:53:57.696304 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:53:57.699304 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:53:57.702297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:53:57.703296 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:53:57.708274 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:53:57.710251 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:53:57.704294 => 10:53:57.710251
[0m10:53:57.711247 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:53:57.715275 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:53:57.716278 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:53:57.717275 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source when customer_id is not null or customer_name is not null or company is not null
        );
[0m10:53:57.717275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:58.254004 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee3-0001-0878-0000-50e90002c2c2
[0m10:53:58.255005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 26 unexpected 'customer_id'.
[0m10:53:58.255005 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:53:57.711247 => 10:53:58.255005
[0m10:53:58.256004 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:53:58.401243 [debug] [Thread-1 (]: Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:53:58.402242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB8A389B0>]}
[0m10:53:58.403242 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model staging.staging_customers_table .......... [[31mERROR[0m in 0.70s]
[0m10:53:58.404250 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:53:58.404250 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:53:58.405250 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:53:58.406209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:53:58.407242 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:53:58.461217 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:53:58.462217 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:53:58.407242 => 10:53:58.462217
[0m10:53:58.463220 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:53:58.465792 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:53:58.467845 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:53:58.467845 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:53:58.468833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:59.220337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:53:59.229342 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:53:58.463220 => 10:53:59.228340
[0m10:53:59.229342 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:53:59.379904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB8A38740>]}
[0m10:53:59.379904 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 0.97s]
[0m10:53:59.381871 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:53:59.381871 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:53:59.382903 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:53:59.383871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:53:59.383871 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:53:59.387906 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:53:59.388904 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:53:59.384904 => 10:53:59.388904
[0m10:53:59.388904 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:53:59.391903 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:53:59.393869 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:53:59.394908 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:53:59.394908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:00.269286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:54:00.272871 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:53:59.389904 => 10:54:00.272871
[0m10:54:00.272871 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:54:00.422257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB8775B20>]}
[0m10:54:00.425251 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.04s]
[0m10:54:00.429268 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:54:00.432256 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:54:00.435252 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:54:00.439209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:54:00.441244 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:54:00.448189 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:54:00.450202 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:54:00.442242 => 10:54:00.449194
[0m10:54:00.450202 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:54:00.453223 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:54:00.456222 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:54:00.456222 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:54:00.456222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:01.313786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:54:01.317780 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:54:00.451226 => 10:54:01.317780
[0m10:54:01.318772 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:54:01.464911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118f52b9-0d18-40c6-b6d1-dba3b7dc06ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB8AC6D50>]}
[0m10:54:01.464911 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.03s]
[0m10:54:01.466931 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:54:01.468858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:01.468858 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:54:01.469868 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m10:54:01.469868 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:54:01.469868 [info ] [MainThread]: 
[0m10:54:01.471137 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m10:54:01.473178 [debug] [MainThread]: Command end result
[0m10:54:01.485706 [info ] [MainThread]: 
[0m10:54:01.486706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:54:01.487747 [info ] [MainThread]: 
[0m10:54:01.487747 [error] [MainThread]:   Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 26 unexpected 'customer_id'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m10:54:01.488734 [info ] [MainThread]: 
[0m10:54:01.489700 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m10:54:01.490702 [debug] [MainThread]: Command `dbt run` failed at 10:54:01.490702 after 9.54 seconds
[0m10:54:01.491736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB63FD070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB673E000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018DB673DA60>]}
[0m10:54:01.491736 [debug] [MainThread]: Flushing usage events
[0m10:56:49.282782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE5802450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE5802330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE5801E50>]}


============================== 10:56:49.288792 | 589be6c7-24e0-4a87-9d5f-316e70805473 ==============================
[0m10:56:49.288792 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:56:49.289755 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:56:49.792988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '589be6c7-24e0-4a87-9d5f-316e70805473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE7416BA0>]}
[0m10:56:49.893614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '589be6c7-24e0-4a87-9d5f-316e70805473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE72FEC00>]}
[0m10:56:49.894614 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:56:49.904587 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:56:50.019426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:56:50.019426 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:56:50.020426 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_customers_table.sql
[0m10:56:50.173017 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mini_project_dbt.staging_country_region' (models\staging\staging_country_region.sql) depends on a source named 'data_from_snowflake.countryregion' which was not found
[0m10:56:50.175201 [debug] [MainThread]: Command `dbt run` failed at 10:56:50.174160 after 0.98 seconds
[0m10:56:50.175201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE5801910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDEEC11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DE7738230>]}
[0m10:56:50.175201 [debug] [MainThread]: Flushing usage events
[0m10:57:17.235446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9E7A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9E7A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9E7A3F0>]}


============================== 10:57:17.241897 | caae35d4-6897-4f59-ac71-88936cd7647f ==============================
[0m10:57:17.241897 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:57:17.242275 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m10:57:17.746708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9E7A360>]}
[0m10:57:17.846329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBA7A7EC0>]}
[0m10:57:17.848295 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:57:17.857329 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:57:17.946960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:57:17.946960 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:57:17.947960 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_customers_table.sql
[0m10:57:18.108545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBBDE9D60>]}
[0m10:57:18.119510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBBC5B5C0>]}
[0m10:57:18.119510 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:57:18.120544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBBDA7260>]}
[0m10:57:18.122545 [info ] [MainThread]: 
[0m10:57:18.123711 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:57:18.125758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:57:18.140337 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:57:18.141394 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:57:18.141394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:19.154001 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:57:19.160711 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:57:19.327929 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:57:19.328929 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:57:19.329913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:19.897162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:57:19.899118 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:57:20.046726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m10:57:20.057749 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:57:20.057749 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:57:20.058749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:20.884293 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:57:20.886327 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:57:21.019821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m10:57:21.023784 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:57:21.023784 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:57:21.024785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.479852 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:57:21.486849 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:57:21.642008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9E49A60>]}
[0m10:57:21.646067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:21.647002 [info ] [MainThread]: 
[0m10:57:21.651945 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:57:21.651945 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:57:21.653869 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:57:21.653869 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:57:21.664907 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:57:21.666953 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:57:21.654910 => 10:57:21.666953
[0m10:57:21.667938 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:57:21.701519 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:57:21.703521 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:57:21.704520 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (
WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        customer_id IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
removing_duplicates AS (
    SELECT
        *
        , ROW_NUMBER() OVER (PARTITION BY customer_id,country,region ORDER BY customer_id ASC) AS row_number
    FROM
        removing_null_rows
),
changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
    WHERE
        row_number = 1
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:57:21.704520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:22.761791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:57:22.786420 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:57:21.667938 => 10:57:22.785384
[0m10:57:22.786420 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:57:22.927175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC074B00>]}
[0m10:57:22.928180 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.27s]
[0m10:57:22.929166 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:57:22.930165 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:57:22.931177 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:57:22.932164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:57:22.933164 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:57:22.936194 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:57:22.937192 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:57:22.933164 => 10:57:22.937192
[0m10:57:22.938165 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:57:22.941193 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:57:22.943173 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:57:22.943173 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:57:22.944191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.879139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:57:23.889786 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:57:22.938165 => 10:57:23.888784
[0m10:57:23.891791 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:57:24.048593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBBDA7EF0>]}
[0m10:57:24.051593 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.12s]
[0m10:57:24.055592 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:57:24.057590 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:57:24.059289 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:57:24.061980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:57:24.064003 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:57:24.119553 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:57:24.120554 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:57:24.064003 => 10:57:24.120554
[0m10:57:24.121520 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:57:24.124554 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:57:24.125572 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:57:24.126552 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:57:24.126552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:25.068652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:57:25.071624 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:57:24.121520 => 10:57:25.071624
[0m10:57:25.072622 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:57:25.217973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC04D6D0>]}
[0m10:57:25.220973 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.16s]
[0m10:57:25.224974 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:57:25.226989 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:57:25.228977 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:57:25.231919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:57:25.233959 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:57:25.239912 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:57:25.241955 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:57:25.233959 => 10:57:25.240954
[0m10:57:25.242952 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:57:25.246949 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:57:25.248963 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:57:25.249946 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:57:25.249946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:26.196721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:57:26.207774 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:57:25.242952 => 10:57:26.205775
[0m10:57:26.209774 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:57:26.353130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC04CCB0>]}
[0m10:57:26.354069 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.12s]
[0m10:57:26.355038 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:57:26.356257 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:57:26.357297 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:57:26.358264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:57:26.358264 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:57:26.361297 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:57:26.363271 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:57:26.358264 => 10:57:26.362297
[0m10:57:26.363271 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:57:26.366301 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:57:26.369298 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:57:26.369298 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:57:26.370263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:27.190815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:57:27.193837 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:57:26.363271 => 10:57:27.193837
[0m10:57:27.194840 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:57:27.338223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caae35d4-6897-4f59-ac71-88936cd7647f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBBD987D0>]}
[0m10:57:27.338223 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m10:57:27.340190 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:57:27.342190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:27.342190 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:57:27.342190 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m10:57:27.343189 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:57:27.343189 [info ] [MainThread]: 
[0m10:57:27.344186 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.22 seconds (9.22s).
[0m10:57:27.346231 [debug] [MainThread]: Command end result
[0m10:57:27.358238 [info ] [MainThread]: 
[0m10:57:27.359195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:27.360202 [info ] [MainThread]: 
[0m10:57:27.360202 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:57:27.362226 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:27.362226 after 10.21 seconds
[0m10:57:27.362226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9D1BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB8D7A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB9A4B560>]}
[0m10:57:27.363228 [debug] [MainThread]: Flushing usage events
[0m10:59:13.558889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F1F238710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F1EF622A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F1F239130>]}


============================== 10:59:13.564870 | 8a6f6b9d-cf42-4307-967d-0c03c1006495 ==============================
[0m10:59:13.564870 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:59:13.565832 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m10:59:14.060343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F20EB9E20>]}
[0m10:59:14.160935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F20EB9E20>]}
[0m10:59:14.162901 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:59:14.171936 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:59:14.277485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:14.278485 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m10:59:14.434695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F21198E00>]}
[0m10:59:14.451188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F21007CE0>]}
[0m10:59:14.451188 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m10:59:14.452189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F211B5FA0>]}
[0m10:59:14.454226 [info ] [MainThread]: 
[0m10:59:14.455188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:59:14.456772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m10:59:14.472815 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:59:14.473780 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:59:14.473780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:15.389439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:59:15.395440 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:59:15.566623 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m10:59:15.568619 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m10:59:15.569668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:16.084901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:59:16.086898 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m10:59:16.244152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m10:59:16.264116 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m10:59:16.265114 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m10:59:16.265114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:16.821726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:59:16.824696 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m10:59:16.968762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m10:59:16.971762 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m10:59:16.971762 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m10:59:16.972762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:17.539439 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:17.542432 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m10:59:17.689528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2126E6C0>]}
[0m10:59:17.691529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:17.692529 [info ] [MainThread]: 
[0m10:59:17.702535 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m10:59:17.704592 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m10:59:17.707812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m10:59:17.708875 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m10:59:17.720817 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m10:59:17.721810 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 10:59:17.709877 => 10:59:17.721810
[0m10:59:17.722822 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m10:59:17.756397 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m10:59:17.758398 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m10:59:17.758398 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (
WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        customer_id IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
changing_cases AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_null_rows
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:59:17.759396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:18.808340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:18.851940 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 10:59:17.722822 => 10:59:18.851940
[0m10:59:18.852939 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m10:59:18.998512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F21421460>]}
[0m10:59:18.999477 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.29s]
[0m10:59:19.001443 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m10:59:19.001443 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m10:59:19.002442 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m10:59:19.003443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m10:59:19.004442 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m10:59:19.007442 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m10:59:19.008441 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 10:59:19.004442 => 10:59:19.008441
[0m10:59:19.008441 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m10:59:19.011441 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m10:59:19.013442 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m10:59:19.014442 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (WITH source AS (
    SELECT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company,
    FROM raw_data.public.CUSTOMERS_TABLE
)

SELECT * FROM source
        );
[0m10:59:19.014442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:19.939825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:19.942825 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 10:59:19.009441 => 10:59:19.941824
[0m10:59:19.942825 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m10:59:20.094724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2140FC80>]}
[0m10:59:20.096727 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.09s]
[0m10:59:20.099722 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m10:59:20.101772 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m10:59:20.103717 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m10:59:20.104720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m10:59:20.104720 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m10:59:20.162343 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m10:59:20.164310 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 10:59:20.105750 => 10:59:20.164310
[0m10:59:20.165310 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m10:59:20.168309 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m10:59:20.169308 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m10:59:20.170309 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (WITH source AS (
    SELECT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
)

SELECT * FROM source
        );
[0m10:59:20.170309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:20.986530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:20.989529 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 10:59:20.165310 => 10:59:20.989529
[0m10:59:20.989529 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m10:59:21.136376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F210D0650>]}
[0m10:59:21.137395 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.03s]
[0m10:59:21.138360 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m10:59:21.139373 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m10:59:21.139373 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m10:59:21.140436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m10:59:21.141480 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m10:59:21.144480 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m10:59:21.145477 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 10:59:21.141480 => 10:59:21.145477
[0m10:59:21.146479 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m10:59:21.148986 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m10:59:21.150993 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m10:59:21.151995 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (WITH source AS (
    SELECT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
)

SELECT * FROM source
        );
[0m10:59:21.151995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:22.069126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:22.077148 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 10:59:21.146479 => 10:59:22.077148
[0m10:59:22.079086 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m10:59:22.241247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F210D20C0>]}
[0m10:59:22.244247 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.10s]
[0m10:59:22.248246 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m10:59:22.251197 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m10:59:22.254285 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m10:59:22.258314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m10:59:22.261311 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m10:59:22.271352 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m10:59:22.275305 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 10:59:22.262312 => 10:59:22.274346
[0m10:59:22.276306 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m10:59:22.282301 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m10:59:22.285302 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m10:59:22.286302 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m10:59:22.287304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:23.208281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:59:23.212297 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 10:59:22.276306 => 10:59:23.211297
[0m10:59:23.212297 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m10:59:23.361434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6f6b9d-cf42-4307-967d-0c03c1006495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F20FAA5A0>]}
[0m10:59:23.362404 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.11s]
[0m10:59:23.363366 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m10:59:23.365366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:23.366405 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m10:59:23.366405 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m10:59:23.367399 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m10:59:23.367399 [info ] [MainThread]: 
[0m10:59:23.368403 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.91 seconds (8.91s).
[0m10:59:23.370366 [debug] [MainThread]: Command end result
[0m10:59:23.379366 [info ] [MainThread]: 
[0m10:59:23.380380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:23.381367 [info ] [MainThread]: 
[0m10:59:23.382366 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:59:23.383399 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:23.383399 after 9.91 seconds
[0m10:59:23.383399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F20E886E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F20DCEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F1ACB95B0>]}
[0m10:59:23.384402 [debug] [MainThread]: Flushing usage events
[0m11:09:44.446561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E85A9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E85A9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E85A8770>]}


============================== 11:09:44.452858 | 065dc4fc-bfb2-4421-a821-76cb80514cd9 ==============================
[0m11:09:44.452858 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:09:44.453825 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:09:45.060412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E810B5C0>]}
[0m11:09:45.160034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E9123BC0>]}
[0m11:09:45.161878 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:09:45.182499 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:09:46.414050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m11:09:46.415051 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://macros\not_null.sql
[0m11:09:46.415051 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m11:09:46.416052 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_customers_table.sql
[0m11:09:46.416052 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_country_region.sql
[0m11:09:46.417052 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_products_table.sql
[0m11:09:46.600183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA5B4D40>]}
[0m11:09:46.621934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA3D0C80>]}
[0m11:09:46.622935 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m11:09:46.623539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA3D0980>]}
[0m11:09:46.625580 [info ] [MainThread]: 
[0m11:09:46.627129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:46.628129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m11:09:46.644131 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:09:46.644131 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:09:46.645163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:47.788131 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:09:47.790088 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:09:47.940434 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:09:47.940976 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:09:47.940976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:48.498315 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:09:48.500338 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:09:48.654269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m11:09:48.678995 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m11:09:48.678995 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m11:09:48.679991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:49.230111 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:09:49.233081 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m11:09:49.379582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m11:09:49.391519 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m11:09:49.391519 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m11:09:49.392520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:49.815924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:49.817920 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m11:09:49.960381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA5830B0>]}
[0m11:09:49.961382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:49.962348 [info ] [MainThread]: 
[0m11:09:49.966443 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m11:09:49.967487 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m11:09:49.968452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m11:09:49.969451 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m11:09:49.980034 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m11:09:49.982000 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 11:09:49.969451 => 11:09:49.981035
[0m11:09:49.982000 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m11:09:50.019040 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m11:09:50.020999 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m11:09:50.022034 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (
WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

),
changing_cases AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_null_rows
)
SELECT
    *
FROM
    changing_cases
        );
[0m11:09:50.022034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:51.293036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:09:51.317994 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 11:09:49.982000 => 11:09:51.316999
[0m11:09:51.317994 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m11:09:51.453325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA7F4EC0>]}
[0m11:09:51.454325 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.48s]
[0m11:09:51.455322 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m11:09:51.456325 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m11:09:51.456325 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m11:09:51.457325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m11:09:51.458322 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m11:09:51.462325 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m11:09:51.463325 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 11:09:51.458322 => 11:09:51.463325
[0m11:09:51.464323 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m11:09:51.467325 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m11:09:51.469326 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m11:09:51.470325 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        CUSTOMER_ID IS NOT NULL AND
        CUSTOMERNAME IS NOT NULL AND
        COMPANY IS NOT NULL
         
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:09:51.470325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:52.130695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef3-0001-085a-0000-50e90001da8e
[0m11:09:52.130695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 8 unexpected 'customer_id'.
syntax error line 28 at position 0 unexpected 'SELECT'.
[0m11:09:52.131692 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 11:09:51.464323 => 11:09:52.131692
[0m11:09:52.132692 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m11:09:52.295869 [debug] [Thread-1 (]: Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'customer_id'.
  syntax error line 28 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m11:09:52.296869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA261D90>]}
[0m11:09:52.297868 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model staging.staging_customers_table .......... [[31mERROR[0m in 0.84s]
[0m11:09:52.298835 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m11:09:52.299837 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m11:09:52.299837 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m11:09:52.301871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m11:09:52.301871 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m11:09:52.306869 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m11:09:52.307870 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 11:09:52.302868 => 11:09:52.307870
[0m11:09:52.308837 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m11:09:52.312838 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m11:09:52.314834 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m11:09:52.315869 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:09:52.315869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:53.368200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:09:53.371195 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 11:09:52.308837 => 11:09:53.370195
[0m11:09:53.371195 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m11:09:53.508824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA4D5340>]}
[0m11:09:53.509826 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.21s]
[0m11:09:53.510825 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m11:09:53.511824 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m11:09:53.511824 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m11:09:53.513826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m11:09:53.513826 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m11:09:53.519827 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m11:09:53.520825 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 11:09:53.514825 => 11:09:53.520825
[0m11:09:53.521828 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m11:09:53.525861 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m11:09:53.527825 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m11:09:53.528865 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:09:53.529826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:54.888361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:09:54.892332 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 11:09:53.521828 => 11:09:54.892332
[0m11:09:54.893332 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m11:09:55.040649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA262AB0>]}
[0m11:09:55.040649 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.53s]
[0m11:09:55.041649 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m11:09:55.043160 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m11:09:55.043160 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m11:09:55.044208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m11:09:55.045203 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m11:09:55.048207 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m11:09:55.049204 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 11:09:55.045203 => 11:09:55.049204
[0m11:09:55.050168 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m11:09:55.053201 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m11:09:55.055202 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m11:09:55.056168 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m11:09:55.056168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:56.274102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:09:56.285102 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 11:09:55.050168 => 11:09:56.284107
[0m11:09:56.287104 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m11:09:56.442081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065dc4fc-bfb2-4421-a821-76cb80514cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EA9468D0>]}
[0m11:09:56.442081 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.40s]
[0m11:09:56.444084 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m11:09:56.445787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:56.445787 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m11:09:56.446787 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m11:09:56.446787 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m11:09:56.446787 [info ] [MainThread]: 
[0m11:09:56.448075 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m11:09:56.450084 [debug] [MainThread]: Command end result
[0m11:09:56.461096 [info ] [MainThread]: 
[0m11:09:56.462082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:56.463082 [info ] [MainThread]: 
[0m11:09:56.464135 [error] [MainThread]:   Database Error in model staging_customers_table (models\staging\staging_customers_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'customer_id'.
  syntax error line 28 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_customers_table.sql
[0m11:09:56.465125 [info ] [MainThread]: 
[0m11:09:56.465125 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:09:56.467127 [debug] [MainThread]: Command `dbt run` failed at 11:09:56.467127 after 12.13 seconds
[0m11:09:56.468082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E8477FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E82BDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E82BF260>]}
[0m11:09:56.468082 [debug] [MainThread]: Flushing usage events
[0m11:12:48.548872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A7FACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A7FAD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94A7F9A60>]}


============================== 11:12:48.554822 | 0a3507fe-fe96-4a6e-9b48-aa6500853877 ==============================
[0m11:12:48.554822 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:12:48.555792 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m11:12:49.073401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94B2577D0>]}
[0m11:12:49.174026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94B18FEC0>]}
[0m11:12:49.175025 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:12:49.184025 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:12:49.302987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:49.303990 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_customers_table.sql
[0m11:12:49.467199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C7E4B30>]}
[0m11:12:49.478203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C745A00>]}
[0m11:12:49.479204 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m11:12:49.480166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C48BCE0>]}
[0m11:12:49.482201 [info ] [MainThread]: 
[0m11:12:49.483167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:49.485200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m11:12:49.500244 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:12:49.501244 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:12:49.501244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:50.530006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:12:50.531968 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:12:50.695819 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:12:50.696819 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:12:50.697823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:51.271725 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:12:51.273680 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:12:51.430889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m11:12:51.441857 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m11:12:51.441857 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m11:12:51.441857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:51.864249 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:12:51.871199 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m11:12:52.037151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m11:12:52.040151 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m11:12:52.041152 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m11:12:52.041152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:52.747399 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:52.749395 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m11:12:52.894092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C860950>]}
[0m11:12:52.895089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:52.896059 [info ] [MainThread]: 
[0m11:12:52.900058 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region
[0m11:12:52.901059 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region .................... [RUN]
[0m11:12:52.902059 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region'
[0m11:12:52.903059 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region
[0m11:12:52.913131 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region"
[0m11:12:52.914131 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (compile): 11:12:52.903059 => 11:12:52.914131
[0m11:12:52.915098 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region
[0m11:12:52.948690 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region"
[0m11:12:52.950684 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region"
[0m11:12:52.950684 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region
         as
        (
WITH removing_null_rows AS (
    SELECT
        *
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

),
changing_cases AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_null_rows
)
SELECT
    *
FROM
    changing_cases
        );
[0m11:12:52.951687 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:53.988885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:54.027912 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region (execute): 11:12:52.915098 => 11:12:54.026916
[0m11:12:54.027912 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region: Close
[0m11:12:54.187349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C9F47A0>]}
[0m11:12:54.188340 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region ............... [[32mSUCCESS 1[0m in 1.29s]
[0m11:12:54.189303 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region
[0m11:12:54.189303 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m11:12:54.190303 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m11:12:54.191159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region, now model.mini_project_dbt.staging_customers_table)
[0m11:12:54.192202 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m11:12:54.195201 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m11:12:54.216070 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 11:12:54.192202 => 11:12:54.215157
[0m11:12:54.216070 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m11:12:54.221078 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m11:12:54.223078 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m11:12:54.223078 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:12:54.224078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:55.217980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:55.230030 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 11:12:54.217071 => 11:12:55.228030
[0m11:12:55.231028 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m11:12:55.385578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C6A21B0>]}
[0m11:12:55.388579 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.19s]
[0m11:12:55.392541 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m11:12:55.394542 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m11:12:55.396544 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m11:12:55.398487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m11:12:55.399482 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m11:12:55.406478 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m11:12:55.408482 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 11:12:55.400522 => 11:12:55.407478
[0m11:12:55.408482 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m11:12:55.413512 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m11:12:55.414511 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m11:12:55.415511 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:12:55.415511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:56.229008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:56.235027 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 11:12:55.409519 => 11:12:56.234025
[0m11:12:56.235027 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m11:12:56.384342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C7074A0>]}
[0m11:12:56.385311 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 0.99s]
[0m11:12:56.385826 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m11:12:56.386867 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m11:12:56.386867 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m11:12:56.387898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m11:12:56.388938 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m11:12:56.392939 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m11:12:56.393939 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 11:12:56.388938 => 11:12:56.393939
[0m11:12:56.394906 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m11:12:56.397905 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m11:12:56.399938 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m11:12:56.400906 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:12:56.400906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:57.243791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:57.246789 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 11:12:56.394906 => 11:12:57.245788
[0m11:12:57.246789 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m11:12:57.392787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C728320>]}
[0m11:12:57.395787 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.00s]
[0m11:12:57.399734 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m11:12:57.403738 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m11:12:57.406737 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m11:12:57.410252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m11:12:57.412301 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m11:12:57.423293 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m11:12:57.425283 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 11:12:57.414302 => 11:12:57.425283
[0m11:12:57.426276 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m11:12:57.432280 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m11:12:57.434240 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m11:12:57.435256 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m11:12:57.435256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:58.423213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:12:58.427182 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 11:12:57.427287 => 11:12:58.426182
[0m11:12:58.427182 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m11:12:58.572104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3507fe-fe96-4a6e-9b48-aa6500853877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C9BDEB0>]}
[0m11:12:58.575104 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.16s]
[0m11:12:58.579103 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m11:12:58.587105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:58.588104 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m11:12:58.589055 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m11:12:58.589055 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m11:12:58.590042 [info ] [MainThread]: 
[0m11:12:58.591055 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m11:12:58.593041 [debug] [MainThread]: Command end result
[0m11:12:58.604040 [info ] [MainThread]: 
[0m11:12:58.605042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:58.606059 [info ] [MainThread]: 
[0m11:12:58.607039 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:12:58.607695 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:58.607695 after 10.15 seconds
[0m11:12:58.608735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C8AE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94B18FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94C393DA0>]}
[0m11:12:58.608735 [debug] [MainThread]: Flushing usage events
[0m11:16:00.661786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57028DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5702A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57029160>]}


============================== 11:16:00.667704 | aa030c73-7432-4f6a-a1e4-ace3c26a12e1 ==============================
[0m11:16:00.667704 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:16:00.668685 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m11:16:01.187958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57946FF0>]}
[0m11:16:01.288586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57A93EC0>]}
[0m11:16:01.289585 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:16:01.299551 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:16:01.441597 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:16:01.442596 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\staging\staging_country_region_table.sql
[0m11:16:01.442596 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\staging\staging_country_region.sql
[0m11:16:01.604799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59080710>]}
[0m11:16:01.616766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC58F4C140>]}
[0m11:16:01.616766 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m11:16:01.617799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC58D139E0>]}
[0m11:16:01.619808 [info ] [MainThread]: 
[0m11:16:01.621844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:16:01.622838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m11:16:01.638873 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:16:01.639893 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:16:01.639893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:02.650879 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:16:02.652879 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:16:02.798083 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m11:16:02.798083 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m11:16:02.799083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:03.348879 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:16:03.350867 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m11:16:03.512936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m11:16:03.522923 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m11:16:03.523923 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m11:16:03.523923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:03.942955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:16:03.946953 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m11:16:04.099318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_mart)
[0m11:16:04.112319 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_mart"
[0m11:16:04.114318 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_mart"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.mart limit 10000
[0m11:16:04.116318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:04.558705 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:16:04.565779 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_mart: Close
[0m11:16:04.725229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59061F40>]}
[0m11:16:04.728279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:04.729250 [info ] [MainThread]: 
[0m11:16:04.733550 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m11:16:04.734591 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region_table .............. [RUN]
[0m11:16:04.735607 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m11:16:04.736560 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m11:16:04.746591 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m11:16:04.748557 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 11:16:04.736560 => 11:16:04.747590
[0m11:16:04.749569 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m11:16:04.784183 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m11:16:04.786191 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m11:16:04.787214 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m11:16:04.787214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:16:05.981826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:06.002763 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 11:16:04.749569 => 11:16:06.002763
[0m11:16:06.003763 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m11:16:06.188369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59214890>]}
[0m11:16:06.191367 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region_table ......... [[32mSUCCESS 1[0m in 1.45s]
[0m11:16:06.195369 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m11:16:06.197383 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m11:16:06.200369 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m11:16:06.203358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m11:16:06.205358 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m11:16:06.211306 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m11:16:06.213310 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 11:16:06.206357 => 11:16:06.212339
[0m11:16:06.213310 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m11:16:06.218307 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m11:16:06.221339 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m11:16:06.221339 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:16:06.222339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:07.141540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:07.148533 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 11:16:06.214336 => 11:16:07.148533
[0m11:16:07.149531 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m11:16:07.290936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5924D070>]}
[0m11:16:07.293936 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.09s]
[0m11:16:07.297937 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m11:16:07.299883 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m11:16:07.302047 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m11:16:07.305935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m11:16:07.306981 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m11:16:07.313930 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m11:16:07.314991 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 11:16:07.307975 => 11:16:07.314991
[0m11:16:07.315942 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m11:16:07.319928 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m11:16:07.321956 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m11:16:07.321956 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:16:07.322960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:09.034146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:16:09.038172 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 11:16:07.315942 => 11:16:09.038172
[0m11:16:09.038172 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m11:16:09.186685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59214C80>]}
[0m11:16:09.187685 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.88s]
[0m11:16:09.189646 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m11:16:09.190685 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m11:16:09.191685 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m11:16:09.192646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m11:16:09.193854 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m11:16:09.199854 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m11:16:09.201818 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 11:16:09.193854 => 11:16:09.201818
[0m11:16:09.202855 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m11:16:09.206853 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m11:16:09.209854 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m11:16:09.210853 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m11:16:09.211851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:10.037117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:10.039113 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 11:16:09.202855 => 11:16:10.039113
[0m11:16:10.040113 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m11:16:10.184349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59217F80>]}
[0m11:16:10.187345 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 0.99s]
[0m11:16:10.191406 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m11:16:10.194418 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_churn
[0m11:16:10.196989 [info ] [Thread-1 (]: 5 of 5 START sql table model mart.customer_churn ............................... [RUN]
[0m11:16:10.201015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.customer_churn)
[0m11:16:10.202057 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_churn
[0m11:16:10.207032 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_churn"
[0m11:16:10.209007 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (compile): 11:16:10.203057 => 11:16:10.208004
[0m11:16:10.210040 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_churn
[0m11:16:10.213037 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_churn"
[0m11:16:10.215004 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_churn"
[0m11:16:10.216029 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.mart.customer_churn
         as
        (WITH customer_activity AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id
)

SELECT
    customer_id,
    first_purchase_date,
    last_purchase_date,
    CASE
        WHEN last_purchase_date < DATEADD('month', -6, CURRENT_DATE) THEN 'churned'
        WHEN first_purchase_date >= DATE_TRUNC('year', CURRENT_DATE) THEN 'new'
        ELSE 'active'
    END AS customer_status
FROM customer_activity
        );
[0m11:16:10.217004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:11.247120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:11.251115 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_churn (execute): 11:16:10.210040 => 11:16:11.250116
[0m11:16:11.251115 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_churn: Close
[0m11:16:11.406054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa030c73-7432-4f6a-a1e4-ace3c26a12e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC590003B0>]}
[0m11:16:11.408054 [info ] [Thread-1 (]: 5 of 5 OK created sql table model mart.customer_churn .......................... [[32mSUCCESS 1[0m in 1.20s]
[0m11:16:11.412053 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_churn
[0m11:16:11.420059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:11.421068 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m11:16:11.421068 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_mart' was properly closed.
[0m11:16:11.422024 [debug] [MainThread]: Connection 'model.mini_project_dbt.customer_churn' was properly closed.
[0m11:16:11.422024 [info ] [MainThread]: 
[0m11:16:11.422990 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m11:16:11.426026 [debug] [MainThread]: Command end result
[0m11:16:11.436011 [info ] [MainThread]: 
[0m11:16:11.437019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:11.437488 [info ] [MainThread]: 
[0m11:16:11.438495 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:16:11.439498 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:11.439498 after 10.86 seconds
[0m11:16:11.440569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56D165D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56F07830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56F06DB0>]}
[0m11:16:11.441498 [debug] [MainThread]: Flushing usage events
[0m12:13:50.338119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C8FF9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C8FFA960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C8FF84D0>]}


============================== 12:13:50.352203 | 1713657f-bc78-45a8-b6e8-991903ae74c2 ==============================
[0m12:13:50.352203 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:13:50.354077 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:13:51.391888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C902A060>]}
[0m12:13:51.499440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C9A0FF50>]}
[0m12:13:51.501447 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:13:51.525527 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:13:51.549356 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:13:51.550324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAB8F9B0>]}
[0m12:13:53.978648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:13:53.984691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAFC42F0>]}
[0m12:13:54.031439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAFC42F0>]}
[0m12:13:54.032441 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:13:54.033405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAB37290>]}
[0m12:13:54.036441 [info ] [MainThread]: 
[0m12:13:54.037407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:54.038844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:13:54.054895 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:13:54.054895 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:13:54.055860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:55.689533 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m12:13:55.691534 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:13:55.869933 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:13:55.871874 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:13:55.872872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:56.294989 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:13:56.296999 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:13:56.443240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB, now create_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:13:56.445242 [debug] [ThreadPool]: Creating schema "database: "MINI_PROJECT_OUTPUT_DB"
schema: "transform"
"
[0m12:13:56.458230 [debug] [ThreadPool]: Using snowflake connection "create_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:13:56.459230 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "create_MINI_PROJECT_OUTPUT_DB_transform"} */
create schema if not exists MINI_PROJECT_OUTPUT_DB.transform
[0m12:13:56.460231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:56.902224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:13:56.904186 [debug] [ThreadPool]: On create_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:13:57.051429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m12:13:57.066424 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:13:57.066424 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:13:57.067424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:57.472852 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:13:57.479934 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:13:57.639455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:13:57.649466 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:13:57.651455 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:13:57.652470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:58.239444 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m12:13:58.242418 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:13:58.391020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CAFC42F0>]}
[0m12:13:58.395682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:58.396612 [info ] [MainThread]: 
[0m12:13:58.405379 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m12:13:58.406403 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.staging_country_region_table .............. [RUN]
[0m12:13:58.407378 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m12:13:58.408392 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m12:13:58.418414 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m12:13:58.419413 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 12:13:58.408392 => 12:13:58.419413
[0m12:13:58.420378 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m12:13:58.455411 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m12:13:58.457380 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m12:13:58.458380 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m12:13:58.459380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:59.477660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:59.502178 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 12:13:58.420378 => 12:13:59.501177
[0m12:13:59.502178 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m12:13:59.661056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CB2CCB30>]}
[0m12:13:59.664056 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.staging_country_region_table ......... [[32mSUCCESS 1[0m in 1.25s]
[0m12:13:59.668057 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m12:13:59.670054 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m12:13:59.671957 [info ] [Thread-1 (]: 2 of 5 START sql table model staging.staging_customers_table ................... [RUN]
[0m12:13:59.675697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m12:13:59.676746 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m12:13:59.683710 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m12:13:59.686710 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 12:13:59.677741 => 12:13:59.685749
[0m12:13:59.686710 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m12:13:59.691745 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m12:13:59.693713 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m12:13:59.694711 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m12:13:59.694711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:00.757198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:14:00.761189 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 12:13:59.687746 => 12:14:00.761189
[0m12:14:00.762186 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m12:14:00.906019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CB2CCE30>]}
[0m12:14:00.909019 [info ] [Thread-1 (]: 2 of 5 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.23s]
[0m12:14:00.912960 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m12:14:00.914961 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m12:14:00.915962 [info ] [Thread-1 (]: 3 of 5 START sql table model staging.staging_products_table .................... [RUN]
[0m12:14:00.917950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m12:14:00.917950 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m12:14:00.922951 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m12:14:00.923950 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 12:14:00.917950 => 12:14:00.923950
[0m12:14:00.924950 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m12:14:00.928950 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m12:14:00.931950 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m12:14:00.931950 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m12:14:00.932949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:01.796001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:14:01.798997 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 12:14:00.924950 => 12:14:01.798997
[0m12:14:01.799997 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m12:14:01.971883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CB347FB0>]}
[0m12:14:01.972886 [info ] [Thread-1 (]: 3 of 5 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.05s]
[0m12:14:01.974386 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m12:14:01.975434 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m12:14:01.976434 [info ] [Thread-1 (]: 4 of 5 START sql table model staging.staging_transactions_table ................ [RUN]
[0m12:14:01.977395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m12:14:01.978434 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m12:14:01.985400 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m12:14:01.987396 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 12:14:01.979434 => 12:14:01.986453
[0m12:14:01.987396 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m12:14:01.991481 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m12:14:01.994485 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m12:14:01.995450 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m12:14:01.996448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:03.162804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:14:03.166766 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 12:14:01.988439 => 12:14:03.166766
[0m12:14:03.167766 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m12:14:03.311776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CB346060>]}
[0m12:14:03.313776 [info ] [Thread-1 (]: 4 of 5 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.33s]
[0m12:14:03.317724 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m12:14:03.321776 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:14:03.323767 [info ] [Thread-1 (]: 5 of 5 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:14:03.326718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churned_customer_table)
[0m12:14:03.327718 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:14:03.334713 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:14:03.337714 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:14:03.328714 => 12:14:03.336753
[0m12:14:03.338708 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:14:03.342747 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:14:03.345745 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:14:03.346708 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS churned_count_last_month
FROM transactions
WHERE transaction_date < CURRENT_DATE - INTERVAL '1 month'
GROUP BY customer_id
HAVING COUNT(*) = 0

UNION ALL

SELECT
    customer_id,
    COUNT(*) AS churned_count_last_three_months
FROM transactions
WHERE transaction_date < CURRENT_DATE - INTERVAL '3 months'
GROUP BY customer_id
HAVING COUNT(*) = 0

UNION ALL

SELECT
    customer_id,
    COUNT(*) AS churned_count_last_year
FROM transactions
WHERE transaction_date < CURRENT_DATE - INTERVAL '1 year'
GROUP BY customer_id
HAVING COUNT(*) = 0
        );
[0m12:14:03.346708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:04.061048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:14:04.065038 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:14:03.338708 => 12:14:04.065038
[0m12:14:04.065038 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:14:04.209679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1713657f-bc78-45a8-b6e8-991903ae74c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257CB2EC380>]}
[0m12:14:04.210677 [info ] [Thread-1 (]: 5 of 5 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 0.88s]
[0m12:14:04.213260 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:14:04.217296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:04.218290 [debug] [MainThread]: Connection 'create_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:14:04.219294 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:14:04.219294 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:14:04.220293 [info ] [MainThread]: 
[0m12:14:04.221295 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.18 seconds (10.18s).
[0m12:14:04.224248 [debug] [MainThread]: Command end result
[0m12:14:04.255007 [info ] [MainThread]: 
[0m12:14:04.256000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:04.256999 [info ] [MainThread]: 
[0m12:14:04.256999 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:14:04.258999 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:04.258032 after 14.04 seconds
[0m12:14:04.258999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C8B5EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C8C5DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C93B76E0>]}
[0m12:14:04.260032 [debug] [MainThread]: Flushing usage events
[0m12:15:36.392518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B11B08380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B0E8D40E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B11B092B0>]}


============================== 12:15:36.397552 | fdc56173-d650-4053-beda-fa45da1df8bb ==============================
[0m12:15:36.397552 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:15:36.398572 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:15:36.904228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc56173-d650-4053-beda-fa45da1df8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B11C69FA0>]}
[0m12:15:37.004849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc56173-d650-4053-beda-fa45da1df8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1237BBC0>]}
[0m12:15:37.006554 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:15:37.016221 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:15:37.127168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:37.128168 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:15:37.279219 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mini_project_dbt.churned_customer_table' (models\transform\churned_customer_table.sql) depends on a node named 'stg_transactions' which was not found
[0m12:15:37.281015 [debug] [MainThread]: Command `dbt run` failed at 12:15:37.279973 after 0.97 seconds
[0m12:15:37.281015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B116DCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B13A2B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B12570B30>]}
[0m12:15:37.281015 [debug] [MainThread]: Flushing usage events
[0m12:16:31.304544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B0A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B0A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B09E20>]}


============================== 12:16:31.310582 | 61e681d7-97b6-4978-877f-74695aea1370 ==============================
[0m12:16:31.310582 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:16:31.311580 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:16:31.817676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B3A7B0>]}
[0m12:16:31.917301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB878FA10>]}
[0m12:16:31.918300 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:16:31.928266 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:16:32.025863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:32.026827 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:16:32.180901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:16:32.187868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB87E8F20>]}
[0m12:16:32.198867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB88DCD70>]}
[0m12:16:32.198867 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:16:32.199868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB88AE630>]}
[0m12:16:32.201901 [info ] [MainThread]: 
[0m12:16:32.203869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:32.204882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:16:32.221901 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:16:32.222901 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:16:32.222901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:33.417573 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:16:33.420574 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:16:33.573227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:16:33.598969 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:16:33.599969 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:16:33.600970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:34.167424 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:34.173426 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:16:34.327571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:16:34.331572 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:16:34.332571 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:16:34.332571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:34.864476 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:16:34.867479 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:16:35.023669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB885AFC0>]}
[0m12:16:35.023669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:35.024686 [info ] [MainThread]: 
[0m12:16:35.029362 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:16:35.030399 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:16:35.031366 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:16:35.032391 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:16:35.041399 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:16:35.043398 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:16:35.032391 => 12:16:35.043398
[0m12:16:35.044362 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:16:35.079362 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:16:35.081366 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:16:35.081366 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS churned_count_last_month
FROM transactions
WHERE transaction_date < CURRENT_DATE - INTERVAL '1 month'
GROUP BY customer_id
HAVING COUNT(*) = 0
        );
[0m12:16:35.082374 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:35.737170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:35.761141 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:16:35.044362 => 12:16:35.761141
[0m12:16:35.761141 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:16:35.899469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e681d7-97b6-4978-877f-74695aea1370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB8D27710>]}
[0m12:16:35.900513 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 0.87s]
[0m12:16:35.901518 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:16:35.904517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:35.904517 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:16:35.905515 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:16:35.905515 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:16:35.906519 [info ] [MainThread]: 
[0m12:16:35.907478 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m12:16:35.908478 [debug] [MainThread]: Command end result
[0m12:16:35.921517 [info ] [MainThread]: 
[0m12:16:35.922478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:35.923191 [info ] [MainThread]: 
[0m12:16:35.924199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:16:35.925204 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:35.925204 after 4.71 seconds
[0m12:16:35.926236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6A16CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B0A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CB6B0A0F0>]}
[0m12:16:35.927236 [debug] [MainThread]: Flushing usage events
[0m12:19:51.083625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3CA060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3CA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3CA750>]}


============================== 12:19:51.088626 | cceeb8a5-2a37-46cb-8cfa-91b4aecaf712 ==============================
[0m12:19:51.088626 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:19:51.089626 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:19:51.588472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F52AF00>]}
[0m12:19:51.689092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14E2383B0>]}
[0m12:19:51.690438 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:19:51.699059 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:19:51.806678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:51.807679 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:19:51.962286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:19:51.968834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B151085E80>]}
[0m12:19:51.978797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1511A3D40>]}
[0m12:19:51.979832 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:19:51.980798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B151354BF0>]}
[0m12:19:51.982849 [info ] [MainThread]: 
[0m12:19:51.984799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:51.985796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:19:52.003833 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:19:52.003833 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:19:52.004831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:53.592203 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:19:53.599197 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:19:53.757350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:19:53.771920 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:19:53.771920 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:19:53.772917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:54.304263 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:54.308222 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:19:54.454581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:19:54.464034 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:19:54.466060 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:19:54.468058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:54.891060 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:19:54.894104 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:19:55.052317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1513563F0>]}
[0m12:19:55.056316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:55.059310 [info ] [MainThread]: 
[0m12:19:55.072935 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:19:55.074885 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:19:55.078912 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:19:55.079912 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:19:55.095861 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:19:55.097862 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:19:55.080912 => 12:19:55.097862
[0m12:19:55.098874 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:19:55.133894 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:19:55.135862 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:19:55.135862 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS churned_count_last_month
FROM transactions
WHERE
    transaction_date = DATEADD(MONTH, -1, CURRENT_DATE)
GROUP BY customer_id
        );
[0m12:19:55.136894 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:56.021007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:19:56.044000 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:19:55.098874 => 12:19:56.044000
[0m12:19:56.044000 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:19:56.184884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cceeb8a5-2a37-46cb-8cfa-91b4aecaf712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B151604CB0>]}
[0m12:19:56.185886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.11s]
[0m12:19:56.186848 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:19:56.189847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:56.189847 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:19:56.190848 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:19:56.190848 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:19:56.191847 [info ] [MainThread]: 
[0m12:19:56.192570 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m12:19:56.194616 [debug] [MainThread]: Command end result
[0m12:19:56.205588 [info ] [MainThread]: 
[0m12:19:56.206578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:56.208579 [info ] [MainThread]: 
[0m12:19:56.208579 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:19:56.209720 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:56.209720 after 5.21 seconds
[0m12:19:56.210761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3CA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3CA060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14F3C9070>]}
[0m12:19:56.210761 [debug] [MainThread]: Flushing usage events
[0m12:28:51.337484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EB20AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EB209F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EB209430>]}


============================== 12:28:51.343518 | a862cfbe-7caf-4e7a-9530-8166b045810e ==============================
[0m12:28:51.343518 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:28:51.344487 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:28:51.911077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EADEFC20>]}
[0m12:28:52.011699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ECC50C50>]}
[0m12:28:52.013134 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:28:52.035725 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:28:53.266870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:53.266870 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:28:53.417326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:28:53.423689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ED194B60>]}
[0m12:28:53.448331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ECF8FB90>]}
[0m12:28:53.449837 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:28:53.450854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ED157140>]}
[0m12:28:53.452879 [info ] [MainThread]: 
[0m12:28:53.454846 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:53.455847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:28:53.470855 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:28:53.471855 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:28:53.471855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:54.457193 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:28:54.459229 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:28:54.602812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:28:54.614301 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:28:54.614301 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:28:54.615302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:55.145426 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:28:55.151425 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:28:55.304367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:28:55.307366 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:28:55.308366 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:28:55.308366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:55.906247 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:28:55.913246 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:28:56.067231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ECE07260>]}
[0m12:28:56.069243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:56.070547 [info ] [MainThread]: 
[0m12:28:56.074555 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:28:56.075588 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:28:56.076594 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:28:56.077614 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:28:56.088620 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:28:56.089621 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:28:56.077614 => 12:28:56.089621
[0m12:28:56.089621 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:28:56.125169 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:28:56.127139 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:28:56.128174 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
last_transaction AS (
    SELECT
        customer_id,
        MAX(transaction_date) AS last_transaction_date
    FROM transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        customer_id,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < CURRENT_DATE - INTERVAL '1 month' THEN 'churned_last_month'
            WHEN last_transaction_date < CURRENT_DATE - INTERVAL '3 months' THEN 'churned_last_three_months'
            WHEN last_transaction_date < CURRENT_DATE - INTERVAL '1 year' THEN 'churned_last_year'
            ELSE 'active'
        END AS churn_status
    FROM last_transaction
)
SELECT
    customer_id,
    last_transaction_date,
    churn_status
FROM churned_customers
        );
[0m12:28:56.128174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:28:57.037165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:28:57.060165 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:28:56.089621 => 12:28:57.060165
[0m12:28:57.061165 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:28:57.208005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a862cfbe-7caf-4e7a-9530-8166b045810e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ED271DC0>]}
[0m12:28:57.211005 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.13s]
[0m12:28:57.215006 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:28:57.222947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:57.224968 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:28:57.224968 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:28:57.224968 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:28:57.225933 [info ] [MainThread]: 
[0m12:28:57.226983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m12:28:57.227935 [debug] [MainThread]: Command end result
[0m12:28:57.240957 [info ] [MainThread]: 
[0m12:28:57.241541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:57.242586 [info ] [MainThread]: 
[0m12:28:57.242586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:57.244583 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:57.244583 after 6.02 seconds
[0m12:28:57.244583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EAF61310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188ECB3A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188EAD22240>]}
[0m12:28:57.245582 [debug] [MainThread]: Flushing usage events
[0m12:36:53.528098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012478AB92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012478ABAAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012478AB97C0>]}


============================== 12:36:53.534133 | 01db6451-30d3-48bc-b509-aa6a6c0ad2f9 ==============================
[0m12:36:53.534133 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:36:53.535102 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:36:54.036910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247A525550>]}
[0m12:36:54.136529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124786EFEC0>]}
[0m12:36:54.138511 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:36:54.147528 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:36:54.256127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:54.257129 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:36:54.415242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:36:54.421276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012479359A30>]}
[0m12:36:54.433439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247A8E46B0>]}
[0m12:36:54.433439 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:36:54.434440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247AA269C0>]}
[0m12:36:54.436439 [info ] [MainThread]: 
[0m12:36:54.438439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:54.439416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:36:54.455458 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:36:54.456454 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:36:54.456454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:55.491099 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:36:55.497100 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:36:55.652592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:36:55.661599 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:36:55.662599 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:36:55.662599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:56.352348 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:56.355335 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:36:56.507589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:36:56.516611 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:36:56.516611 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:36:56.517611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:57.119714 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:36:57.126733 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:36:57.332593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247A652FC0>]}
[0m12:36:57.333633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:57.333633 [info ] [MainThread]: 
[0m12:36:57.338598 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:36:57.338598 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:36:57.340601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:36:57.340601 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:36:57.352139 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:36:57.353143 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:36:57.340601 => 12:36:57.353143
[0m12:36:57.354157 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:36:57.388150 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:36:57.390150 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:36:57.391149 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
last_transaction AS (
    SELECT
        customer_id,
        MAX(transaction_date) AS last_transaction_date
    FROM transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        customer_id,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < max(transaction_date) THEN 'churned_last_month'
            WHEN last_transaction_date <  max(transaction_date) THEN 'churned_last_three_months'
            WHEN last_transaction_date <  max(transaction_date) THEN 'churned_last_year'
            ELSE 'active'
        END AS churn_status
    FROM last_transaction
)
SELECT
    customer_id,
    last_transaction_date,
    churn_status
FROM churned_customers
        );
[0m12:36:57.392116 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:58.027161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4a-0001-086e-0000-50e900023ca2
[0m12:36:58.027161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 45
invalid identifier 'TRANSACTION_DATE'
[0m12:36:58.028194 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:36:57.354157 => 12:36:58.028194
[0m12:36:58.028194 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:36:58.207330 [debug] [Thread-1 (]: Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 19 at position 45
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:36:58.208329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01db6451-30d3-48bc-b509-aa6a6c0ad2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247ACF6630>]}
[0m12:36:58.209329 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churned_customer_table ......... [[31mERROR[0m in 0.87s]
[0m12:36:58.210335 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:36:58.212298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:58.213332 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:36:58.213332 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:36:58.213332 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:36:58.214329 [info ] [MainThread]: 
[0m12:36:58.215024 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m12:36:58.216031 [debug] [MainThread]: Command end result
[0m12:36:58.228065 [info ] [MainThread]: 
[0m12:36:58.229074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:36:58.230107 [info ] [MainThread]: 
[0m12:36:58.230107 [error] [MainThread]:   Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 19 at position 45
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:36:58.231108 [info ] [MainThread]: 
[0m12:36:58.232077 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:36:58.234109 [debug] [MainThread]: Command `dbt run` failed at 12:36:58.234109 after 4.79 seconds
[0m12:36:58.234109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124784BA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247851D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001247A7194C0>]}
[0m12:36:58.235105 [debug] [MainThread]: Flushing usage events
[0m12:37:28.512629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569ED48830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569ED492B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569ED48290>]}


============================== 12:37:28.518595 | 68b8509e-3880-4d21-8177-b2430c947a4a ==============================
[0m12:37:28.518595 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:37:28.519596 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:37:29.026288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A08EDD90>]}
[0m12:37:29.125919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569F0C02F0>]}
[0m12:37:29.128049 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:37:29.136822 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:37:29.245409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:29.246408 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:37:29.399060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:37:29.405549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A09D83E0>]}
[0m12:37:29.416516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A0B70770>]}
[0m12:37:29.417516 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:37:29.418515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A0CB4050>]}
[0m12:37:29.420547 [info ] [MainThread]: 
[0m12:37:29.421516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:29.423516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:37:29.439588 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:37:29.439588 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:37:29.440588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:30.541735 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:37:30.543730 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:37:30.701416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:37:30.712382 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:37:30.713383 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:37:30.713383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:31.145452 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:37:31.148420 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:37:31.291452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:37:31.295452 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:37:31.295452 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:37:31.296453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:31.976581 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:37:31.979546 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:37:32.129137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569E492DE0>]}
[0m12:37:32.130126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:32.131126 [info ] [MainThread]: 
[0m12:37:32.134447 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:37:32.135472 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:37:32.136460 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:37:32.137450 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:37:32.147452 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:37:32.150454 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:37:32.137450 => 12:37:32.149453
[0m12:37:32.150454 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:37:32.184037 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:37:32.187062 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:37:32.188053 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
last_transaction AS (
    SELECT
        customer_id,
        MAX(transaction_date) AS last_transaction_date
    FROM transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        customer_id,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < max(transaction_date from transactions) THEN 'churned_last_month'
            WHEN last_transaction_date <  max(transaction_date from transactions) THEN 'churned_last_three_months'
            WHEN last_transaction_date <  max(transaction_date from transactions) THEN 'churned_last_year'
            ELSE 'active'
        END AS churn_status
    FROM last_transaction
)
SELECT
    customer_id,
    last_transaction_date,
    churn_status
FROM churned_customers
        );
[0m12:37:32.188053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:32.600447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4b-0001-087f-0000-50e90002a54e
[0m12:37:32.601447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 62 unexpected 'from'.
syntax error line 19 at position 81 unexpected 'THEN'.
syntax error line 20 at position 82 unexpected 'THEN'.
[0m12:37:32.601447 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:37:32.151490 => 12:37:32.601447
[0m12:37:32.602447 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:37:32.759996 [debug] [Thread-1 (]: Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 62 unexpected 'from'.
  syntax error line 19 at position 81 unexpected 'THEN'.
  syntax error line 20 at position 82 unexpected 'THEN'.
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:37:32.760996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b8509e-3880-4d21-8177-b2430c947a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A0F61E20>]}
[0m12:37:32.763535 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churned_customer_table ......... [[31mERROR[0m in 0.62s]
[0m12:37:32.766025 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:37:32.771017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:32.771980 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:37:32.771980 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:37:32.773020 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:37:32.774018 [info ] [MainThread]: 
[0m12:37:32.784428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m12:37:32.786669 [debug] [MainThread]: Command end result
[0m12:37:32.795637 [info ] [MainThread]: 
[0m12:37:32.796680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:37:32.797639 [info ] [MainThread]: 
[0m12:37:32.798637 [error] [MainThread]:   Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 62 unexpected 'from'.
  syntax error line 19 at position 81 unexpected 'THEN'.
  syntax error line 20 at position 82 unexpected 'THEN'.
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:37:32.799637 [info ] [MainThread]: 
[0m12:37:32.799637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:37:32.801670 [debug] [MainThread]: Command `dbt run` failed at 12:37:32.801670 after 4.39 seconds
[0m12:37:32.801670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569ED1AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156A0F15F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001569EC3CCE0>]}
[0m12:37:32.802637 [debug] [MainThread]: Flushing usage events
[0m12:40:46.272210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E6DCA3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E6DC9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E6DC9730>]}


============================== 12:40:46.277218 | c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0 ==============================
[0m12:40:46.277218 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:40:46.278218 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:40:46.780809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E7796930>]}
[0m12:40:46.882432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E5C17E30>]}
[0m12:40:46.883696 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:40:46.892736 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:40:47.000436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:47.001433 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:40:47.155076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:40:47.160772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E8D46960>]}
[0m12:40:47.173776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E8B902C0>]}
[0m12:40:47.174739 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:40:47.174739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E8A75E80>]}
[0m12:40:47.176742 [info ] [MainThread]: 
[0m12:40:47.178741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:47.180771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:40:47.195773 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:40:47.195773 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:40:47.196789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:48.849473 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m12:40:48.853473 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:40:49.005295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m12:40:49.014329 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:40:49.015328 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:40:49.015328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:49.538798 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:40:49.545790 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:40:49.697176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:40:49.710136 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:40:49.711136 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:40:49.711136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:50.162953 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:40:50.165917 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:40:50.321513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E895E8A0>]}
[0m12:40:50.324521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:50.325483 [info ] [MainThread]: 
[0m12:40:50.329478 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:40:50.330504 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:40:50.331475 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:40:50.332513 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:40:50.342509 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:40:50.344480 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:40:50.332513 => 12:40:50.343509
[0m12:40:50.344480 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:40:50.379130 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:40:50.382122 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:40:50.382122 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:40:50.383134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:51.028062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4e-0001-0878-0000-50e90002c4e6
[0m12:40:51.029095 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 12
invalid identifier 'PAYMENT_DATE'
[0m12:40:51.029095 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:40:50.345511 => 12:40:51.029095
[0m12:40:51.030094 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:40:51.172340 [debug] [Thread-1 (]: Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:40:51.172340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b0bdf0-4ea7-4b80-9eaa-2be9c5ae8cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E8A48230>]}
[0m12:40:51.173333 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churned_customer_table ......... [[31mERROR[0m in 0.84s]
[0m12:40:51.174270 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:40:51.177310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:51.177310 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:40:51.178314 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:40:51.178314 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:40:51.179311 [info ] [MainThread]: 
[0m12:40:51.179311 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m12:40:51.180696 [debug] [MainThread]: Command end result
[0m12:40:51.192706 [info ] [MainThread]: 
[0m12:40:51.193697 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:51.194697 [info ] [MainThread]: 
[0m12:40:51.194697 [error] [MainThread]:   Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:40:51.195730 [info ] [MainThread]: 
[0m12:40:51.196696 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:40:51.197736 [debug] [MainThread]: Command `dbt run` failed at 12:40:51.197736 after 5.01 seconds
[0m12:40:51.198736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E69CF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E6DF6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194E6BAAB40>]}
[0m12:40:51.198736 [debug] [MainThread]: Flushing usage events
[0m12:41:34.511523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1A1D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1C4A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1C49EB0>]}


============================== 12:41:34.517237 | 1b37fc16-4006-4fb9-b4b4-7f3f9af98fda ==============================
[0m12:41:34.517237 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:41:34.518205 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:41:35.144747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1CC8080>]}
[0m12:41:35.250418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1C78200>]}
[0m12:41:35.251683 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:41:35.271321 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:41:36.561221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:36.562222 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:41:36.727742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:41:36.733749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A3C04B60>]}
[0m12:41:36.758300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A3A50170>]}
[0m12:41:36.759299 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:41:36.760300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A375ECC0>]}
[0m12:41:36.762335 [info ] [MainThread]: 
[0m12:41:36.763299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:36.765303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:41:36.782335 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:41:36.783300 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:41:36.783300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:37.889462 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:41:37.892416 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:41:38.033937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:41:38.043939 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:41:38.043939 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:41:38.044937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:38.614992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:41:38.616992 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:41:38.757347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:41:38.760309 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:41:38.760309 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:41:38.761316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:39.316583 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:41:39.318552 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:41:39.469702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A3813DA0>]}
[0m12:41:39.470690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:39.470690 [info ] [MainThread]: 
[0m12:41:39.475690 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:41:39.476690 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:41:39.477690 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:41:39.478691 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:41:39.487731 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:41:39.489697 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:41:39.478691 => 12:41:39.489697
[0m12:41:39.490696 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:41:39.532211 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:41:39.535210 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:41:39.536215 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date,
        MIN(transaction_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:41:39.537213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:41.025605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:41:41.049596 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:41:39.490696 => 12:41:41.049596
[0m12:41:41.050597 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:41:41.194235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b37fc16-4006-4fb9-b4b4-7f3f9af98fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A3E66CF0>]}
[0m12:41:41.197235 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.72s]
[0m12:41:41.201234 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:41:41.208823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:41.210869 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:41:41.210869 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:41:41.210869 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:41:41.211869 [info ] [MainThread]: 
[0m12:41:41.211869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m12:41:41.213838 [debug] [MainThread]: Command end result
[0m12:41:41.225835 [info ] [MainThread]: 
[0m12:41:41.226865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:41.226865 [info ] [MainThread]: 
[0m12:41:41.227869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:41:41.228952 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:41.228952 after 6.83 seconds
[0m12:41:41.229994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A1AE8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A191F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0A19824B0>]}
[0m12:41:41.229994 [debug] [MainThread]: Flushing usage events
[0m12:42:54.076805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002ED49940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002ED4AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002ED498E0>]}


============================== 12:42:54.082810 | 85bd32de-5918-44cb-ac91-f53977b984d5 ==============================
[0m12:42:54.082810 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:42:54.083297 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:42:54.585945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200308DC200>]}
[0m12:42:54.687466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200308D32F0>]}
[0m12:42:54.689215 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:42:54.698257 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:42:54.805652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:54.805652 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:42:54.958263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:42:54.964250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020030ABC0E0>]}
[0m12:42:54.994528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020030B100E0>]}
[0m12:42:54.994528 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:42:54.995489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002F63F0B0>]}
[0m12:42:54.997514 [info ] [MainThread]: 
[0m12:42:54.998525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:54.999524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:42:55.016039 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:42:55.016039 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:42:55.017043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:56.112841 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:42:56.117459 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:42:56.273315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:42:56.284308 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:42:56.284308 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:42:56.285305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:56.886580 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:42:56.892578 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:42:57.044902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:42:57.047902 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:42:57.047902 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:42:57.047902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:57.602813 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:42:57.605812 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:42:57.757317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002F793110>]}
[0m12:42:57.759318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:57.760202 [info ] [MainThread]: 
[0m12:42:57.764533 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:42:57.764533 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:42:57.766539 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:42:57.766539 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:42:57.777574 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:42:57.779540 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:42:57.766539 => 12:42:57.778574
[0m12:42:57.779540 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:42:57.813581 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:42:57.817540 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:42:57.818539 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date,
        MIN(transaction_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:42:57.818539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:59.006759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:42:59.030833 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:42:57.780574 => 12:42:59.029838
[0m12:42:59.030833 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:42:59.171764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85bd32de-5918-44cb-ac91-f53977b984d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020030F24B60>]}
[0m12:42:59.174765 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.41s]
[0m12:42:59.178764 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:42:59.186765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:59.187771 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:42:59.187771 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:42:59.187771 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:42:59.188735 [info ] [MainThread]: 
[0m12:42:59.189734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m12:42:59.190702 [debug] [MainThread]: Command end result
[0m12:42:59.201736 [info ] [MainThread]: 
[0m12:42:59.202654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:59.203664 [info ] [MainThread]: 
[0m12:42:59.204664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:59.205695 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:59.205695 after 5.21 seconds
[0m12:42:59.206695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002E8F10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002EC0D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002E9C0470>]}
[0m12:42:59.206695 [debug] [MainThread]: Flushing usage events
[0m12:44:31.444535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF75BB8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF75BB8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF75BB94F0>]}


============================== 12:44:31.450532 | 055ff2d5-9faa-4a7a-8a80-5daa7a943521 ==============================
[0m12:44:31.450532 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:44:31.451534 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:44:31.958125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF76508A40>]}
[0m12:44:32.058779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF764837D0>]}
[0m12:44:32.059779 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:44:32.068780 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:44:32.175296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:32.176296 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:44:32.332282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:44:32.338382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF75B89D60>]}
[0m12:44:32.351350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7797C230>]}
[0m12:44:32.352350 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:44:32.353390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF764834A0>]}
[0m12:44:32.354391 [info ] [MainThread]: 
[0m12:44:32.356384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:32.357409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:44:32.372417 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:44:32.372417 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:44:32.373450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:33.523984 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:44:33.525961 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:44:33.673914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m12:44:33.682914 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:44:33.682914 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:44:33.683914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:34.241688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:44:34.244684 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:44:34.392347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:44:34.404286 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:44:34.405277 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:44:34.405277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:34.809187 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:44:34.812157 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:44:34.959145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF778A19A0>]}
[0m12:44:34.963226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:34.963674 [info ] [MainThread]: 
[0m12:44:34.968155 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:44:34.969189 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:44:34.970154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:44:34.971156 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:44:34.982163 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:44:34.984155 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:44:34.971156 => 12:44:34.984155
[0m12:44:34.985184 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:44:35.027153 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:44:35.030153 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:44:35.030153 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date,
        MIN(transaction_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:44:35.031155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:36.152756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:44:36.178732 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:44:34.985184 => 12:44:36.177732
[0m12:44:36.178732 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:44:36.325639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055ff2d5-9faa-4a7a-8a80-5daa7a943521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF7790BE00>]}
[0m12:44:36.328638 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.36s]
[0m12:44:36.333106 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:44:36.340195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:36.342177 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:44:36.342177 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:44:36.343166 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:44:36.343166 [info ] [MainThread]: 
[0m12:44:36.344131 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m12:44:36.345143 [debug] [MainThread]: Command end result
[0m12:44:36.355944 [info ] [MainThread]: 
[0m12:44:36.355944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:36.356967 [info ] [MainThread]: 
[0m12:44:36.357964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:44:36.358940 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:36.358940 after 5.00 seconds
[0m12:44:36.359930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF757EF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF75608A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF758ECCE0>]}
[0m12:44:36.359930 [debug] [MainThread]: Flushing usage events
[0m12:45:10.826503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FA468BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FA46A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FA468710>]}


============================== 12:45:10.831534 | 2d403339-2524-42aa-b430-fb9ba7957e96 ==============================
[0m12:45:10.831534 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:10.832530 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m12:45:11.338367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FAD85100>]}
[0m12:45:11.440990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FA5C9EB0>]}
[0m12:45:11.441990 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:45:11.451041 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:11.550621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:11.551620 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:45:11.706030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:45:11.712230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FADB8AA0>]}
[0m12:45:11.722772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FC280710>]}
[0m12:45:11.723798 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:45:11.724771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FACD7B30>]}
[0m12:45:11.726805 [info ] [MainThread]: 
[0m12:45:11.727771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:11.729807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:45:11.746807 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:45:11.746807 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:45:11.747805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:12.895537 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:45:12.899537 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:45:13.047624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m12:45:13.058618 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:45:13.058618 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:45:13.058618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:13.622244 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:45:13.628250 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:45:13.788118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:45:13.797084 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:45:13.797084 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:45:13.798086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:14.349988 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:14.353034 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:45:14.542346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FBFF0E00>]}
[0m12:45:14.543345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:14.543345 [info ] [MainThread]: 
[0m12:45:14.547346 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:45:14.548371 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:45:14.549345 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:45:14.550344 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:45:14.560499 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:45:14.562497 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:45:14.550344 => 12:45:14.562497
[0m12:45:14.563525 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:45:14.597530 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:45:14.599529 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:45:14.600529 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date,
        MIN(transaction_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:45:14.600529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:15.601347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:15.624337 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:45:14.563525 => 12:45:15.624337
[0m12:45:15.624337 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:45:15.765916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d403339-2524-42aa-b430-fb9ba7957e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FC63E6F0>]}
[0m12:45:15.768918 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.22s]
[0m12:45:15.772930 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:45:15.779914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:15.779914 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:45:15.780886 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:45:15.780886 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:45:15.781885 [info ] [MainThread]: 
[0m12:45:15.781885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m12:45:15.783854 [debug] [MainThread]: Command end result
[0m12:45:15.795852 [info ] [MainThread]: 
[0m12:45:15.796857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:15.797872 [info ] [MainThread]: 
[0m12:45:15.798891 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:15.799886 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:15.799886 after 5.06 seconds
[0m12:45:15.799886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F9F85C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FC1DEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FA32D9D0>]}
[0m12:45:15.800889 [debug] [MainThread]: Flushing usage events
[0m12:45:54.027292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106AD92E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106AD97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106AD8770>]}


============================== 12:45:54.033326 | af52f728-1dd9-4379-ae76-263175afeeb3 ==============================
[0m12:45:54.033326 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:54.034327 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:45:54.543988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231067095B0>]}
[0m12:45:54.646613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106E503B0>]}
[0m12:45:54.647613 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:45:54.656611 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:54.765390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:54.765390 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:45:54.919873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:45:54.938716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231037E1460>]}
[0m12:45:54.952715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231089101A0>]}
[0m12:45:54.952715 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:45:54.953752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002310886FC20>]}
[0m12:45:54.955742 [info ] [MainThread]: 
[0m12:45:54.956715 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:54.958146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:45:54.974159 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:45:54.974159 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:45:54.975154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:55.912696 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:45:55.913696 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:45:56.067852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m12:45:56.088848 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:45:56.089848 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:45:56.089848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:56.640876 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:45:56.647968 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:45:56.809400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m12:45:56.823413 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:45:56.825389 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:45:56.826448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:57.356248 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:57.362314 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:45:57.518515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106AAAF30>]}
[0m12:45:57.521513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:57.522444 [info ] [MainThread]: 
[0m12:45:57.526110 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:45:57.527150 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:45:57.528158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:45:57.529190 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:45:57.541158 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:45:57.542157 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:45:57.529190 => 12:45:57.542157
[0m12:45:57.543157 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:45:57.577706 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:45:57.579707 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:45:57.580708 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date,
        MIN(transaction_date) AS min_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(day, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:45:57.580708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:58.707084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:45:58.732092 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:45:57.543664 => 12:45:58.731096
[0m12:45:58.732092 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:45:58.868706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af52f728-1dd9-4379-ae76-263175afeeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023108D1E8A0>]}
[0m12:45:58.869709 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.34s]
[0m12:45:58.872709 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:45:58.876709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:58.876709 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:45:58.877710 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m12:45:58.878709 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:45:58.879694 [info ] [MainThread]: 
[0m12:45:58.880222 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m12:45:58.881311 [debug] [MainThread]: Command end result
[0m12:45:58.893978 [info ] [MainThread]: 
[0m12:45:58.894986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:58.895985 [info ] [MainThread]: 
[0m12:45:58.895985 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:58.898012 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:58.896986 after 4.96 seconds
[0m12:45:58.898012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106851190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023106480140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231067EF530>]}
[0m12:45:58.899010 [debug] [MainThread]: Flushing usage events
[0m12:47:41.522093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A908A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A8B99100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A908B200>]}


============================== 12:47:41.528128 | dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2 ==============================
[0m12:47:41.528128 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:47:41.529127 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:47:42.041075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A90BA000>]}
[0m12:47:42.146287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A9907EC0>]}
[0m12:47:42.147781 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:47:42.156329 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:47:42.263235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:42.264236 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:47:42.418700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:47:42.424892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173AB016960>]}
[0m12:47:42.437906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173AAE0BB90>]}
[0m12:47:42.437906 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:47:42.439210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173AAFF5700>]}
[0m12:47:42.441251 [info ] [MainThread]: 
[0m12:47:42.443235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:42.445217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:47:42.460251 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:47:42.460251 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:47:42.461251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:43.403182 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:47:43.406182 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:47:43.555944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:47:43.582915 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:47:43.583909 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:47:43.583909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:44.104401 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:47:44.110405 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:47:44.263855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:47:44.273854 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:47:44.274870 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:47:44.275868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:44.832782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:47:44.839776 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:47:44.980322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173AAE0B860>]}
[0m12:47:44.982274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:44.983211 [info ] [MainThread]: 
[0m12:47:44.992466 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:47:44.994519 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:47:44.997464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:47:44.998465 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:47:45.010051 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:47:45.012094 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:47:44.999465 => 12:47:45.012094
[0m12:47:45.013012 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:47:45.046046 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:47:45.049007 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:47:45.049007 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:47:45.050007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:45.837667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff55-0001-086e-0000-50e900023d1a
[0m12:47:45.838668 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'FLP.FIRST_PURCHASE_DATE'
[0m12:47:45.838668 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:47:45.013012 => 12:47:45.838668
[0m12:47:45.839668 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:47:46.030606 [debug] [Thread-1 (]: Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'FLP.FIRST_PURCHASE_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:47:46.030606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc82f3ed-c0d0-40b7-a4f2-5003e6ad0aa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173AB2C4E90>]}
[0m12:47:46.031605 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churned_customer_table ......... [[31mERROR[0m in 1.04s]
[0m12:47:46.033603 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:47:46.036604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:46.037605 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:47:46.037605 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:47:46.037605 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:47:46.038603 [info ] [MainThread]: 
[0m12:47:46.039603 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:47:46.040605 [debug] [MainThread]: Command end result
[0m12:47:46.052602 [info ] [MainThread]: 
[0m12:47:46.053652 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:46.054604 [info ] [MainThread]: 
[0m12:47:46.054604 [error] [MainThread]:   Database Error in model churned_customer_table (models\transform\churned_customer_table.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'FLP.FIRST_PURCHASE_DATE'
  compiled Code at target\run\mini_project_dbt\models\transform\churned_customer_table.sql
[0m12:47:46.055639 [info ] [MainThread]: 
[0m12:47:46.056512 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:46.057521 [debug] [MainThread]: Command `dbt run` failed at 12:47:46.057521 after 4.62 seconds
[0m12:47:46.058554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A8F79040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A8E024B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173A90562D0>]}
[0m12:47:46.058554 [debug] [MainThread]: Flushing usage events
[0m12:48:33.544830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA85E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA85E9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA85E82C0>]}


============================== 12:48:33.549840 | c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19 ==============================
[0m12:48:33.549840 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:48:33.550818 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churned_customer_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m12:48:34.052816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA207080>]}
[0m12:48:34.154336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA8E78E00>]}
[0m12:48:34.155851 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:48:34.164858 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:48:34.273410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:34.274412 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m12:48:34.431150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m12:48:34.437211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA23B3E0>]}
[0m12:48:34.448245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA3B0140>]}
[0m12:48:34.449256 [info ] [MainThread]: Found 5 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:48:34.449256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA565A30>]}
[0m12:48:34.452223 [info ] [MainThread]: 
[0m12:48:34.453223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:34.454258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m12:48:34.471256 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m12:48:34.471256 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m12:48:34.472256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:35.507679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:48:35.513765 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m12:48:35.666634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m12:48:35.691610 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m12:48:35.692610 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m12:48:35.693611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:36.250094 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:36.257090 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m12:48:36.412997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m12:48:36.422047 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m12:48:36.422047 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m12:48:36.422047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:36.962194 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:48:36.965159 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m12:48:37.110174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA50F590>]}
[0m12:48:37.112176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:37.113167 [info ] [MainThread]: 
[0m12:48:37.117167 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_table
[0m12:48:37.118199 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churned_customer_table .................. [RUN]
[0m12:48:37.119206 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churned_customer_table'
[0m12:48:37.120206 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_table
[0m12:48:37.131240 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_table"
[0m12:48:37.132240 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (compile): 12:48:37.120206 => 12:48:37.132240
[0m12:48:37.133206 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_table
[0m12:48:37.185259 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_table"
[0m12:48:37.187256 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_table"
[0m12:48:37.188261 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_table
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:48:37.188261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:38.439401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:38.464360 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_table (execute): 12:48:37.152229 => 12:48:38.464360
[0m12:48:38.464360 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_table: Close
[0m12:48:38.607238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0bbe2-cd3e-47c1-b196-7fb7cc6d1d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA7C4B90>]}
[0m12:48:38.608235 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churned_customer_table ............. [[32mSUCCESS 1[0m in 1.49s]
[0m12:48:38.609199 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_table
[0m12:48:38.611201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:38.612236 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m12:48:38.612236 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m12:48:38.613236 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_table' was properly closed.
[0m12:48:38.613236 [info ] [MainThread]: 
[0m12:48:38.614239 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m12:48:38.616201 [debug] [MainThread]: Command end result
[0m12:48:38.627018 [info ] [MainThread]: 
[0m12:48:38.628059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:38.630026 [info ] [MainThread]: 
[0m12:48:38.630026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:38.632026 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:38.632026 after 5.17 seconds
[0m12:48:38.632026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA81A3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA7EFA2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA8272DB0>]}
[0m12:48:38.633026 [debug] [MainThread]: Flushing usage events
[0m13:10:07.323222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F8CC6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F8CC5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F8CC67E0>]}


============================== 13:10:07.335342 | de17a3f4-78bc-4556-83a4-6635242c3582 ==============================
[0m13:10:07.335342 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:10:07.337568 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:10:08.203766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F8ADA810>]}
[0m13:10:08.307423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F8CFBD70>]}
[0m13:10:08.308424 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:10:08.335076 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:10:09.615522 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m13:10:09.616554 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churned_customer_last_month.sql
[0m13:10:09.616554 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churned_customer_last_three.sql
[0m13:10:09.617557 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churned_customer_last_year.sql
[0m13:10:09.617557 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churned_customer_table.sql
[0m13:10:09.779037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m13:10:09.785073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FACF4E00>]}
[0m13:10:09.816601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAAEF620>]}
[0m13:10:09.816601 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:10:09.817601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FA856630>]}
[0m13:10:09.821633 [info ] [MainThread]: 
[0m13:10:09.822602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:09.824634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m13:10:09.839221 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:10:09.840218 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:10:09.840218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:11.101457 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:10:11.103457 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:10:11.306554 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:10:11.307540 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:10:11.307540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:11.887461 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:10:11.889450 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:10:12.083390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m13:10:12.093352 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m13:10:12.094353 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m13:10:12.094353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:12.897627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:12.904627 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m13:10:13.081986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m13:10:13.084986 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m13:10:13.085987 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m13:10:13.086987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:13.562752 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:10:13.565765 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m13:10:13.728110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FADC95B0>]}
[0m13:10:13.729131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:13.730096 [info ] [MainThread]: 
[0m13:10:13.751556 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m13:10:13.751556 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.staging_country_region_table .............. [RUN]
[0m13:10:13.753558 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m13:10:13.754560 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m13:10:13.767640 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m13:10:13.769607 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 13:10:13.755604 => 13:10:13.768644
[0m13:10:13.770604 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m13:10:13.807119 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m13:10:13.809116 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m13:10:13.809116 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m13:10:13.810117 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:15.331716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:15.355687 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 13:10:13.770604 => 13:10:15.354689
[0m13:10:15.355687 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m13:10:15.500360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAF5CE60>]}
[0m13:10:15.502361 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.staging_country_region_table ......... [[32mSUCCESS 1[0m in 1.75s]
[0m13:10:15.506315 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m13:10:15.508931 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m13:10:15.510954 [info ] [Thread-1 (]: 2 of 7 START sql table model staging.staging_customers_table ................... [RUN]
[0m13:10:15.513955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m13:10:15.514952 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m13:10:15.520944 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m13:10:15.523947 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 13:10:15.515949 => 13:10:15.522948
[0m13:10:15.524999 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m13:10:15.527980 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m13:10:15.529990 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m13:10:15.530982 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:10:15.530982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:16.813680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:16.817649 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 13:10:15.524999 => 13:10:16.817649
[0m13:10:16.817649 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m13:10:16.978798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAFA4830>]}
[0m13:10:16.981799 [info ] [Thread-1 (]: 2 of 7 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.47s]
[0m13:10:16.985809 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m13:10:16.988797 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m13:10:16.991329 [info ] [Thread-1 (]: 3 of 7 START sql table model staging.staging_products_table .................... [RUN]
[0m13:10:16.993459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m13:10:16.995506 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m13:10:17.055779 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m13:10:17.056744 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 13:10:16.996508 => 13:10:17.056744
[0m13:10:17.057744 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m13:10:17.060781 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m13:10:17.062780 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m13:10:17.062780 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:10:17.063778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:18.919602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:18.922611 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 13:10:17.057744 => 13:10:18.922611
[0m13:10:18.922611 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m13:10:19.132459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAF77140>]}
[0m13:10:19.135462 [info ] [Thread-1 (]: 3 of 7 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 2.14s]
[0m13:10:19.139629 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m13:10:19.141573 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m13:10:19.142627 [info ] [Thread-1 (]: 4 of 7 START sql table model staging.staging_transactions_table ................ [RUN]
[0m13:10:19.144565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m13:10:19.144565 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m13:10:19.149567 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m13:10:19.151565 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 13:10:19.145598 => 13:10:19.150605
[0m13:10:19.151565 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m13:10:19.154597 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m13:10:19.157599 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m13:10:19.157599 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:10:19.158583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:20.245580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:20.249577 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 13:10:19.152598 => 13:10:20.249577
[0m13:10:20.250533 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m13:10:20.385087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAF5C9B0>]}
[0m13:10:20.386087 [info ] [Thread-1 (]: 4 of 7 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.24s]
[0m13:10:20.388089 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m13:10:20.389089 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m13:10:20.391087 [info ] [Thread-1 (]: 5 of 7 START sql table model transform.churned_customer_last_month ............. [RUN]
[0m13:10:20.393089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churned_customer_last_month)
[0m13:10:20.394088 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m13:10:20.402086 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:10:20.404087 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 13:10:20.394088 => 13:10:20.403085
[0m13:10:20.404087 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m13:10:20.408084 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:10:20.411085 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m13:10:20.412091 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:10:20.413086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:21.494131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:21.497131 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 13:10:20.405087 => 13:10:21.496131
[0m13:10:21.497131 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m13:10:21.655389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FACF50D0>]}
[0m13:10:21.656380 [info ] [Thread-1 (]: 5 of 7 OK created sql table model transform.churned_customer_last_month ........ [[32mSUCCESS 1[0m in 1.26s]
[0m13:10:21.658386 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m13:10:21.660381 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m13:10:21.661258 [info ] [Thread-1 (]: 6 of 7 START sql table model transform.churned_customer_last_three ............. [RUN]
[0m13:10:21.663622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m13:10:21.664651 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m13:10:21.672619 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:10:21.693901 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 13:10:21.665656 => 13:10:21.692929
[0m13:10:21.694901 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m13:10:21.697940 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:10:21.702984 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m13:10:21.703986 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:10:21.703986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:22.965334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:22.968302 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 13:10:21.694901 => 13:10:22.968302
[0m13:10:22.968302 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m13:10:23.173534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAC182C0>]}
[0m13:10:23.174523 [info ] [Thread-1 (]: 6 of 7 OK created sql table model transform.churned_customer_last_three ........ [[32mSUCCESS 1[0m in 1.51s]
[0m13:10:23.175524 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m13:10:23.176524 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m13:10:23.176524 [info ] [Thread-1 (]: 7 of 7 START sql table model transform.churned_customer_last_year .............. [RUN]
[0m13:10:23.178524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m13:10:23.178524 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m13:10:23.183523 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:10:23.184523 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 13:10:23.179524 => 13:10:23.184523
[0m13:10:23.185526 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m13:10:23.192544 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:10:23.195524 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m13:10:23.196543 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:10:23.197527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:24.128314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:10:24.132318 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 13:10:23.185526 => 13:10:24.131318
[0m13:10:24.132318 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m13:10:24.306487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de17a3f4-78bc-4556-83a4-6635242c3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAF1B290>]}
[0m13:10:24.309480 [info ] [Thread-1 (]: 7 of 7 OK created sql table model transform.churned_customer_last_year ......... [[32mSUCCESS 1[0m in 1.13s]
[0m13:10:24.313424 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m13:10:24.320480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:24.322479 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m13:10:24.324486 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m13:10:24.325481 [debug] [MainThread]: Connection 'model.mini_project_dbt.churned_customer_last_year' was properly closed.
[0m13:10:24.327428 [info ] [MainThread]: 
[0m13:10:24.331441 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 14.51 seconds (14.51s).
[0m13:10:24.335420 [debug] [MainThread]: Command end result
[0m13:10:24.347425 [info ] [MainThread]: 
[0m13:10:24.349423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:24.350423 [info ] [MainThread]: 
[0m13:10:24.351422 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:10:24.352455 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:24.352455 after 17.15 seconds
[0m13:10:24.353423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FA7C3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FAE695E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277F885B920>]}
[0m13:10:24.353423 [debug] [MainThread]: Flushing usage events
[0m13:38:48.527204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018430DB91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018430DB9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018430DB8830>]}


============================== 13:38:48.540208 | 7a20a513-0ed4-4733-957d-8200a2261cf1 ==============================
[0m13:38:48.540208 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:38:48.542465 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:38:49.422185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184318223F0>]}
[0m13:38:49.521666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001843091CB30>]}
[0m13:38:49.523667 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:38:49.549163 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:38:50.875072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m13:38:50.875072 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_customer_last_month.sql
[0m13:38:50.876084 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_customer_three_month.sql
[0m13:38:50.876084 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_customer_last_year.sql
[0m13:38:51.055144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m13:38:51.061178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432D85310>]}
[0m13:38:51.092130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432B74170>]}
[0m13:38:51.093133 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:38:51.094130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432D5A210>]}
[0m13:38:51.097132 [info ] [MainThread]: 
[0m13:38:51.098096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:51.100096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m13:38:51.116131 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:38:51.117096 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:38:51.117096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:52.422677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:38:52.426678 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:38:52.580053 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:38:52.581063 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:38:52.581063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:53.174687 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:38:53.181691 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:38:53.342996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m13:38:53.353958 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m13:38:53.353958 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m13:38:53.354959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:53.949989 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:38:53.952954 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m13:38:54.097767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m13:38:54.101769 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m13:38:54.102768 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m13:38:54.103775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:54.541338 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:38:54.547336 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m13:38:54.715468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432D1EEA0>]}
[0m13:38:54.716484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:54.717490 [info ] [MainThread]: 
[0m13:38:54.731530 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m13:38:54.732530 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.staging_country_region_table ............. [RUN]
[0m13:38:54.733499 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m13:38:54.733499 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m13:38:54.749535 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m13:38:54.751495 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 13:38:54.734530 => 13:38:54.751495
[0m13:38:54.752511 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m13:38:54.787546 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m13:38:54.789579 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m13:38:54.789579 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m13:38:54.790543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:55.951283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:55.994248 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 13:38:54.752511 => 13:38:55.994248
[0m13:38:55.995246 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m13:38:56.132312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432FB3440>]}
[0m13:38:56.133855 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.40s]
[0m13:38:56.134896 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m13:38:56.134896 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m13:38:56.135897 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.staging_customers_table .................. [RUN]
[0m13:38:56.136485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m13:38:56.137526 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m13:38:56.141496 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m13:38:56.142504 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 13:38:56.137526 => 13:38:56.142504
[0m13:38:56.143526 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m13:38:56.148497 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m13:38:56.151526 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m13:38:56.151526 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:38:56.152526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:57.238808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:57.242853 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 13:38:56.143526 => 13:38:57.242853
[0m13:38:57.243854 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m13:38:57.393109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432CB9F10>]}
[0m13:38:57.396113 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.26s]
[0m13:38:57.400185 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m13:38:57.402186 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m13:38:57.404149 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.staging_products_table ................... [RUN]
[0m13:38:57.405122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m13:38:57.405122 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m13:38:57.410149 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m13:38:57.412118 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 13:38:57.406152 => 13:38:57.411119
[0m13:38:57.413119 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m13:38:57.416150 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m13:38:57.418115 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m13:38:57.418115 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:38:57.419149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:58.712413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:58.715375 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 13:38:57.413119 => 13:38:58.715375
[0m13:38:58.716375 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m13:38:58.860374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432CBA780>]}
[0m13:38:58.863304 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.46s]
[0m13:38:58.866304 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m13:38:58.867297 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m13:38:58.868300 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.staging_transactions_table ............... [RUN]
[0m13:38:58.869333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m13:38:58.869333 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m13:38:58.873336 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m13:38:58.875300 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 13:38:58.869333 => 13:38:58.874334
[0m13:38:58.875300 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m13:38:58.882301 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m13:38:58.885301 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m13:38:58.886334 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:38:58.886334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:59.844738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:59.847771 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 13:38:58.876306 => 13:38:59.847771
[0m13:38:59.847771 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m13:38:59.991427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432CBB980>]}
[0m13:38:59.994421 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.12s]
[0m13:38:59.998422 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m13:39:00.002421 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m13:39:00.005421 [info ] [Thread-1 (]: 5 of 10 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m13:39:00.007353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churned_customer_last_month)
[0m13:39:00.008354 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m13:39:00.012389 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:39:00.015353 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 13:39:00.008354 => 13:39:00.014356
[0m13:39:00.016356 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m13:39:00.020384 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:39:00.023380 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m13:39:00.023380 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:39:00.024385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:01.057770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:01.061756 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 13:39:00.016356 => 13:39:01.061756
[0m13:39:01.062756 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m13:39:01.226709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432F07DD0>]}
[0m13:39:01.229708 [info ] [Thread-1 (]: 5 of 10 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.22s]
[0m13:39:01.233195 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m13:39:01.235196 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m13:39:01.238197 [info ] [Thread-1 (]: 6 of 10 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m13:39:01.242212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m13:39:01.244218 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m13:39:01.253150 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:39:01.254164 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 13:39:01.245218 => 13:39:01.254164
[0m13:39:01.254164 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m13:39:01.257676 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:39:01.259686 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m13:39:01.260675 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:39:01.260675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.167127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:02.177129 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 13:39:01.255670 => 13:39:02.176127
[0m13:39:02.179127 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m13:39:02.334096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432FC5340>]}
[0m13:39:02.335096 [info ] [Thread-1 (]: 6 of 10 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 1.09s]
[0m13:39:02.338097 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m13:39:02.339096 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m13:39:02.341097 [info ] [Thread-1 (]: 7 of 10 START sql table model transform.churned_customer_last_year ............. [RUN]
[0m13:39:02.343097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m13:39:02.344098 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m13:39:02.354114 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:39:02.356151 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 13:39:02.345114 => 13:39:02.356151
[0m13:39:02.357115 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m13:39:02.360724 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:39:02.362724 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m13:39:02.363721 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:39:02.363721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:03.499604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:03.502566 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 13:39:02.357115 => 13:39:03.502566
[0m13:39:03.503567 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m13:39:03.650577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432FC6F30>]}
[0m13:39:03.653579 [info ] [Thread-1 (]: 7 of 10 OK created sql table model transform.churned_customer_last_year ........ [[32mSUCCESS 1[0m in 1.31s]
[0m13:39:03.657583 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m13:39:03.659577 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_month
[0m13:39:03.661572 [info ] [Thread-1 (]: 8 of 10 START sql table model transform.new_customer_last_month ................ [RUN]
[0m13:39:03.664517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.new_customer_last_month)
[0m13:39:03.664517 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_month
[0m13:39:03.672874 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_month"
[0m13:39:03.674873 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (compile): 13:39:03.665918 => 13:39:03.673904
[0m13:39:03.674873 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_month
[0m13:39:03.677902 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_month"
[0m13:39:03.679870 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_month"
[0m13:39:03.680903 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:39:03.680903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:04.433332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:04.443327 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (execute): 13:39:03.675902 => 13:39:04.442327
[0m13:39:04.445328 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: Close
[0m13:39:04.593772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432DFF3E0>]}
[0m13:39:04.596774 [info ] [Thread-1 (]: 8 of 10 OK created sql table model transform.new_customer_last_month ........... [[32mSUCCESS 1[0m in 0.93s]
[0m13:39:04.601714 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_month
[0m13:39:04.603715 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_year
[0m13:39:04.604701 [info ] [Thread-1 (]: 9 of 10 START sql table model transform.new_customer_last_year ................. [RUN]
[0m13:39:04.605343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_month, now model.mini_project_dbt.new_customer_last_year)
[0m13:39:04.606351 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_year
[0m13:39:04.611352 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_year"
[0m13:39:04.628998 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (compile): 13:39:04.606351 => 13:39:04.627982
[0m13:39:04.628998 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_year
[0m13:39:04.632027 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_year"
[0m13:39:04.633994 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_year"
[0m13:39:04.635029 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_year
FROM transactions
WHERE transaction_date >= DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:39:04.635029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:05.553153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:05.556156 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (execute): 13:39:04.630027 => 13:39:05.556156
[0m13:39:05.556156 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: Close
[0m13:39:05.696251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432BD49B0>]}
[0m13:39:05.699251 [info ] [Thread-1 (]: 9 of 10 OK created sql table model transform.new_customer_last_year ............ [[32mSUCCESS 1[0m in 1.09s]
[0m13:39:05.703382 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_year
[0m13:39:05.705318 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_three_month
[0m13:39:05.708379 [info ] [Thread-1 (]: 10 of 10 START sql table model transform.new_customer_three_month .............. [RUN]
[0m13:39:05.711368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_year, now model.mini_project_dbt.new_customer_three_month)
[0m13:39:05.712377 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_three_month
[0m13:39:05.719355 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_three_month"
[0m13:39:05.721315 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_three_month (compile): 13:39:05.713361 => 13:39:05.721315
[0m13:39:05.722356 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_three_month
[0m13:39:05.727316 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_three_month"
[0m13:39:05.729348 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_three_month"
[0m13:39:05.729348 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_three_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_three_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_three_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_three_months
FROM transactions
WHERE transaction_date >= DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:39:05.730348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:06.907911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:06.911897 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_three_month (execute): 13:39:05.723351 => 13:39:06.911897
[0m13:39:06.912918 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_three_month: Close
[0m13:39:07.063055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a20a513-0ed4-4733-957d-8200a2261cf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018432CC7C20>]}
[0m13:39:07.066053 [info ] [Thread-1 (]: 10 of 10 OK created sql table model transform.new_customer_three_month ......... [[32mSUCCESS 1[0m in 1.35s]
[0m13:39:07.070261 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_three_month
[0m13:39:07.077782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:07.078736 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m13:39:07.079752 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m13:39:07.079752 [debug] [MainThread]: Connection 'model.mini_project_dbt.new_customer_three_month' was properly closed.
[0m13:39:07.079752 [info ] [MainThread]: 
[0m13:39:07.080752 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 15.98 seconds (15.98s).
[0m13:39:07.084719 [debug] [MainThread]: Command end result
[0m13:39:07.097386 [info ] [MainThread]: 
[0m13:39:07.098424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:07.099385 [info ] [MainThread]: 
[0m13:39:07.099969 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:39:07.119814 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:07.119814 after 18.71 seconds
[0m13:39:07.120842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184328C0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018430BCAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018430BCBEC0>]}
[0m13:39:07.120842 [debug] [MainThread]: Flushing usage events
[0m13:42:35.601893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D798ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D79897C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D7988EF0>]}


============================== 13:42:35.606926 | a0324851-8518-4709-af0d-9136741e865f ==============================
[0m13:42:35.606926 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:42:35.607927 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:42:36.177195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0324851-8518-4709-af0d-9136741e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D787DC10>]}
[0m13:42:36.284824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0324851-8518-4709-af0d-9136741e865f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D7D110A0>]}
[0m13:42:36.286790 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:42:36.296823 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:42:36.429784 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 0 files changed.
[0m13:42:36.430783 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_three.sql
[0m13:42:36.431819 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_customer_last_three.sql
[0m13:42:36.431819 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_month.sql
[0m13:42:36.432820 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_year.sql
[0m13:42:36.432820 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\new_customer_three_month.sql
[0m13:42:36.590069 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mini_project_dbt.cross_sell_last_three' (models\transform\cross_sell_last_three.sql) depends on a node named 'stg_transactions' which was not found
[0m13:42:36.591044 [debug] [MainThread]: Command `dbt run` failed at 13:42:36.591044 after 1.08 seconds
[0m13:42:36.592089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D782BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D798A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2D1146120>]}
[0m13:42:36.592089 [debug] [MainThread]: Flushing usage events
[0m13:43:19.187137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FADBC97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FADBCB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FADBCAFC0>]}


============================== 13:43:19.193134 | ad073297-346c-47f4-9357-ccb05cd91c4f ==============================
[0m13:43:19.193134 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:43:19.194101 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:43:19.694056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAF79ECF0>]}
[0m13:43:19.796539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAE4CF530>]}
[0m13:43:19.798541 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:43:19.807553 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:43:19.927614 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 0 files changed.
[0m13:43:19.928612 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_month.sql
[0m13:43:19.928612 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_three.sql
[0m13:43:19.928612 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_last_year.sql
[0m13:43:19.929613 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_customer_last_three.sql
[0m13:43:19.929613 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\new_customer_three_month.sql
[0m13:43:20.096299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m13:43:20.110151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAF9816A0>]}
[0m13:43:20.123194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAF9C3CE0>]}
[0m13:43:20.124195 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:43:20.125165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAF8ED310>]}
[0m13:43:20.127717 [info ] [MainThread]: 
[0m13:43:20.129684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:20.131431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m13:43:20.147472 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:43:20.147472 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:43:20.148456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:21.306939 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:43:21.310975 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:43:21.457207 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:43:21.458234 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:43:21.458234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:22.034205 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:43:22.036202 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:43:22.189513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m13:43:22.199544 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m13:43:22.199544 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m13:43:22.199544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:22.866376 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:43:22.873375 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m13:43:23.024542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m13:43:23.028579 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m13:43:23.029580 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m13:43:23.030579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:23.574106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:43:23.576066 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m13:43:23.728947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAE670680>]}
[0m13:43:23.733000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:23.733998 [info ] [MainThread]: 
[0m13:43:23.739071 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m13:43:23.740071 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m13:43:23.741087 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m13:43:23.742072 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m13:43:23.754107 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m13:43:23.756074 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 13:43:23.742072 => 13:43:23.755105
[0m13:43:23.756074 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m13:43:23.791104 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m13:43:23.793095 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m13:43:23.793095 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m13:43:23.794108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:24.794144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:24.819173 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 13:43:23.757072 => 13:43:24.818173
[0m13:43:24.819173 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m13:43:24.967034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFE75760>]}
[0m13:43:24.969034 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.22s]
[0m13:43:24.972987 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m13:43:24.976037 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m13:43:24.978037 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m13:43:24.980974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m13:43:24.982978 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m13:43:24.989970 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m13:43:24.992976 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 13:43:24.983971 => 13:43:24.991972
[0m13:43:24.994024 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m13:43:25.048623 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m13:43:25.049626 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m13:43:25.050629 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:43:25.050629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:25.865935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:25.868933 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 13:43:24.994024 => 13:43:25.867928
[0m13:43:25.868933 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m13:43:26.015517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFA74050>]}
[0m13:43:26.018517 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.03s]
[0m13:43:26.022465 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m13:43:26.024466 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m13:43:26.027464 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m13:43:26.030872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m13:43:26.032856 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m13:43:26.039805 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m13:43:26.041803 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 13:43:26.033856 => 13:43:26.040851
[0m13:43:26.041803 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m13:43:26.045845 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m13:43:26.047825 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m13:43:26.047825 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:43:26.048811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:27.003205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:27.006206 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 13:43:26.042846 => 13:43:27.006206
[0m13:43:27.007205 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m13:43:27.149642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFA75F10>]}
[0m13:43:27.152643 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.12s]
[0m13:43:27.156643 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m13:43:27.158636 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m13:43:27.159652 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m13:43:27.162657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m13:43:27.163648 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m13:43:27.171687 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m13:43:27.173687 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 13:43:27.164689 => 13:43:27.173687
[0m13:43:27.173687 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m13:43:27.178221 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m13:43:27.181183 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m13:43:27.182218 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:43:27.182218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:28.287710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:28.290706 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 13:43:27.175220 => 13:43:28.289706
[0m13:43:28.290706 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m13:43:28.434691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFA77320>]}
[0m13:43:28.436701 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.27s]
[0m13:43:28.440690 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m13:43:28.444637 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m13:43:28.447693 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m13:43:28.451690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churned_customer_last_month)
[0m13:43:28.453628 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m13:43:28.459655 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:43:28.460654 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 13:43:28.454677 => 13:43:28.460654
[0m13:43:28.460654 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m13:43:28.464622 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:43:28.467652 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m13:43:28.467652 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:43:28.468653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:29.414264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:29.425266 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 13:43:28.461659 => 13:43:29.424266
[0m13:43:29.427265 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m13:43:29.583872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFE88FB0>]}
[0m13:43:29.583872 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.13s]
[0m13:43:29.587448 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m13:43:29.588447 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m13:43:29.589445 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m13:43:29.591448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m13:43:29.593448 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m13:43:29.599444 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:43:29.601442 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 13:43:29.593448 => 13:43:29.601442
[0m13:43:29.602445 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m13:43:29.607441 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:43:29.609439 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m13:43:29.609439 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:43:29.610442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:30.543516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:30.547505 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 13:43:29.602445 => 13:43:30.546517
[0m13:43:30.547505 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m13:43:30.716037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFE72BA0>]}
[0m13:43:30.719039 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 1.13s]
[0m13:43:30.723039 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m13:43:30.725038 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m13:43:30.728036 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churned_customer_last_year ............. [RUN]
[0m13:43:30.730978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m13:43:30.731978 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m13:43:30.739004 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:43:30.740984 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 13:43:30.732971 => 13:43:30.740008
[0m13:43:30.740984 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m13:43:30.744001 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:43:30.746016 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m13:43:30.747002 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:43:30.748002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:31.857380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:31.862308 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 13:43:30.740984 => 13:43:31.861308
[0m13:43:31.862308 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m13:43:32.004232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFE73500>]}
[0m13:43:32.007231 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churned_customer_last_year ........ [[32mSUCCESS 1[0m in 1.27s]
[0m13:43:32.011231 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m13:43:32.013231 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_month
[0m13:43:32.016219 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.cross_sell_last_month .................. [RUN]
[0m13:43:32.019166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.cross_sell_last_month)
[0m13:43:32.020171 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_month
[0m13:43:32.028208 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_month"
[0m13:43:32.030193 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_month (compile): 13:43:32.021169 => 13:43:32.030193
[0m13:43:32.031169 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_month
[0m13:43:32.035201 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_month"
[0m13:43:32.038166 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_month"
[0m13:43:32.038166 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:32.039208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:32.791859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:32.794856 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_month (execute): 13:43:32.031169 => 13:43:32.794856
[0m13:43:32.795857 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_month: Close
[0m13:43:32.939970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFDCB200>]}
[0m13:43:32.942968 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.cross_sell_last_month ............. [[32mSUCCESS 1[0m in 0.92s]
[0m13:43:32.947022 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_month
[0m13:43:32.949026 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_three
[0m13:43:32.952022 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.cross_sell_last_three .................. [RUN]
[0m13:43:32.955971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_month, now model.mini_project_dbt.cross_sell_last_three)
[0m13:43:32.958026 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_three
[0m13:43:32.969006 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_three"
[0m13:43:32.971958 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_three (compile): 13:43:32.959021 => 13:43:32.970958
[0m13:43:32.973001 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_three
[0m13:43:32.978995 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_three"
[0m13:43:32.980956 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_three"
[0m13:43:32.981991 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_three
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:32.982990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:33.805586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:33.807584 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_three (execute): 13:43:32.973996 => 13:43:33.807584
[0m13:43:33.808585 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_three: Close
[0m13:43:33.951835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFE72330>]}
[0m13:43:33.954835 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.cross_sell_last_three ............. [[32mSUCCESS 1[0m in 1.00s]
[0m13:43:33.958837 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_three
[0m13:43:33.960839 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_year
[0m13:43:33.963834 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.cross_sell_last_year .................. [RUN]
[0m13:43:33.966774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_three, now model.mini_project_dbt.cross_sell_last_year)
[0m13:43:33.968819 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_year
[0m13:43:33.976773 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_year"
[0m13:43:33.978771 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_year (compile): 13:43:33.969819 => 13:43:33.978771
[0m13:43:33.979806 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_year
[0m13:43:33.983805 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_year"
[0m13:43:33.995783 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_year"
[0m13:43:33.995783 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_year
FROM transactions
WHERE transaction_date >= DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:33.996783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:34.905000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:34.911430 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_year (execute): 13:43:33.980808 => 13:43:34.911430
[0m13:43:34.913429 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_year: Close
[0m13:43:35.061831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFEEF500>]}
[0m13:43:35.064834 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.cross_sell_last_year ............. [[32mSUCCESS 1[0m in 1.10s]
[0m13:43:35.068777 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_year
[0m13:43:35.071774 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_month
[0m13:43:35.071774 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.new_customer_last_month ............... [RUN]
[0m13:43:35.073763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_year, now model.mini_project_dbt.new_customer_last_month)
[0m13:43:35.073763 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_month
[0m13:43:35.078797 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_month"
[0m13:43:35.079762 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (compile): 13:43:35.074796 => 13:43:35.079762
[0m13:43:35.080795 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_month
[0m13:43:35.093991 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_month"
[0m13:43:35.095971 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_month"
[0m13:43:35.096996 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:35.096996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:36.392088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:36.395128 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (execute): 13:43:35.088938 => 13:43:36.395128
[0m13:43:36.396129 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: Close
[0m13:43:36.542971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFF0EDB0>]}
[0m13:43:36.545970 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.new_customer_last_month .......... [[32mSUCCESS 1[0m in 1.47s]
[0m13:43:36.549972 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_month
[0m13:43:36.551926 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_three
[0m13:43:36.553771 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.new_customer_last_three ............... [RUN]
[0m13:43:36.557454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_month, now model.mini_project_dbt.new_customer_last_three)
[0m13:43:36.558499 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_three
[0m13:43:36.565453 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_three"
[0m13:43:36.567492 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_three (compile): 13:43:36.558499 => 13:43:36.567492
[0m13:43:36.568482 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_three
[0m13:43:36.571482 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_three"
[0m13:43:36.573481 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_three"
[0m13:43:36.573481 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_three
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_three_months
FROM transactions
WHERE transaction_date >= DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:36.574481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:37.595784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:37.598748 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_three (execute): 13:43:36.568482 => 13:43:37.598748
[0m13:43:37.599788 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_three: Close
[0m13:43:37.754864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFF0CC20>]}
[0m13:43:37.757863 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.new_customer_last_three .......... [[32mSUCCESS 1[0m in 1.20s]
[0m13:43:37.761862 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_three
[0m13:43:37.763864 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_year
[0m13:43:37.767217 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.new_customer_last_year ................ [RUN]
[0m13:43:37.770396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_three, now model.mini_project_dbt.new_customer_last_year)
[0m13:43:37.771439 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_year
[0m13:43:37.778431 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_year"
[0m13:43:37.781386 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (compile): 13:43:37.772442 => 13:43:37.780428
[0m13:43:37.781386 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_year
[0m13:43:37.786426 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_year"
[0m13:43:37.788385 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_year"
[0m13:43:37.788385 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_year
FROM transactions
WHERE transaction_date >= DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:43:37.789424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:38.703479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:38.708523 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (execute): 13:43:37.782429 => 13:43:38.707528
[0m13:43:38.708523 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: Close
[0m13:43:38.849662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad073297-346c-47f4-9357-ccb05cd91c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAFB2C9B0>]}
[0m13:43:38.850661 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.new_customer_last_year ........... [[32mSUCCESS 1[0m in 1.08s]
[0m13:43:38.851658 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_year
[0m13:43:38.854627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:38.854627 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m13:43:38.855626 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m13:43:38.855626 [debug] [MainThread]: Connection 'model.mini_project_dbt.new_customer_last_year' was properly closed.
[0m13:43:38.856626 [info ] [MainThread]: 
[0m13:43:38.857626 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.73 seconds (18.73s).
[0m13:43:38.861665 [debug] [MainThread]: Command end result
[0m13:43:38.874626 [info ] [MainThread]: 
[0m13:43:38.875626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:38.875626 [info ] [MainThread]: 
[0m13:43:38.876865 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:43:38.878749 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:38.878749 after 19.78 seconds
[0m13:43:38.879747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAD5E1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FAD7E1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FACBCA4B0>]}
[0m13:43:38.880741 [debug] [MainThread]: Flushing usage events
[0m13:55:01.901719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F4BA1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F4BAB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F4B9F40>]}


============================== 13:55:01.906718 | f62c0fa2-bf19-449e-9de9-e6c104ee8e62 ==============================
[0m13:55:01.906718 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:55:01.908259 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:55:02.493654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F5126F0>]}
[0m13:55:02.593281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1107CEC0>]}
[0m13:55:02.595286 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:55:02.619556 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:55:04.107357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m13:55:04.108359 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\product_churn_last_month.sql
[0m13:55:04.109359 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\customer_revenue_ranking.sql
[0m13:55:04.109359 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\product_churn_last_year.sql
[0m13:55:04.110361 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\product_revenue_ranking.sql
[0m13:55:04.110361 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\product_churn_last_three.sql
[0m13:55:04.295058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m13:55:04.301098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F511F70>]}
[0m13:55:04.331609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF112FC530>]}
[0m13:55:04.332618 [info ] [MainThread]: Found 18 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:55:04.333601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F628F20>]}
[0m13:55:04.336601 [info ] [MainThread]: 
[0m13:55:04.337602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:04.339602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m13:55:04.356635 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:55:04.356635 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:55:04.357634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:05.634470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:55:05.637458 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:55:05.793845 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m13:55:05.795859 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m13:55:05.796846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:06.218958 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:55:06.225154 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m13:55:06.372937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m13:55:06.383909 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m13:55:06.384907 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m13:55:06.384907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:06.940881 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:06.947878 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m13:55:07.101430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m13:55:07.115428 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m13:55:07.117430 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m13:55:07.119429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:07.544668 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m13:55:07.550669 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m13:55:07.709458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1146B6E0>]}
[0m13:55:07.710458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:07.711445 [info ] [MainThread]: 
[0m13:55:07.715280 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m13:55:07.716314 [info ] [Thread-1 (]: 1 of 18 START sql table model staging.staging_country_region_table ............. [RUN]
[0m13:55:07.717281 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m13:55:07.718282 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m13:55:07.730280 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m13:55:07.732338 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 13:55:07.718282 => 13:55:07.731279
[0m13:55:07.733281 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m13:55:07.768322 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m13:55:07.770320 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m13:55:07.770320 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m13:55:07.771321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:09.337197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:55:09.361196 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 13:55:07.733281 => 13:55:09.361196
[0m13:55:09.361196 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m13:55:09.507230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF11784590>]}
[0m13:55:09.509230 [info ] [Thread-1 (]: 1 of 18 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.79s]
[0m13:55:09.514231 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m13:55:09.516229 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m13:55:09.518245 [info ] [Thread-1 (]: 2 of 18 START sql table model staging.staging_customers_table .................. [RUN]
[0m13:55:09.522174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m13:55:09.523221 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m13:55:09.583180 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m13:55:09.584215 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 13:55:09.524220 => 13:55:09.584215
[0m13:55:09.585178 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m13:55:09.588214 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m13:55:09.590178 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m13:55:09.590178 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:55:09.591211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:10.666338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:10.669305 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 13:55:09.585178 => 13:55:10.669305
[0m13:55:10.670309 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m13:55:10.817077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF11413740>]}
[0m13:55:10.818078 [info ] [Thread-1 (]: 2 of 18 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.30s]
[0m13:55:10.820042 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m13:55:10.821081 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m13:55:10.822608 [info ] [Thread-1 (]: 3 of 18 START sql table model staging.staging_products_table ................... [RUN]
[0m13:55:10.824752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m13:55:10.825752 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m13:55:10.832707 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m13:55:10.833710 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 13:55:10.825752 => 13:55:10.833710
[0m13:55:10.834708 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m13:55:10.838711 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m13:55:10.840707 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m13:55:10.840707 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:55:10.841707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:11.685294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:11.688289 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 13:55:10.835725 => 13:55:11.687288
[0m13:55:11.688289 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m13:55:11.838452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF114126C0>]}
[0m13:55:11.841454 [info ] [Thread-1 (]: 3 of 18 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.01s]
[0m13:55:11.845399 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m13:55:11.847391 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m13:55:11.847391 [info ] [Thread-1 (]: 4 of 18 START sql table model staging.staging_transactions_table ............... [RUN]
[0m13:55:11.849390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m13:55:11.849390 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m13:55:11.854423 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m13:55:11.856390 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 13:55:11.850389 => 13:55:11.855427
[0m13:55:11.856390 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m13:55:11.860423 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m13:55:11.862422 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m13:55:11.862422 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m13:55:11.863428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:13.015445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:13.037846 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 13:55:11.857423 => 13:55:13.037846
[0m13:55:13.038846 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m13:55:13.187895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1173C500>]}
[0m13:55:13.189896 [info ] [Thread-1 (]: 4 of 18 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.34s]
[0m13:55:13.193851 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m13:55:13.198813 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m13:55:13.200827 [info ] [Thread-1 (]: 5 of 18 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m13:55:13.205751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churned_customer_last_month)
[0m13:55:13.206757 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m13:55:13.212351 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:55:13.213352 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 13:55:13.207751 => 13:55:13.213352
[0m13:55:13.214352 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m13:55:13.217318 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m13:55:13.219317 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m13:55:13.220318 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:55:13.221318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:14.450529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:14.454489 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 13:55:13.214352 => 13:55:14.454489
[0m13:55:14.455485 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m13:55:14.602029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1129FC50>]}
[0m13:55:14.605119 [info ] [Thread-1 (]: 5 of 18 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.40s]
[0m13:55:14.609104 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m13:55:14.611119 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m13:55:14.613078 [info ] [Thread-1 (]: 6 of 18 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m13:55:14.616047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m13:55:14.618048 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m13:55:14.627605 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:55:14.629605 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 13:55:14.618556 => 13:55:14.629605
[0m13:55:14.630604 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m13:55:14.633601 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m13:55:14.636567 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m13:55:14.637566 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:55:14.638566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:15.740064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:15.744034 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 13:55:14.630604 => 13:55:15.744034
[0m13:55:15.761895 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m13:55:15.914193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0C221C10>]}
[0m13:55:15.917191 [info ] [Thread-1 (]: 6 of 18 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 1.30s]
[0m13:55:15.921122 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m13:55:15.923771 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m13:55:15.925772 [info ] [Thread-1 (]: 7 of 18 START sql table model transform.churned_customer_last_year ............. [RUN]
[0m13:55:15.929724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m13:55:15.930763 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m13:55:15.937708 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:55:15.939707 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 13:55:15.931763 => 13:55:15.939707
[0m13:55:15.940744 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m13:55:15.943741 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m13:55:15.945745 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m13:55:15.946731 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m13:55:15.946731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:16.947525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:16.958583 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 13:55:15.940744 => 13:55:16.957576
[0m13:55:16.960578 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m13:55:17.115062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0C221C10>]}
[0m13:55:17.123956 [info ] [Thread-1 (]: 7 of 18 OK created sql table model transform.churned_customer_last_year ........ [[32mSUCCESS 1[0m in 1.19s]
[0m13:55:17.127523 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m13:55:17.129606 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_month
[0m13:55:17.132865 [info ] [Thread-1 (]: 8 of 18 START sql table model transform.cross_sell_last_month .................. [RUN]
[0m13:55:17.136861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.cross_sell_last_month)
[0m13:55:17.137907 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_month
[0m13:55:17.143853 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_month"
[0m13:55:17.144851 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_month (compile): 13:55:17.138861 => 13:55:17.144851
[0m13:55:17.145851 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_month
[0m13:55:17.148849 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_month"
[0m13:55:17.150851 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_month"
[0m13:55:17.151850 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:17.151850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:18.100116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:18.104171 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_month (execute): 13:55:17.145851 => 13:55:18.104171
[0m13:55:18.105161 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_month: Close
[0m13:55:18.257149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF11755B80>]}
[0m13:55:18.260083 [info ] [Thread-1 (]: 8 of 18 OK created sql table model transform.cross_sell_last_month ............. [[32mSUCCESS 1[0m in 1.12s]
[0m13:55:18.264094 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_month
[0m13:55:18.266083 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_three
[0m13:55:18.267090 [info ] [Thread-1 (]: 9 of 18 START sql table model transform.cross_sell_last_three .................. [RUN]
[0m13:55:18.269072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_month, now model.mini_project_dbt.cross_sell_last_three)
[0m13:55:18.269072 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_three
[0m13:55:18.275073 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_three"
[0m13:55:18.277129 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_three (compile): 13:55:18.270070 => 13:55:18.277129
[0m13:55:18.278107 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_three
[0m13:55:18.281104 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_three"
[0m13:55:18.283104 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_three"
[0m13:55:18.283104 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_three
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:18.284103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:19.100692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:19.104684 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_three (execute): 13:55:18.278107 => 13:55:19.103685
[0m13:55:19.104684 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_three: Close
[0m13:55:19.380740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF11382ED0>]}
[0m13:55:19.380740 [info ] [Thread-1 (]: 9 of 18 OK created sql table model transform.cross_sell_last_three ............. [[32mSUCCESS 1[0m in 1.11s]
[0m13:55:19.381740 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_three
[0m13:55:19.382741 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_last_year
[0m13:55:19.383708 [info ] [Thread-1 (]: 10 of 18 START sql table model transform.cross_sell_last_year .................. [RUN]
[0m13:55:19.384743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_three, now model.mini_project_dbt.cross_sell_last_year)
[0m13:55:19.384743 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_last_year
[0m13:55:19.389721 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_last_year"
[0m13:55:19.390706 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_year (compile): 13:55:19.385705 => 13:55:19.390706
[0m13:55:19.391710 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_last_year
[0m13:55:19.394741 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_last_year"
[0m13:55:19.396741 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_last_year"
[0m13:55:19.396741 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS cross_sell_count_last_year
FROM transactions
WHERE transaction_date >= DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:19.396741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:20.572701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:20.575669 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_last_year (execute): 13:55:19.391710 => 13:55:20.575669
[0m13:55:20.576672 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_last_year: Close
[0m13:55:20.724544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF117F0170>]}
[0m13:55:20.727616 [info ] [Thread-1 (]: 10 of 18 OK created sql table model transform.cross_sell_last_year ............. [[32mSUCCESS 1[0m in 1.34s]
[0m13:55:20.731614 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_last_year
[0m13:55:20.733610 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m13:55:20.735624 [info ] [Thread-1 (]: 11 of 18 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m13:55:20.738551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m13:55:20.740599 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m13:55:20.750172 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m13:55:20.752187 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 13:55:20.741162 => 13:55:20.751171
[0m13:55:20.752187 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m13:55:20.756170 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m13:55:20.758171 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m13:55:20.758171 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m13:55:20.759176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:21.933969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:21.938939 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 13:55:20.753173 => 13:55:21.937939
[0m13:55:21.938939 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m13:55:22.084254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF114099A0>]}
[0m13:55:22.087255 [info ] [Thread-1 (]: 11 of 18 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.35s]
[0m13:55:22.091256 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m13:55:22.093254 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_month
[0m13:55:22.096207 [info ] [Thread-1 (]: 12 of 18 START sql table model transform.new_customer_last_month ............... [RUN]
[0m13:55:22.099835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.new_customer_last_month)
[0m13:55:22.101780 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_month
[0m13:55:22.107804 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_month"
[0m13:55:22.108805 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (compile): 13:55:22.103773 => 13:55:22.108805
[0m13:55:22.109764 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_month
[0m13:55:22.113767 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_month"
[0m13:55:22.115797 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_month"
[0m13:55:22.115797 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_month
FROM transactions
WHERE transaction_date >= DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:22.116797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:23.351071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:23.355114 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_month (execute): 13:55:22.109764 => 13:55:23.355114
[0m13:55:23.355114 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_month: Close
[0m13:55:23.502657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF114089B0>]}
[0m13:55:23.505661 [info ] [Thread-1 (]: 12 of 18 OK created sql table model transform.new_customer_last_month .......... [[32mSUCCESS 1[0m in 1.40s]
[0m13:55:23.509659 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_month
[0m13:55:23.511605 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_three
[0m13:55:23.514657 [info ] [Thread-1 (]: 13 of 18 START sql table model transform.new_customer_last_three ............... [RUN]
[0m13:55:23.517596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_month, now model.mini_project_dbt.new_customer_last_three)
[0m13:55:23.518643 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_three
[0m13:55:23.525593 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_three"
[0m13:55:23.527629 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_three (compile): 13:55:23.519633 => 13:55:23.527629
[0m13:55:23.528594 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_three
[0m13:55:23.532628 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_three"
[0m13:55:23.534624 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_three"
[0m13:55:23.535624 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_three
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_three_months
FROM transactions
WHERE transaction_date >= DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:23.535624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:24.338106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:24.342150 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_three (execute): 13:55:23.528594 => 13:55:24.342150
[0m13:55:24.342150 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_three: Close
[0m13:55:24.489149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1140A360>]}
[0m13:55:24.492153 [info ] [Thread-1 (]: 13 of 18 OK created sql table model transform.new_customer_last_three .......... [[32mSUCCESS 1[0m in 0.97s]
[0m13:55:24.493071 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_three
[0m13:55:24.494121 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_customer_last_year
[0m13:55:24.494121 [info ] [Thread-1 (]: 14 of 18 START sql table model transform.new_customer_last_year ................ [RUN]
[0m13:55:24.496071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_three, now model.mini_project_dbt.new_customer_last_year)
[0m13:55:24.496071 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_customer_last_year
[0m13:55:24.500104 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_customer_last_year"
[0m13:55:24.501106 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (compile): 13:55:24.496071 => 13:55:24.501106
[0m13:55:24.502071 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_customer_last_year
[0m13:55:24.505103 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_customer_last_year"
[0m13:55:24.508107 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_customer_last_year"
[0m13:55:24.508107 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_customer_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(*) AS new_count_last_year
FROM transactions
WHERE transaction_date >= DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
        );
[0m13:55:24.509105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:25.260655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:25.263614 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_customer_last_year (execute): 13:55:24.502071 => 13:55:25.263614
[0m13:55:25.263614 [debug] [Thread-1 (]: On model.mini_project_dbt.new_customer_last_year: Close
[0m13:55:25.408533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0F2A8830>]}
[0m13:55:25.409530 [info ] [Thread-1 (]: 14 of 18 OK created sql table model transform.new_customer_last_year ........... [[32mSUCCESS 1[0m in 0.91s]
[0m13:55:25.410498 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_customer_last_year
[0m13:55:25.411497 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_churn_last_month
[0m13:55:25.411497 [info ] [Thread-1 (]: 15 of 18 START sql table model transform.product_churn_last_month .............. [RUN]
[0m13:55:25.412376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_customer_last_year, now model.mini_project_dbt.product_churn_last_month)
[0m13:55:25.413418 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_churn_last_month
[0m13:55:25.416424 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_churn_last_month"
[0m13:55:25.418381 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_month (compile): 13:55:25.413418 => 13:55:25.417415
[0m13:55:25.418381 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_churn_last_month
[0m13:55:25.421416 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_churn_last_month"
[0m13:55:25.426568 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_churn_last_month"
[0m13:55:25.426568 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_churn_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_churn_last_month
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS product_churn_count_last_month
FROM transactions
WHERE transaction_date < DATEADD(month, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
HAVING COUNT(DISTINCT PRODUCT_ID) = 0
        );
[0m13:55:25.427566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:26.229131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:26.232098 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_month (execute): 13:55:25.419416 => 13:55:26.232098
[0m13:55:26.232098 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_month: Close
[0m13:55:26.375865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF117ED160>]}
[0m13:55:26.376866 [info ] [Thread-1 (]: 15 of 18 OK created sql table model transform.product_churn_last_month ......... [[32mSUCCESS 1[0m in 0.96s]
[0m13:55:26.377937 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_churn_last_month
[0m13:55:26.377937 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_churn_last_three
[0m13:55:26.378982 [info ] [Thread-1 (]: 16 of 18 START sql table model transform.product_churn_last_three .............. [RUN]
[0m13:55:26.379953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.product_churn_last_month, now model.mini_project_dbt.product_churn_last_three)
[0m13:55:26.379953 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_churn_last_three
[0m13:55:26.383979 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_churn_last_three"
[0m13:55:26.403878 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_three (compile): 13:55:26.380979 => 13:55:26.403878
[0m13:55:26.404911 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_churn_last_three
[0m13:55:26.407911 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_churn_last_three"
[0m13:55:26.409877 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_churn_last_three"
[0m13:55:26.410910 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_churn_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_churn_last_three
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS product_churn_count_last_three_months
FROM transactions
WHERE transaction_date < DATEADD(month, -3, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
HAVING COUNT(DISTINCT PRODUCT_ID) = 0
        );
[0m13:55:26.410910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:27.215960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:27.225911 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_three (execute): 13:55:26.404911 => 13:55:27.224972
[0m13:55:27.227984 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_three: Close
[0m13:55:27.375117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF117ECFB0>]}
[0m13:55:27.376117 [info ] [Thread-1 (]: 16 of 18 OK created sql table model transform.product_churn_last_three ......... [[32mSUCCESS 1[0m in 1.00s]
[0m13:55:27.377081 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_churn_last_three
[0m13:55:27.378084 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_churn_last_year
[0m13:55:27.378084 [info ] [Thread-1 (]: 17 of 18 START sql table model transform.product_churn_last_year ............... [RUN]
[0m13:55:27.380114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.product_churn_last_three, now model.mini_project_dbt.product_churn_last_year)
[0m13:55:27.380114 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_churn_last_year
[0m13:55:27.385116 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_churn_last_year"
[0m13:55:27.387080 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_year (compile): 13:55:27.381117 => 13:55:27.386117
[0m13:55:27.387080 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_churn_last_year
[0m13:55:27.391116 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_churn_last_year"
[0m13:55:27.412124 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_churn_last_year"
[0m13:55:27.412124 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_churn_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_churn_last_year
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    COUNT(DISTINCT PRODUCT_ID) AS product_churn_count_last_year
FROM transactions
WHERE transaction_date < DATEADD(year, -1, (SELECT MAX(transaction_date) FROM transactions))
GROUP BY customer_id
HAVING COUNT(DISTINCT PRODUCT_ID) = 0
        );
[0m13:55:27.413120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:28.225703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:28.227702 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_churn_last_year (execute): 13:55:27.388114 => 13:55:28.227702
[0m13:55:28.228703 [debug] [Thread-1 (]: On model.mini_project_dbt.product_churn_last_year: Close
[0m13:55:28.370100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF117ECD10>]}
[0m13:55:28.371103 [info ] [Thread-1 (]: 17 of 18 OK created sql table model transform.product_churn_last_year .......... [[32mSUCCESS 1[0m in 0.99s]
[0m13:55:28.372472 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_churn_last_year
[0m13:55:28.373520 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m13:55:28.374526 [info ] [Thread-1 (]: 18 of 18 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m13:55:28.375485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.product_churn_last_year, now model.mini_project_dbt.product_revenue_ranking)
[0m13:55:28.376518 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m13:55:28.380516 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m13:55:28.401197 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 13:55:28.376518 => 13:55:28.400191
[0m13:55:28.401197 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m13:55:28.405192 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m13:55:28.407192 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m13:55:28.408192 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m13:55:28.408192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:29.214574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:29.219537 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 13:55:28.402209 => 13:55:29.219537
[0m13:55:29.219537 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m13:55:29.355840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62c0fa2-bf19-449e-9de9-e6c104ee8e62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF117ECD10>]}
[0m13:55:29.356842 [info ] [Thread-1 (]: 18 of 18 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 0.98s]
[0m13:55:29.357849 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m13:55:29.360850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:29.360850 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m13:55:29.360850 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m13:55:29.361849 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m13:55:29.361849 [info ] [MainThread]: 
[0m13:55:29.362851 [info ] [MainThread]: Finished running 18 table models in 0 hours 0 minutes and 25.02 seconds (25.02s).
[0m13:55:29.367850 [debug] [MainThread]: Command end result
[0m13:55:29.380398 [info ] [MainThread]: 
[0m13:55:29.381407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:29.382414 [info ] [MainThread]: 
[0m13:55:29.383416 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m13:55:29.385431 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:29.385431 after 27.64 seconds
[0m13:55:29.403007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0E1310A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF115AC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF11787860>]}
[0m13:55:29.404042 [debug] [MainThread]: Flushing usage events
[0m14:32:00.077517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B793BA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B78EF22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B793BA360>]}


============================== 14:32:00.083551 | b1e6854a-1c5e-4209-92ff-45ffb7d1665b ==============================
[0m14:32:00.083551 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:32:00.084517 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:32:00.718396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B78157EF0>]}
[0m14:32:00.824056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7AF03620>]}
[0m14:32:00.826024 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:32:00.846035 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:32:02.176508 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 1 files added, 0 files changed.
[0m14:32:02.176508 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_and_new_customers.sql
[0m14:32:02.177511 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\new_customer_last_month.sql
[0m14:32:02.177511 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\new_customer_last_year.sql
[0m14:32:02.177511 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\new_customer_last_three.sql
[0m14:32:02.178508 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\product_churn_last_month.sql
[0m14:32:02.178508 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\cross_sell_last_year.sql
[0m14:32:02.179510 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\cross_sell_last_three.sql
[0m14:32:02.179510 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\product_churn_last_year.sql
[0m14:32:02.179510 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\cross_sell_last_month.sql
[0m14:32:02.180508 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\product_churn_last_three.sql
[0m14:32:02.333579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:32:02.340579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B457440>]}
[0m14:32:02.366617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B1A9670>]}
[0m14:32:02.367614 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:32:02.368109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B348620>]}
[0m14:32:02.370159 [info ] [MainThread]: 
[0m14:32:02.372117 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:02.374323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:32:02.390338 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:32:02.391339 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:32:02.391846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:03.755326 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:32:03.757326 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:32:03.909576 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:32:03.911565 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:32:03.912520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:04.524572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:32:04.530565 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:32:04.688782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:32:04.712418 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:32:04.713421 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:32:04.714423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:05.249495 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m14:32:05.257496 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:32:05.407652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:32:05.428653 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:32:05.429667 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:32:05.429667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:05.830265 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:32:05.832303 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:32:05.968926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B387170>]}
[0m14:32:05.969923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:05.970901 [info ] [MainThread]: 
[0m14:32:05.974924 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m14:32:05.975924 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.staging_country_region_table ............. [RUN]
[0m14:32:05.976891 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m14:32:05.977893 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m14:32:05.992005 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m14:32:05.994969 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 14:32:05.977893 => 14:32:05.994032
[0m14:32:05.994969 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m14:32:06.030581 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m14:32:06.032564 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m14:32:06.033580 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m14:32:06.033580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:07.723818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:32:07.747786 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 14:32:05.995996 => 14:32:07.747786
[0m14:32:07.748785 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m14:32:07.891812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B63A390>]}
[0m14:32:07.894813 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.91s]
[0m14:32:07.898813 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m14:32:07.901886 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m14:32:07.902533 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.staging_customers_table .................. [RUN]
[0m14:32:07.903151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m14:32:07.904192 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m14:32:07.908159 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m14:32:07.910160 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 14:32:07.904192 => 14:32:07.909191
[0m14:32:07.910160 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m14:32:07.916684 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m14:32:07.918684 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m14:32:07.918684 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:32:07.919683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:10.800797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:32:10.804767 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 14:32:07.911210 => 14:32:10.804767
[0m14:32:10.804767 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m14:32:10.949200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B297530>]}
[0m14:32:10.952200 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 3.05s]
[0m14:32:10.956661 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m14:32:10.958660 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m14:32:10.961659 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.staging_products_table ................... [RUN]
[0m14:32:10.964765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m14:32:10.966809 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m14:32:10.971755 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m14:32:10.972756 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 14:32:10.966809 => 14:32:10.972756
[0m14:32:10.973763 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m14:32:10.979758 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m14:32:10.981765 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m14:32:10.982796 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:32:10.983756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:11.861549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:11.864546 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 14:32:10.974758 => 14:32:11.863545
[0m14:32:11.864546 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m14:32:12.006131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B323020>]}
[0m14:32:12.007132 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.04s]
[0m14:32:12.008133 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m14:32:12.008133 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m14:32:12.009133 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.staging_transactions_table ............... [RUN]
[0m14:32:12.011133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m14:32:12.011133 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m14:32:12.016132 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m14:32:12.017131 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 14:32:12.012133 => 14:32:12.017131
[0m14:32:12.018132 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m14:32:12.021131 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m14:32:12.023131 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m14:32:12.023131 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:32:12.024132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:13.410263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:13.415234 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 14:32:12.018132 => 14:32:13.414233
[0m14:32:13.415234 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m14:32:13.565586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B14AB40>]}
[0m14:32:13.568588 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.56s]
[0m14:32:13.572539 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m14:32:13.574934 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_and_new_customers
[0m14:32:13.574934 [info ] [Thread-1 (]: 5 of 10 START sql table model transform.churn_and_new_customers ................ [RUN]
[0m14:32:13.576215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_and_new_customers)
[0m14:32:13.577228 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_and_new_customers
[0m14:32:13.581257 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_and_new_customers"
[0m14:32:13.582221 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_and_new_customers (compile): 14:32:13.577228 => 14:32:13.582221
[0m14:32:13.583226 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_and_new_customers
[0m14:32:13.588273 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_and_new_customers"
[0m14:32:13.606364 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_and_new_customers"
[0m14:32:13.607364 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_and_new_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_and_new_customers"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_and_new_customers
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month;
[0m14:32:13.607364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:14.586909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-0001-087f-0000-50e90002a88a
[0m14:32:14.587913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 14 unexpected ';'.
[0m14:32:14.588909 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_and_new_customers (execute): 14:32:13.584223 => 14:32:14.587913
[0m14:32:14.588909 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_and_new_customers: Close
[0m14:32:14.780090 [debug] [Thread-1 (]: Database Error in model churn_and_new_customers (models\transform\churn_and_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_and_new_customers.sql
[0m14:32:14.781092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B277170>]}
[0m14:32:14.781092 [error] [Thread-1 (]: 5 of 10 ERROR creating sql table model transform.churn_and_new_customers ....... [[31mERROR[0m in 1.20s]
[0m14:32:14.783055 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_and_new_customers
[0m14:32:14.783055 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m14:32:14.784086 [info ] [Thread-1 (]: 6 of 10 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m14:32:14.786087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_and_new_customers, now model.mini_project_dbt.churned_customer_last_month)
[0m14:32:14.786087 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m14:32:14.790086 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:32:14.792066 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 14:32:14.786087 => 14:32:14.791086
[0m14:32:14.792066 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m14:32:14.795085 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:32:14.797091 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m14:32:14.798086 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:32:14.799116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:16.052647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:16.054647 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 14:32:14.792066 => 14:32:16.054647
[0m14:32:16.055662 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m14:32:16.193583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B73F4D0>]}
[0m14:32:16.194583 [info ] [Thread-1 (]: 6 of 10 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.41s]
[0m14:32:16.196710 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m14:32:16.197714 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m14:32:16.198711 [info ] [Thread-1 (]: 7 of 10 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m14:32:16.200710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m14:32:16.201711 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m14:32:16.208705 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:32:16.210666 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 14:32:16.201711 => 14:32:16.209706
[0m14:32:16.211667 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m14:32:16.215702 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:32:16.218671 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m14:32:16.218671 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:32:16.219705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:17.019199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:17.022212 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 14:32:16.211667 => 14:32:17.022212
[0m14:32:17.022212 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m14:32:17.163104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B73F560>]}
[0m14:32:17.165104 [info ] [Thread-1 (]: 7 of 10 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 0.96s]
[0m14:32:17.169628 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m14:32:17.171570 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m14:32:17.174612 [info ] [Thread-1 (]: 8 of 10 START sql table model transform.churned_customer_last_year ............. [RUN]
[0m14:32:17.177559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m14:32:17.179614 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m14:32:17.187550 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:32:17.189592 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 14:32:17.180614 => 14:32:17.189592
[0m14:32:17.190591 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m14:32:17.194550 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:32:17.198603 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m14:32:17.199586 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:32:17.200589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:18.102782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:18.106769 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 14:32:17.190591 => 14:32:18.105770
[0m14:32:18.106769 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m14:32:18.248226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B73F380>]}
[0m14:32:18.249227 [info ] [Thread-1 (]: 8 of 10 OK created sql table model transform.churned_customer_last_year ........ [[32mSUCCESS 1[0m in 1.07s]
[0m14:32:18.249560 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m14:32:18.250602 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m14:32:18.250602 [info ] [Thread-1 (]: 9 of 10 START sql table model transform.customer_revenue_ranking ............... [RUN]
[0m14:32:18.252569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m14:32:18.252569 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m14:32:18.256602 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:32:18.257645 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 14:32:18.253602 => 14:32:18.257645
[0m14:32:18.258609 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m14:32:18.261644 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:32:18.263610 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m14:32:18.263610 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m14:32:18.264643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:19.948262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:32:19.954273 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 14:32:18.258609 => 14:32:19.954273
[0m14:32:19.955253 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m14:32:20.093792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B3A4440>]}
[0m14:32:20.094792 [info ] [Thread-1 (]: 9 of 10 OK created sql table model transform.customer_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.84s]
[0m14:32:20.095790 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m14:32:20.096792 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m14:32:20.096792 [info ] [Thread-1 (]: 10 of 10 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m14:32:20.097792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m14:32:20.098792 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m14:32:20.102794 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:32:20.104794 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 14:32:20.098792 => 14:32:20.103791
[0m14:32:20.104794 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m14:32:20.108796 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:32:20.110792 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m14:32:20.110792 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m14:32:20.111819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:21.398310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:21.402330 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 14:32:20.105792 => 14:32:21.401330
[0m14:32:21.402330 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m14:32:21.544088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e6854a-1c5e-4209-92ff-45ffb7d1665b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B7B0EA240>]}
[0m14:32:21.545090 [info ] [Thread-1 (]: 10 of 10 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.45s]
[0m14:32:21.546086 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m14:32:21.549088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:21.549088 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:32:21.550088 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:32:21.550088 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m14:32:21.551086 [info ] [MainThread]: 
[0m14:32:21.551086 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 19.18 seconds (19.18s).
[0m14:32:21.555087 [debug] [MainThread]: Command end result
[0m14:32:21.572111 [info ] [MainThread]: 
[0m14:32:21.575116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:21.576129 [info ] [MainThread]: 
[0m14:32:21.577113 [error] [MainThread]:   Database Error in model churn_and_new_customers (models\transform\churn_and_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_and_new_customers.sql
[0m14:32:21.578111 [info ] [MainThread]: 
[0m14:32:21.579107 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m14:32:21.580107 [debug] [MainThread]: Command `dbt run` failed at 14:32:21.580107 after 21.62 seconds
[0m14:32:21.581108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B781D24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B79000290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B78EF22A0>]}
[0m14:32:21.581652 [debug] [MainThread]: Flushing usage events
[0m14:33:35.226127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF8E9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF8E9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF8E9520>]}


============================== 14:33:35.232153 | c70358aa-6309-4d26-9882-2cf8698bb4de ==============================
[0m14:33:35.232153 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:33:35.233128 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:33:35.750579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF9164B0>]}
[0m14:33:35.856222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D13EF320>]}
[0m14:33:35.858349 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:33:35.866998 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:33:35.979617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:35.980581 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_and_new_customers.sql
[0m14:33:36.135967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:33:36.142240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1826FF0>]}
[0m14:33:36.153562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D16A8170>]}
[0m14:33:36.154562 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:33:36.155562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1807BC0>]}
[0m14:33:36.158563 [info ] [MainThread]: 
[0m14:33:36.159561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:36.161563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:33:36.177596 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:33:36.177596 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:33:36.178596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:37.205758 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:33:37.209761 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:33:37.367466 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:33:37.369466 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:33:37.371507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:38.004633 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:33:38.006642 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:33:38.157452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:33:38.168440 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:33:38.168440 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:33:38.169440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:38.754963 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m14:33:38.761958 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:33:38.919986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:33:38.930000 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:33:38.930000 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:33:38.930000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:39.502379 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:33:39.509351 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:33:39.659057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1933440>]}
[0m14:33:39.660099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:39.662059 [info ] [MainThread]: 
[0m14:33:39.667850 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m14:33:39.668851 [info ] [Thread-1 (]: 1 of 10 START sql table model staging.staging_country_region_table ............. [RUN]
[0m14:33:39.670852 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m14:33:39.671852 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m14:33:39.685880 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m14:33:39.687864 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 14:33:39.671852 => 14:33:39.686880
[0m14:33:39.687864 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m14:33:39.722880 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m14:33:39.724880 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m14:33:39.724880 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m14:33:39.725921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:40.527803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:40.551425 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 14:33:39.687864 => 14:33:40.550424
[0m14:33:40.551425 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m14:33:40.702603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D18E9EB0>]}
[0m14:33:40.705600 [info ] [Thread-1 (]: 1 of 10 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.03s]
[0m14:33:40.709542 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m14:33:40.711543 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m14:33:40.712531 [info ] [Thread-1 (]: 2 of 10 START sql table model staging.staging_customers_table .................. [RUN]
[0m14:33:40.713560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m14:33:40.714533 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m14:33:40.718530 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m14:33:40.720539 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 14:33:40.714533 => 14:33:40.720539
[0m14:33:40.721533 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m14:33:40.726531 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m14:33:40.728532 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m14:33:40.729576 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:33:40.729576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:41.819828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:41.823839 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 14:33:40.721533 => 14:33:41.823839
[0m14:33:41.824840 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m14:33:41.970566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D17865A0>]}
[0m14:33:41.973508 [info ] [Thread-1 (]: 2 of 10 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.26s]
[0m14:33:41.978509 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m14:33:41.980517 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m14:33:41.981496 [info ] [Thread-1 (]: 3 of 10 START sql table model staging.staging_products_table ................... [RUN]
[0m14:33:41.982544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m14:33:41.983500 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m14:33:41.987529 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m14:33:41.989500 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 14:33:41.983500 => 14:33:41.988533
[0m14:33:41.990497 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m14:33:41.993497 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m14:33:41.995531 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m14:33:41.996529 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:33:41.996529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:42.948674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:42.951642 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 14:33:41.990497 => 14:33:42.951642
[0m14:33:42.953181 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m14:33:43.086522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1706600>]}
[0m14:33:43.087557 [info ] [Thread-1 (]: 3 of 10 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.11s]
[0m14:33:43.088561 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m14:33:43.089556 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m14:33:43.090557 [info ] [Thread-1 (]: 4 of 10 START sql table model staging.staging_transactions_table ............... [RUN]
[0m14:33:43.091523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m14:33:43.091523 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m14:33:43.096558 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m14:33:43.098524 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 14:33:43.092557 => 14:33:43.097559
[0m14:33:43.098524 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m14:33:43.102525 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m14:33:43.104556 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m14:33:43.105557 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:33:43.105557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:44.237226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:44.240191 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 14:33:43.099556 => 14:33:44.240191
[0m14:33:44.241190 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m14:33:44.382742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1705520>]}
[0m14:33:44.384744 [info ] [Thread-1 (]: 4 of 10 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.29s]
[0m14:33:44.388847 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m14:33:44.391819 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_and_new_customers
[0m14:33:44.393849 [info ] [Thread-1 (]: 5 of 10 START sql table model transform.churn_and_new_customers ................ [RUN]
[0m14:33:44.397784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_and_new_customers)
[0m14:33:44.399828 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_and_new_customers
[0m14:33:44.404827 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_and_new_customers"
[0m14:33:44.406777 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_and_new_customers (compile): 14:33:44.400775 => 14:33:44.405776
[0m14:33:44.407779 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_and_new_customers
[0m14:33:44.410809 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_and_new_customers"
[0m14:33:44.412814 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_and_new_customers"
[0m14:33:44.413776 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_and_new_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_and_new_customers"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_and_new_customers
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:33:44.414775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:45.291516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:45.295507 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_and_new_customers (execute): 14:33:44.407779 => 14:33:45.294507
[0m14:33:45.295507 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_and_new_customers: Close
[0m14:33:45.444755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D18E9130>]}
[0m14:33:45.447756 [info ] [Thread-1 (]: 5 of 10 OK created sql table model transform.churn_and_new_customers ........... [[32mSUCCESS 1[0m in 1.05s]
[0m14:33:45.451756 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_and_new_customers
[0m14:33:45.453761 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m14:33:45.457030 [info ] [Thread-1 (]: 6 of 10 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m14:33:45.460282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_and_new_customers, now model.mini_project_dbt.churned_customer_last_month)
[0m14:33:45.461327 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m14:33:45.469329 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:33:45.471364 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 14:33:45.462329 => 14:33:45.471364
[0m14:33:45.472333 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m14:33:45.477363 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:33:45.479906 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m14:33:45.479906 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:33:45.480950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:46.616589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:46.619552 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 14:33:45.473366 => 14:33:46.619552
[0m14:33:46.620550 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m14:33:46.764772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1ADC770>]}
[0m14:33:46.766774 [info ] [Thread-1 (]: 6 of 10 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.31s]
[0m14:33:46.771773 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m14:33:46.773854 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m14:33:46.776484 [info ] [Thread-1 (]: 7 of 10 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m14:33:46.779934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m14:33:46.781933 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m14:33:46.791115 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:33:46.793114 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 14:33:46.783933 => 14:33:46.793114
[0m14:33:46.794113 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m14:33:46.797112 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:33:46.799116 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m14:33:46.800148 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:33:46.800148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:47.792384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:47.795384 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 14:33:46.794113 => 14:33:47.795384
[0m14:33:47.795384 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m14:33:47.937792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1ADD2E0>]}
[0m14:33:47.940793 [info ] [Thread-1 (]: 7 of 10 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 1.16s]
[0m14:33:47.944795 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m14:33:47.946792 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m14:33:47.949794 [info ] [Thread-1 (]: 8 of 10 START sql table model transform.churned_customer_last_year ............. [RUN]
[0m14:33:47.953760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m14:33:47.954734 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m14:33:47.963770 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:33:47.966729 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 14:33:47.955726 => 14:33:47.965767
[0m14:33:47.966729 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m14:33:47.971767 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:33:47.974726 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m14:33:47.975735 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:33:47.976738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:48.882931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:48.886874 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 14:33:47.967766 => 14:33:48.885876
[0m14:33:48.886874 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m14:33:49.029066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1ADC2F0>]}
[0m14:33:49.030088 [info ] [Thread-1 (]: 8 of 10 OK created sql table model transform.churned_customer_last_year ........ [[32mSUCCESS 1[0m in 1.08s]
[0m14:33:49.032092 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m14:33:49.032092 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m14:33:49.033083 [info ] [Thread-1 (]: 9 of 10 START sql table model transform.customer_revenue_ranking ............... [RUN]
[0m14:33:49.034054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m14:33:49.035082 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m14:33:49.038079 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:33:49.039082 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 14:33:49.035082 => 14:33:49.039082
[0m14:33:49.040055 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m14:33:49.043088 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:33:49.044088 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m14:33:49.045102 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m14:33:49.045102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:49.905458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:49.911451 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 14:33:49.040055 => 14:33:49.910451
[0m14:33:49.912454 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m14:33:50.056706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CC531F10>]}
[0m14:33:50.057708 [info ] [Thread-1 (]: 9 of 10 OK created sql table model transform.customer_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.02s]
[0m14:33:50.058898 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m14:33:50.059947 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m14:33:50.060946 [info ] [Thread-1 (]: 10 of 10 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m14:33:50.061906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m14:33:50.062944 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m14:33:50.067945 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:33:50.068948 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 14:33:50.062944 => 14:33:50.068948
[0m14:33:50.069911 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m14:33:50.073910 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:33:50.075912 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m14:33:50.076909 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m14:33:50.076909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:50.978812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:33:50.982775 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 14:33:50.069911 => 14:33:50.981776
[0m14:33:50.982775 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m14:33:51.124902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c70358aa-6309-4d26-9882-2cf8698bb4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D1785DF0>]}
[0m14:33:51.125905 [info ] [Thread-1 (]: 10 of 10 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.06s]
[0m14:33:51.128642 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m14:33:51.132644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:51.133642 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:33:51.133642 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:33:51.134642 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m14:33:51.135644 [info ] [MainThread]: 
[0m14:33:51.137607 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 14.98 seconds (14.98s).
[0m14:33:51.142622 [debug] [MainThread]: Command end result
[0m14:33:51.154633 [info ] [MainThread]: 
[0m14:33:51.155602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:51.156740 [info ] [MainThread]: 
[0m14:33:51.157749 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:33:51.158785 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:51.158785 after 16.02 seconds
[0m14:33:51.158785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF1B22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF7D85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CF4FCEC0>]}
[0m14:33:51.159782 [debug] [MainThread]: Flushing usage events
[0m14:36:22.297381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4BCAAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4BC9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE4BC8E90>]}


============================== 14:36:22.303125 | d1349b49-569b-42a7-983f-bfd140917951 ==============================
[0m14:36:22.303125 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:36:22.304087 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:36:22.884148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1349b49-569b-42a7-983f-bfd140917951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE6705C10>]}
[0m14:36:23.010699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1349b49-569b-42a7-983f-bfd140917951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE54BD5B0>]}
[0m14:36:23.012704 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:36:23.023733 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:36:23.153184 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m14:36:23.153184 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_l3m.sql
[0m14:36:23.154181 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_ltm.sql
[0m14:36:23.154181 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_lm.sql
[0m14:36:23.155180 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churn_and_new_customers.sql
[0m14:36:23.319325 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mini_project_dbt.churn_new_customers_l3m' (models\transform\churn_new_customers_l3m.sql) depends on a node named 'staging_transactions' which was not found
[0m14:36:23.321325 [debug] [MainThread]: Command `dbt run` failed at 14:36:23.321325 after 1.11 seconds
[0m14:36:23.321325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE469B350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE68EEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FE46F8470>]}
[0m14:36:23.322326 [debug] [MainThread]: Flushing usage events
[0m14:36:46.973956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1C0AA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1C0AA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1C0AA000>]}


============================== 14:36:46.979956 | e9dc6444-877f-4d1f-a428-1bf48505678c ==============================
[0m14:36:46.979956 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:36:46.979956 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:36:47.496232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DD2BD40>]}
[0m14:36:47.609260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1BF18DD0>]}
[0m14:36:47.611259 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:36:47.620703 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:36:47.724264 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m14:36:47.725305 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_l3m.sql
[0m14:36:47.726305 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_ltm.sql
[0m14:36:47.726305 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customers_lm.sql
[0m14:36:47.726305 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churn_and_new_customers.sql
[0m14:36:47.888477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:36:47.894743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E01D820>]}
[0m14:36:47.908743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DEF0650>]}
[0m14:36:47.908743 [info ] [MainThread]: Found 12 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:36:47.909746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E05FFE0>]}
[0m14:36:47.911743 [info ] [MainThread]: 
[0m14:36:47.913747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:47.915743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:36:47.930788 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:36:47.931786 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:36:47.931786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:49.441778 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m14:36:49.443778 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:36:49.600354 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:36:49.602350 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:36:49.603371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:50.188574 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:36:50.190562 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:36:50.348277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m14:36:50.359248 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:36:50.359248 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:36:50.360247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:50.947260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:36:50.954246 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:36:51.115312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m14:36:51.128311 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:36:51.130309 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:36:51.132310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:51.688025 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:36:51.698699 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:36:51.851894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E167B60>]}
[0m14:36:51.852927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:51.852927 [info ] [MainThread]: 
[0m14:36:51.858002 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m14:36:51.858002 [info ] [Thread-1 (]: 1 of 12 START sql table model staging.staging_country_region_table ............. [RUN]
[0m14:36:51.860035 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m14:36:51.860035 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m14:36:51.872036 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m14:36:51.874003 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 14:36:51.860035 => 14:36:51.873036
[0m14:36:51.874003 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m14:36:51.908527 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m14:36:51.910527 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m14:36:51.911529 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m14:36:51.911529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:52.951518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:52.975520 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 14:36:51.875004 => 14:36:52.975520
[0m14:36:52.975520 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m14:36:53.124881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E2ECEC0>]}
[0m14:36:53.125849 [info ] [Thread-1 (]: 1 of 12 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.27s]
[0m14:36:53.126855 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m14:36:53.127845 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m14:36:53.128871 [info ] [Thread-1 (]: 2 of 12 START sql table model staging.staging_customers_table .................. [RUN]
[0m14:36:53.129848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m14:36:53.129848 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m14:36:53.134870 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m14:36:53.135872 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 14:36:53.130842 => 14:36:53.135872
[0m14:36:53.136842 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m14:36:53.141841 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m14:36:53.144849 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m14:36:53.145878 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:36:53.145878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:53.988175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:53.992177 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 14:36:53.136842 => 14:36:53.991177
[0m14:36:53.992177 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m14:36:54.129088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DE289B0>]}
[0m14:36:54.130065 [info ] [Thread-1 (]: 2 of 12 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.00s]
[0m14:36:54.131068 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m14:36:54.132068 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m14:36:54.132068 [info ] [Thread-1 (]: 3 of 12 START sql table model staging.staging_products_table ................... [RUN]
[0m14:36:54.133066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m14:36:54.134066 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m14:36:54.138066 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m14:36:54.140068 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 14:36:54.134066 => 14:36:54.139066
[0m14:36:54.140068 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m14:36:54.144065 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m14:36:54.146071 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m14:36:54.146071 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:36:54.147069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.161457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:55.172403 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 14:36:54.141067 => 14:36:55.171458
[0m14:36:55.174421 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m14:36:55.326443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DF38260>]}
[0m14:36:55.329444 [info ] [Thread-1 (]: 3 of 12 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.19s]
[0m14:36:55.333444 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m14:36:55.335448 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m14:36:55.337445 [info ] [Thread-1 (]: 4 of 12 START sql table model staging.staging_transactions_table ............... [RUN]
[0m14:36:55.340365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m14:36:55.342401 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m14:36:55.351389 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m14:36:55.353352 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 14:36:55.343401 => 14:36:55.352390
[0m14:36:55.354389 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m14:36:55.358387 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m14:36:55.360382 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m14:36:55.361386 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:36:55.362349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:56.246296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:56.250272 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 14:36:55.354389 => 14:36:56.250272
[0m14:36:56.250272 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m14:36:56.394284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DF38260>]}
[0m14:36:56.395284 [info ] [Thread-1 (]: 4 of 12 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.05s]
[0m14:36:56.398004 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m14:36:56.401009 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m14:36:56.402010 [info ] [Thread-1 (]: 5 of 12 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m14:36:56.403959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customers_l3m)
[0m14:36:56.406004 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m14:36:56.413537 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:36:56.416554 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 14:36:56.406004 => 14:36:56.415580
[0m14:36:56.417577 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m14:36:56.422575 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:36:56.425568 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:36:56.426583 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:36:56.426583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:57.266562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:57.268608 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 14:36:56.417577 => 14:36:57.268608
[0m14:36:57.269604 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m14:36:57.424530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E301280>]}
[0m14:36:57.427533 [info ] [Thread-1 (]: 5 of 12 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 1.02s]
[0m14:36:57.431073 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m14:36:57.434118 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m14:36:57.436124 [info ] [Thread-1 (]: 6 of 12 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m14:36:57.439963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m14:36:57.440969 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m14:36:57.447962 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m14:36:57.451010 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 14:36:57.442014 => 14:36:57.450014
[0m14:36:57.452001 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m14:36:57.455997 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m14:36:57.458995 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m14:36:57.459994 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:36:57.459994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:58.375343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:58.379314 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 14:36:57.452001 => 14:36:58.379314
[0m14:36:58.380313 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m14:36:58.532198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E2B0050>]}
[0m14:36:58.535193 [info ] [Thread-1 (]: 6 of 12 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 1.09s]
[0m14:36:58.539200 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m14:36:58.541199 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m14:36:58.543141 [info ] [Thread-1 (]: 7 of 12 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m14:36:58.546138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m14:36:58.547146 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m14:36:58.553137 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:36:58.555133 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 14:36:58.548135 => 14:36:58.555133
[0m14:36:58.556135 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m14:36:58.561168 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:36:58.564165 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:36:58.565167 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:36:58.565167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:59.592616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:59.603615 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 14:36:58.557172 => 14:36:59.601614
[0m14:36:59.605623 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m14:36:59.760420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E1784A0>]}
[0m14:36:59.763420 [info ] [Thread-1 (]: 7 of 12 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 1.21s]
[0m14:36:59.767371 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m14:36:59.769369 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m14:36:59.770370 [info ] [Thread-1 (]: 8 of 12 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m14:36:59.771415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m14:36:59.772421 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m14:36:59.778423 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:36:59.779466 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 14:36:59.772421 => 14:36:59.779466
[0m14:36:59.780456 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m14:36:59.783456 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:36:59.786457 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m14:36:59.786457 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:36:59.787457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:00.710138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:37:00.721212 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 14:36:59.780456 => 14:37:00.720214
[0m14:37:00.723212 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m14:37:00.874753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E2D5370>]}
[0m14:37:00.875755 [info ] [Thread-1 (]: 8 of 12 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.10s]
[0m14:37:00.877712 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m14:37:00.878754 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m14:37:00.880753 [info ] [Thread-1 (]: 9 of 12 START sql table model transform.churned_customer_last_three ............ [RUN]
[0m14:37:00.882754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m14:37:00.883755 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m14:37:00.891711 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:37:00.894716 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 14:37:00.884755 => 14:37:00.893712
[0m14:37:00.894716 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m14:37:00.899744 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:37:00.902745 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m14:37:00.902745 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:37:00.903745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:01.828405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:37:01.832955 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 14:37:00.895708 => 14:37:01.832955
[0m14:37:01.834005 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m14:37:01.977899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E0DDC10>]}
[0m14:37:01.980905 [info ] [Thread-1 (]: 9 of 12 OK created sql table model transform.churned_customer_last_three ....... [[32mSUCCESS 1[0m in 1.10s]
[0m14:37:01.984948 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m14:37:01.986989 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m14:37:01.987942 [info ] [Thread-1 (]: 10 of 12 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m14:37:01.988971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m14:37:01.989966 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m14:37:01.993965 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:37:01.995931 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 14:37:01.989966 => 14:37:01.994967
[0m14:37:01.995931 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m14:37:01.998956 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:37:02.001968 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m14:37:02.001968 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:37:02.002931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:02.892152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:37:02.896193 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 14:37:01.995931 => 14:37:02.896193
[0m14:37:02.897188 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m14:37:03.051971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1E0DE990>]}
[0m14:37:03.052935 [info ] [Thread-1 (]: 10 of 12 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 1.06s]
[0m14:37:03.053930 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m14:37:03.054964 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m14:37:03.054964 [info ] [Thread-1 (]: 11 of 12 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m14:37:03.056963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m14:37:03.056963 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m14:37:03.060964 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:37:03.061964 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 14:37:03.056963 => 14:37:03.061964
[0m14:37:03.062964 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m14:37:03.066964 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:37:03.068932 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m14:37:03.069936 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m14:37:03.069936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:04.155724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:37:04.166717 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 14:37:03.062964 => 14:37:04.165720
[0m14:37:04.168775 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m14:37:04.328522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DF3B8C0>]}
[0m14:37:04.331546 [info ] [Thread-1 (]: 11 of 12 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.27s]
[0m14:37:04.335599 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m14:37:04.336539 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m14:37:04.338540 [info ] [Thread-1 (]: 12 of 12 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m14:37:04.341542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m14:37:04.342583 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m14:37:04.349202 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:37:04.352156 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 14:37:04.342583 => 14:37:04.351205
[0m14:37:04.353165 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m14:37:04.359197 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:37:04.361158 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m14:37:04.362175 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m14:37:04.362175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:05.311473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:37:05.326234 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 14:37:04.354160 => 14:37:05.325231
[0m14:37:05.326234 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m14:37:05.475005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9dc6444-877f-4d1f-a428-1bf48505678c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1DF396D0>]}
[0m14:37:05.475005 [info ] [Thread-1 (]: 12 of 12 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.13s]
[0m14:37:05.477002 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m14:37:05.478672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:05.478672 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:37:05.479672 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m14:37:05.479672 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m14:37:05.480671 [info ] [MainThread]: 
[0m14:37:05.480671 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 17.57 seconds (17.57s).
[0m14:37:05.483673 [debug] [MainThread]: Command end result
[0m14:37:05.496649 [info ] [MainThread]: 
[0m14:37:05.497666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:05.498676 [info ] [MainThread]: 
[0m14:37:05.499708 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m14:37:05.500708 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:05.500708 after 18.62 seconds
[0m14:37:05.500708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1BEED8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1BCBBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1AEA82F0>]}
[0m14:37:05.501707 [debug] [MainThread]: Flushing usage events
[0m14:39:36.133816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278E5A9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278E5A95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278E5A8380>]}


============================== 14:39:36.139567 | cd47a81f-b525-4df3-a015-b54e9efda2ec ==============================
[0m14:39:36.139567 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:39:36.140568 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:39:36.743656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022790133E30>]}
[0m14:39:36.844278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278EE9D640>]}
[0m14:39:36.845247 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:39:36.865292 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:39:38.158097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:39:38.159097 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m14:39:38.318322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:39:38.325354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227905492E0>]}
[0m14:39:38.361319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022790367DA0>]}
[0m14:39:38.361319 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:39:38.369329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022790367DD0>]}
[0m14:39:38.371330 [info ] [MainThread]: 
[0m14:39:38.377331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:38.398848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:39:38.419848 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:39:38.420846 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:39:38.420846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:39.857505 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:39:39.859442 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:39:40.002372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:39:40.012372 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:39:40.012372 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:39:40.012372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:40.569303 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m14:39:40.576302 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:39:40.733015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:39:40.743043 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:39:40.743043 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:39:40.743043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:41.318961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:39:41.321950 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:39:41.467169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227905EFFB0>]}
[0m14:39:41.468212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:41.469179 [info ] [MainThread]: 
[0m14:39:41.473350 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:39:41.473350 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:39:41.475355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:39:41.475355 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:39:41.485384 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:39:41.486384 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:39:41.476389 => 14:39:41.486384
[0m14:39:41.487384 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:39:41.522423 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:39:41.526423 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:39:41.527396 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month;
[0m14:39:41.527396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:42.245958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc5-0001-0878-0000-50e90002c82a
[0m14:39:42.246958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 57 at position 14 unexpected ';'.
[0m14:39:42.246958 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:39:41.487384 => 14:39:42.246958
[0m14:39:42.247958 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:39:42.425446 [debug] [Thread-1 (]: Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 57 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m14:39:42.426446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd47a81f-b525-4df3-a015-b54e9efda2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022790784A40>]}
[0m14:39:42.426446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churn_new_customer ............. [[31mERROR[0m in 0.95s]
[0m14:39:42.428446 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:39:42.430410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:42.431447 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:39:42.431447 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:39:42.432444 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:39:42.432444 [info ] [MainThread]: 
[0m14:39:42.433415 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m14:39:42.434423 [debug] [MainThread]: Command end result
[0m14:39:42.447942 [info ] [MainThread]: 
[0m14:39:42.447942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:39:42.448974 [info ] [MainThread]: 
[0m14:39:42.449937 [error] [MainThread]:   Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 57 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m14:39:42.450940 [info ] [MainThread]: 
[0m14:39:42.450940 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:39:42.452938 [debug] [MainThread]: Command `dbt run` failed at 14:39:42.452938 after 6.43 seconds
[0m14:39:42.452938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278D90D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278E49EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278E5F8080>]}
[0m14:39:42.453971 [debug] [MainThread]: Flushing usage events
[0m14:39:53.688932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC55989FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC55988DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC559882C0>]}


============================== 14:39:53.693933 | 0f3de214-3191-4fb6-9b86-157a38cd8083 ==============================
[0m14:39:53.693933 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:39:53.695932 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:39:54.201637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56219A00>]}
[0m14:39:54.302256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC55988B90>]}
[0m14:39:54.304134 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:39:54.313141 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:39:54.426417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:54.427416 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m14:39:54.583628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:39:54.589995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC579EBEC0>]}
[0m14:39:54.603996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57734830>]}
[0m14:39:54.604997 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:39:54.605963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC575D8D40>]}
[0m14:39:54.607999 [info ] [MainThread]: 
[0m14:39:54.609963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:54.610992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:39:54.625996 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:39:54.626997 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:39:54.626997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:55.849429 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:39:55.855427 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:39:56.006969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m14:39:56.015978 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:39:56.016978 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:39:56.016978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:56.550455 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:39:56.556455 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:39:56.714943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m14:39:56.727940 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:39:56.728951 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:39:56.731952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:57.436263 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m14:39:57.440219 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:39:57.597699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC57576870>]}
[0m14:39:57.598733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:57.598733 [info ] [MainThread]: 
[0m14:39:57.603156 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:39:57.604154 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:39:57.605154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:39:57.606154 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:39:57.615740 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:39:57.617752 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:39:57.606154 => 14:39:57.616739
[0m14:39:57.617752 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:39:57.651739 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:39:57.655739 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:39:57.655739 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m14:39:57.656740 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:58.755692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:39:58.799642 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:39:57.618739 => 14:39:58.799642
[0m14:39:58.800642 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:39:58.943897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3de214-3191-4fb6-9b86-157a38cd8083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5792B020>]}
[0m14:39:58.944897 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.34s]
[0m14:39:58.947286 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:39:58.951327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:58.952326 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:39:58.952326 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m14:39:58.953328 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:39:58.954330 [info ] [MainThread]: 
[0m14:39:58.956282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m14:39:58.958322 [debug] [MainThread]: Command end result
[0m14:39:59.023800 [info ] [MainThread]: 
[0m14:39:59.024794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:59.025801 [info ] [MainThread]: 
[0m14:39:59.026796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:59.027804 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:59.027804 after 5.43 seconds
[0m14:39:59.028828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5582B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC562A7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC556AF560>]}
[0m14:39:59.028828 [debug] [MainThread]: Flushing usage events
[0m14:41:41.033892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CD0F9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CD0F9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CD0F8B00>]}


============================== 14:41:41.039894 | 2eb2685f-9d49-40b4-a4e5-c105770cebd1 ==============================
[0m14:41:41.039894 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:41:41.040895 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:41:41.549467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CCFF07D0>]}
[0m14:41:41.650097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CEC46B40>]}
[0m14:41:41.652062 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:41:41.661135 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:41:41.779374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:41.780373 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m14:41:41.934178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:41:41.940220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CF0A9280>]}
[0m14:41:41.954190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CEEB0B00>]}
[0m14:41:41.955222 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:41:41.955809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CECF7890>]}
[0m14:41:41.957854 [info ] [MainThread]: 
[0m14:41:41.958894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:41.960029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:41:41.976549 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:41:41.976549 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:41:41.976549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:42.974420 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:41:42.976404 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:41:43.119321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m14:41:43.130321 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:41:43.130321 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:41:43.131321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:43.690365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:41:43.696363 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:41:43.862503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m14:41:43.876510 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:41:43.877509 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:41:43.879491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:44.303983 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m14:41:44.305986 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:41:44.454116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CD0F80E0>]}
[0m14:41:44.455157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:44.456122 [info ] [MainThread]: 
[0m14:41:44.460463 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:41:44.460463 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:41:44.462498 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:41:44.462498 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:41:44.473498 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:41:44.474497 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:41:44.463498 => 14:41:44.474497
[0m14:41:44.474497 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:41:44.510057 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:41:44.514054 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:41:44.515057 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Churned if no purchase in the last 12 months
    GROUP BY month
),
monthly_summary AS (
    SELECT
        DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month' AS month,
        COALESCE(n.new_customers, 0) AS new_customers,
        COALESCE(c1.churned_customers, 0) AS churned_customers_1_month,
        COALESCE(c3.churned_customers, 0) AS churned_customers_3_months,
        COALESCE(c12.churned_customers, 0) AS churned_customers_12_months
    FROM monthly_customers n
    LEFT JOIN churned_customers c1 ON DATE_TRUNC('month', n.month) = DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month'
    LEFT JOIN churned_customers_3_months c3 ON DATE_TRUNC('month', n.month) = DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month'
    LEFT JOIN churned_customers_12_months c12 ON DATE_TRUNC('month', n.month) = DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month'
)
SELECT
    month,
    SUM(new_customers) AS new_customers,
    SUM(churned_customers_1_month) AS churned_customers_1_month,
    SUM(churned_customers_3_months) AS churned_customers_3_months,
    SUM(churned_customers_12_months) AS churned_customers_12_months
FROM monthly_summary
GROUP BY month
ORDER BY month
        );
[0m14:41:44.515057 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:45.496346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:41:45.538982 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:41:44.475463 => 14:41:45.538982
[0m14:41:45.539978 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:41:45.902916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb2685f-9d49-40b4-a4e5-c105770cebd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CF34F6E0>]}
[0m14:41:45.903911 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.44s]
[0m14:41:45.904783 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:41:45.907347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:45.907347 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:41:45.908397 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m14:41:45.908397 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:41:45.908397 [info ] [MainThread]: 
[0m14:41:45.909392 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m14:41:45.911355 [debug] [MainThread]: Command end result
[0m14:41:45.973392 [info ] [MainThread]: 
[0m14:41:45.974355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:45.975354 [info ] [MainThread]: 
[0m14:41:45.975354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:45.977393 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:45.977393 after 5.03 seconds
[0m14:41:45.977393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CCD2CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CCE02DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156CDB1EF30>]}
[0m14:41:45.978389 [debug] [MainThread]: Flushing usage events
[0m14:43:06.386525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C7D9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C7D9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C7D95B0>]}


============================== 14:43:06.391520 | a8ace7b5-92f4-432a-80e6-351421aefc07 ==============================
[0m14:43:06.391520 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:43:06.392488 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:43:06.901944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C2FE2A0>]}
[0m14:43:07.002569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4CB93740>]}
[0m14:43:07.004535 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:43:07.013567 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:43:07.125108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:07.126108 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m14:43:07.279673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:43:07.285861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4E7626C0>]}
[0m14:43:07.298879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4E580D70>]}
[0m14:43:07.299862 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:43:07.300829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C238770>]}
[0m14:43:07.303828 [info ] [MainThread]: 
[0m14:43:07.304293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:07.306335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:43:07.321343 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:43:07.322344 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:43:07.323342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:08.420859 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:43:08.422891 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:43:08.582379 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m14:43:08.592424 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:43:08.592424 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:43:08.592424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:09.143396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:43:09.145392 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:43:09.293346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m14:43:09.302346 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:43:09.306385 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:43:09.307385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:09.743129 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m14:43:09.745172 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:43:09.892409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4E489AF0>]}
[0m14:43:09.893410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:09.894375 [info ] [MainThread]: 
[0m14:43:09.898161 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:43:09.899187 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:43:09.900162 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:43:09.901160 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:43:09.911163 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:43:09.912162 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:43:09.901160 => 14:43:09.912162
[0m14:43:09.913162 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:43:09.946239 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:43:09.950237 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:43:09.950237 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m14:43:09.951203 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:11.116418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:43:11.140383 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:43:09.913162 => 14:43:11.139383
[0m14:43:11.140383 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:43:11.291907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ace7b5-92f4-432a-80e6-351421aefc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4EA1E360>]}
[0m14:43:11.294914 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.39s]
[0m14:43:11.299858 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:43:11.309462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:11.310462 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:43:11.310462 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m14:43:11.311432 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:43:11.311432 [info ] [MainThread]: 
[0m14:43:11.312398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m14:43:11.313449 [debug] [MainThread]: Command end result
[0m14:43:11.396190 [info ] [MainThread]: 
[0m14:43:11.396190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:11.397191 [info ] [MainThread]: 
[0m14:43:11.398220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:11.399229 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:11.399229 after 5.10 seconds
[0m14:43:11.400228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4C6B10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4BF5AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4E316B40>]}
[0m14:43:11.400228 [debug] [MainThread]: Flushing usage events
[0m14:44:50.440455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF358A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF358A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF358A0F0>]}


============================== 14:44:50.445442 | ad26b5e5-7397-4fb7-b6fe-e2500b5cef27 ==============================
[0m14:44:50.445442 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:44:50.446442 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:44:50.984524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF514D640>]}
[0m14:44:51.086186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF3994350>]}
[0m14:44:51.087186 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:44:51.096187 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:44:51.199740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:51.200738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:51.201736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:44:51.208465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF514CA70>]}
[0m14:44:51.221441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF537BCE0>]}
[0m14:44:51.222440 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:44:51.223434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF50BF920>]}
[0m14:44:51.225466 [info ] [MainThread]: 
[0m14:44:51.226431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:44:51.228466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:44:51.244466 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:44:51.244466 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:44:51.245467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:52.722041 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:44:52.724042 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:44:52.871140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:44:52.885179 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:44:52.885179 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:44:52.886179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:53.423407 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m14:44:53.426408 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:44:53.568941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:44:53.575940 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:44:53.576942 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:44:53.576942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:54.114134 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:44:54.117098 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:44:54.264232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF5596C60>]}
[0m14:44:54.265231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:54.266234 [info ] [MainThread]: 
[0m14:44:54.295240 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:44:54.296240 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:44:54.297757 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:44:54.297757 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:44:54.309760 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:44:54.311758 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:44:54.298756 => 14:44:54.310759
[0m14:44:54.312769 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:44:54.354777 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:44:54.360758 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:44:54.360758 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m14:44:54.361757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:55.316795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:44:55.344792 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:44:54.312769 => 14:44:55.344792
[0m14:44:55.345792 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:44:55.480310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad26b5e5-7397-4fb7-b6fe-e2500b5cef27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF565B110>]}
[0m14:44:55.481313 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.18s]
[0m14:44:55.482318 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:44:55.485319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:55.485319 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:44:55.486318 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:44:55.486318 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:44:55.486318 [info ] [MainThread]: 
[0m14:44:55.487319 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m14:44:55.489322 [debug] [MainThread]: Command end result
[0m14:44:55.500838 [info ] [MainThread]: 
[0m14:44:55.501832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:55.502834 [info ] [MainThread]: 
[0m14:44:55.503847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:55.504832 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:55.504832 after 5.15 seconds
[0m14:44:55.505856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF3F39D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF54DBE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF520B800>]}
[0m14:44:55.506833 [debug] [MainThread]: Flushing usage events
[0m14:54:07.243929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B52A9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B52AAC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B52A8B90>]}


============================== 14:54:07.254290 | 5945dc97-c089-4065-8acf-270e8a14e7d0 ==============================
[0m14:54:07.254290 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:54:07.255255 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m14:54:08.018332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B52A9F40>]}
[0m14:54:08.119989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B5614350>]}
[0m14:54:08.120984 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:54:08.141002 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:54:09.489389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:09.490422 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m14:54:09.654914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:54:09.661914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B6F91C40>]}
[0m14:54:09.689628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B70C4890>]}
[0m14:54:09.689628 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:54:09.690615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B72148F0>]}
[0m14:54:09.692915 [info ] [MainThread]: 
[0m14:54:09.693878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:09.695516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:54:09.711559 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:54:09.711559 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:54:09.712558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:11.167695 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:54:11.169661 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:54:11.318270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:54:11.329780 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:54:11.330767 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:54:11.330767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:11.755225 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m14:54:11.759239 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:54:11.912462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:54:11.922426 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:54:11.922426 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:54:11.923424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:12.486695 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:54:12.493695 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:54:12.645360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B72F8DA0>]}
[0m14:54:12.645360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:12.646359 [info ] [MainThread]: 
[0m14:54:12.667559 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:54:12.668557 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m14:54:12.669558 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m14:54:12.670559 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:54:12.679525 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:54:12.681526 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:54:12.670559 => 14:54:12.680524
[0m14:54:12.682525 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:54:12.717523 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:54:12.722558 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:54:12.722558 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m14:54:12.723557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:54:13.835947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:54:13.859987 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:54:12.682525 => 14:54:13.858987
[0m14:54:13.859987 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:54:14.005581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5945dc97-c089-4065-8acf-270e8a14e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B70205F0>]}
[0m14:54:14.006580 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.34s]
[0m14:54:14.007590 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:54:14.009578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:14.010579 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:54:14.010579 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:54:14.011578 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m14:54:14.011578 [info ] [MainThread]: 
[0m14:54:14.012590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m14:54:14.013585 [debug] [MainThread]: Command end result
[0m14:54:14.077820 [info ] [MainThread]: 
[0m14:54:14.078829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:14.079828 [info ] [MainThread]: 
[0m14:54:14.081035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:54:14.083016 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:14.082006 after 6.95 seconds
[0m14:54:14.083016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4E9A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B6E96780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4DFCCE0>]}
[0m14:54:14.084048 [debug] [MainThread]: Flushing usage events
[0m14:57:10.245452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435CD791C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435CD78800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435CD79DC0>]}


============================== 14:57:10.251724 | 99ec5a60-a086-4b79-be9c-5a76c7e00e4e ==============================
[0m14:57:10.251724 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:57:10.252099 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:57:10.762648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435E974B00>]}
[0m14:57:10.863276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435CD4A2D0>]}
[0m14:57:10.864274 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:57:10.873273 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:57:10.988875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:10.989876 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m14:57:11.157317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m14:57:11.163371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EAAEE70>]}
[0m14:57:11.177889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435ED297F0>]}
[0m14:57:11.177889 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:57:11.178888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EA0B4D0>]}
[0m14:57:11.181920 [info ] [MainThread]: 
[0m14:57:11.182922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:11.184563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m14:57:11.200572 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:57:11.200572 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:57:11.201572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:12.336506 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:57:12.339544 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:57:12.497121 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m14:57:12.498124 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m14:57:12.498124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:13.047157 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:57:13.049115 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m14:57:13.202453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m14:57:13.216985 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m14:57:13.217985 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m14:57:13.217985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:13.767260 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m14:57:13.775261 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m14:57:13.926979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m14:57:13.937967 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m14:57:13.937967 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m14:57:13.937967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:14.323546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:57:14.329193 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m14:57:14.485852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435ECC5CA0>]}
[0m14:57:14.486818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:14.487780 [info ] [MainThread]: 
[0m14:57:14.492260 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m14:57:14.492260 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m14:57:14.493257 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m14:57:14.494287 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m14:57:14.505298 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m14:57:14.506301 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 14:57:14.494287 => 14:57:14.506301
[0m14:57:14.507260 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m14:57:14.541782 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m14:57:14.543781 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m14:57:14.544782 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m14:57:14.544782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:15.482528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:15.507490 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 14:57:14.507260 => 14:57:15.507490
[0m14:57:15.508489 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m14:57:15.650293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EFC9EB0>]}
[0m14:57:15.653293 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.16s]
[0m14:57:15.657295 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m14:57:15.660292 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m14:57:15.661282 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m14:57:15.664266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m14:57:15.665316 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m14:57:15.672300 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m14:57:15.674260 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 14:57:15.666302 => 14:57:15.674260
[0m14:57:15.675274 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m14:57:15.729332 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m14:57:15.731920 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m14:57:15.731920 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:57:15.732921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:16.716911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:16.719989 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 14:57:15.675274 => 14:57:16.719989
[0m14:57:16.720989 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m14:57:16.866282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EFC9760>]}
[0m14:57:16.869281 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.20s]
[0m14:57:16.873259 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m14:57:16.875260 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m14:57:16.878204 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m14:57:16.882222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m14:57:16.882222 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m14:57:16.887190 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m14:57:16.889188 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 14:57:16.883222 => 14:57:16.888226
[0m14:57:16.890190 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m14:57:16.893191 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m14:57:16.895223 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m14:57:16.895223 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m14:57:16.896224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:17.866313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:17.869276 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 14:57:16.890190 => 14:57:17.869276
[0m14:57:17.870276 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m14:57:18.009825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435E9A6810>]}
[0m14:57:18.009825 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.13s]
[0m14:57:18.010826 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m14:57:18.011858 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m14:57:18.011858 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m14:57:18.013162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m14:57:18.014203 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m14:57:18.018204 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m14:57:18.019216 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 14:57:18.014203 => 14:57:18.019216
[0m14:57:18.020203 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m14:57:18.023177 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m14:57:18.025177 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m14:57:18.026178 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        PAYMENT_MONTH                   AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source where REVENUE_TYPE=1
        );
[0m14:57:18.027181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:18.910761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:18.915724 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 14:57:18.020203 => 14:57:18.914724
[0m14:57:18.915724 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m14:57:19.069031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435F01C410>]}
[0m14:57:19.072030 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.05s]
[0m14:57:19.076032 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m14:57:19.080180 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m14:57:19.082263 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churn_new_customer ..................... [RUN]
[0m14:57:19.085199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m14:57:19.086252 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m14:57:19.094239 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m14:57:19.096196 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 14:57:19.087248 => 14:57:19.095237
[0m14:57:19.097202 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m14:57:19.101202 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m14:57:19.105191 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m14:57:19.106194 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m14:57:19.107194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:20.194120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:20.201118 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 14:57:19.097202 => 14:57:20.200117
[0m14:57:20.202117 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m14:57:20.341553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435F008560>]}
[0m14:57:20.341553 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churn_new_customer ................ [[32mSUCCESS 1[0m in 1.26s]
[0m14:57:20.342551 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m14:57:20.343551 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m14:57:20.343551 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m14:57:20.344846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.churn_new_customers_l3m)
[0m14:57:20.345887 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m14:57:20.348887 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:57:20.350449 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 14:57:20.345887 => 14:57:20.349428
[0m14:57:20.350449 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m14:57:20.355437 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:57:20.358443 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m14:57:20.359470 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:57:20.359470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:21.242170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:21.252228 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 14:57:20.350449 => 14:57:21.250721
[0m14:57:21.252228 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m14:57:21.402529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EFAAA50>]}
[0m14:57:21.402529 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 1.06s]
[0m14:57:21.403563 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m14:57:21.404604 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m14:57:21.404604 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m14:57:21.405872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m14:57:21.406916 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m14:57:21.409913 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m14:57:21.410913 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 14:57:21.406916 => 14:57:21.410913
[0m14:57:21.411880 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m14:57:21.414913 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m14:57:21.416917 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m14:57:21.417923 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:57:21.417923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:22.271490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:22.274537 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 14:57:21.411880 => 14:57:22.274537
[0m14:57:22.275532 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m14:57:22.424991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EFDB0B0>]}
[0m14:57:22.425992 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 1.02s]
[0m14:57:22.427994 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m14:57:22.428950 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m14:57:22.429991 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m14:57:22.431701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m14:57:22.431701 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m14:57:22.437701 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:57:22.439685 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 14:57:22.432706 => 14:57:22.438702
[0m14:57:22.440738 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m14:57:22.445731 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:57:22.448733 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m14:57:22.449732 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m14:57:22.449732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:23.478491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:23.482455 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 14:57:22.440738 => 14:57:23.481453
[0m14:57:23.482455 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m14:57:23.623436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EFD8B30>]}
[0m14:57:23.626442 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 1.19s]
[0m14:57:23.630434 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m14:57:23.632444 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m14:57:23.635432 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m14:57:23.638380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m14:57:23.639419 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m14:57:23.646386 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:57:23.648387 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 14:57:23.640380 => 14:57:23.647436
[0m14:57:23.648387 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m14:57:23.651418 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m14:57:23.654385 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m14:57:23.655419 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:57:23.655419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:24.748946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:24.752988 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 14:57:23.649420 => 14:57:24.752988
[0m14:57:24.753989 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m14:57:24.907524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435CB8E9F0>]}
[0m14:57:24.910530 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.27s]
[0m14:57:24.914479 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m14:57:24.916475 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m14:57:24.918458 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.churned_customer_last_three ........... [RUN]
[0m14:57:24.922333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m14:57:24.923334 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m14:57:24.929279 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:57:24.932278 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 14:57:24.924329 => 14:57:24.931285
[0m14:57:24.932278 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m14:57:24.935311 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m14:57:24.938281 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m14:57:24.939278 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:57:24.939278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:25.907222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:25.910216 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 14:57:24.933312 => 14:57:25.910216
[0m14:57:25.910216 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m14:57:26.056526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435F088590>]}
[0m14:57:26.059524 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.churned_customer_last_three ...... [[32mSUCCESS 1[0m in 1.14s]
[0m14:57:26.063529 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m14:57:26.065478 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m14:57:26.068101 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m14:57:26.071169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m14:57:26.073172 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m14:57:26.081119 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:57:26.083159 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 14:57:26.074170 => 14:57:26.083159
[0m14:57:26.084122 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m14:57:26.090115 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m14:57:26.093149 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m14:57:26.094150 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m14:57:26.094150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:27.364351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:27.367383 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 14:57:26.085154 => 14:57:27.367383
[0m14:57:27.368383 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m14:57:27.505088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435F0914C0>]}
[0m14:57:27.505088 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 1.43s]
[0m14:57:27.507088 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m14:57:27.507088 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m14:57:27.508071 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m14:57:27.508666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m14:57:27.509710 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m14:57:27.512711 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:57:27.514675 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 14:57:27.509710 => 14:57:27.513708
[0m14:57:27.514675 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m14:57:27.517707 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m14:57:27.519707 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m14:57:27.519707 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m14:57:27.520708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:28.310480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:28.314445 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 14:57:27.514675 => 14:57:28.313444
[0m14:57:28.314445 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m14:57:28.470873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435F0900E0>]}
[0m14:57:28.473885 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 0.96s]
[0m14:57:28.476821 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m14:57:28.479428 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m14:57:28.480485 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m14:57:28.481417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m14:57:28.482451 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m14:57:28.485417 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:57:28.487416 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 14:57:28.482451 => 14:57:28.486450
[0m14:57:28.487416 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m14:57:28.491417 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m14:57:28.493419 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m14:57:28.494430 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m14:57:28.495419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:29.306787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:57:29.310718 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 14:57:28.488450 => 14:57:29.310718
[0m14:57:29.311717 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m14:57:29.462745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ec5a60-a086-4b79-be9c-5a76c7e00e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EC9BE90>]}
[0m14:57:29.465728 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 0.98s]
[0m14:57:29.469812 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m14:57:29.473738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:29.474775 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m14:57:29.474775 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m14:57:29.475739 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m14:57:29.475739 [info ] [MainThread]: 
[0m14:57:29.476740 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.29 seconds (18.29s).
[0m14:57:29.481283 [debug] [MainThread]: Command end result
[0m14:57:29.501301 [info ] [MainThread]: 
[0m14:57:29.505294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:29.506292 [info ] [MainThread]: 
[0m14:57:29.510294 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:57:29.514295 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:29.513295 after 19.35 seconds
[0m14:57:29.515292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435EE172F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435ED10440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002435D7D3080>]}
[0m14:57:29.516292 [debug] [MainThread]: Flushing usage events
[0m15:00:44.185497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D783AAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D783AA6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D783AA720>]}


============================== 15:00:44.190532 | ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e ==============================
[0m15:00:44.190532 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:00:44.191496 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:00:44.694821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D79EF5550>]}
[0m15:00:44.795443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D787E2FF0>]}
[0m15:00:44.797435 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:00:44.806189 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:00:44.919647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:44.920646 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:00:45.080783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:00:45.086815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A0DB680>]}
[0m15:00:45.098776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A301A00>]}
[0m15:00:45.099777 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:00:45.100776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D78379880>]}
[0m15:00:45.102808 [info ] [MainThread]: 
[0m15:00:45.104776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:45.106777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:00:45.124297 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:00:45.124297 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:00:45.125296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:46.224472 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:00:46.231481 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:00:46.393507 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:00:46.395508 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:00:46.396574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:46.802050 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:00:46.804064 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:00:46.958359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:00:46.969318 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:00:46.969318 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:00:46.970317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:47.524206 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:00:47.532209 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:00:47.689242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:00:47.700180 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:00:47.701180 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:00:47.701180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:48.222299 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:00:48.224267 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:00:48.372778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A2BC380>]}
[0m15:00:48.374803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:48.375767 [info ] [MainThread]: 
[0m15:00:48.379767 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:00:48.380801 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:00:48.381768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:00:48.382801 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:00:48.393803 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:00:48.394804 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:00:48.382801 => 15:00:48.394804
[0m15:00:48.395769 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:00:48.429807 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:00:48.431769 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:00:48.432801 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:00:48.432801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:49.285755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:00:49.310717 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:00:48.395769 => 15:00:49.310717
[0m15:00:49.311717 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:00:49.447031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A5B91F0>]}
[0m15:00:49.447031 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.07s]
[0m15:00:49.448999 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:00:49.448999 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:00:49.450030 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:00:49.450998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:00:49.450998 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:00:49.455030 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:00:49.456033 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:00:49.452030 => 15:00:49.456033
[0m15:00:49.456998 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:00:49.510587 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:00:49.512589 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:00:49.513590 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:00:49.513590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:50.865624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:00:50.870588 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:00:49.456998 => 15:00:50.869581
[0m15:00:50.870588 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:00:51.012956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A3252B0>]}
[0m15:00:51.012956 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.56s]
[0m15:00:51.014926 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:00:51.014926 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:00:51.015925 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:00:51.016416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:00:51.017457 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:00:51.021458 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:00:51.022428 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:00:51.017457 => 15:00:51.021458
[0m15:00:51.022428 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:00:51.026457 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:00:51.027422 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:00:51.028457 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:00:51.028457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:51.951099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:00:51.955061 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:00:51.023456 => 15:00:51.955061
[0m15:00:51.956063 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:00:52.094102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A5DF9B0>]}
[0m15:00:52.097185 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.08s]
[0m15:00:52.102214 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:00:52.106194 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:00:52.107149 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:00:52.109115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:00:52.110148 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:00:52.115169 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:00:52.117115 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:00:52.111152 => 15:00:52.117115
[0m15:00:52.118117 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:00:52.122114 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:00:52.125114 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:00:52.125114 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month,'DD-MM-YYYY') AS DATE) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source where REVENUE_TYPE=1
        );
[0m15:00:52.126115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:52.753048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffda-0001-086e-0000-50e900030152
[0m15:00:52.754050 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 13
too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:00:52.755048 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:00:52.118117 => 15:00:52.754050
[0m15:00:52.755048 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:00:52.947462 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:00:52.948465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef712f2b-60ec-4cac-b02a-c7dfbc3ca01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A3A4050>]}
[0m15:00:52.949474 [error] [Thread-1 (]: 4 of 13 ERROR creating sql table model staging.staging_transactions_table ...... [[31mERROR[0m in 0.84s]
[0m15:00:52.950432 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:00:52.952433 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:00:52.953429 [info ] [Thread-1 (]: 5 of 13 SKIP relation transform.churn_new_customer ............................. [[33mSKIP[0m]
[0m15:00:52.953744 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:00:52.954793 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:00:52.954793 [info ] [Thread-1 (]: 6 of 13 SKIP relation transform.churn_new_customers_l3m ........................ [[33mSKIP[0m]
[0m15:00:52.955689 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:00:52.956731 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:00:52.956731 [info ] [Thread-1 (]: 7 of 13 SKIP relation transform.churn_new_customers_lm ......................... [[33mSKIP[0m]
[0m15:00:52.957731 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:00:52.958731 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:00:52.958731 [info ] [Thread-1 (]: 8 of 13 SKIP relation transform.churn_new_customers_ltm ........................ [[33mSKIP[0m]
[0m15:00:52.959832 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:00:52.960879 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:00:52.960879 [info ] [Thread-1 (]: 9 of 13 SKIP relation transform.churned_customer_last_month .................... [[33mSKIP[0m]
[0m15:00:52.962858 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:00:52.963852 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:00:52.964876 [info ] [Thread-1 (]: 10 of 13 SKIP relation transform.churned_customer_last_three ................... [[33mSKIP[0m]
[0m15:00:52.965881 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:00:52.966842 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:00:52.967900 [info ] [Thread-1 (]: 11 of 13 SKIP relation transform.churned_customer_last_year .................... [[33mSKIP[0m]
[0m15:00:52.968846 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:00:52.968846 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:00:52.969875 [info ] [Thread-1 (]: 12 of 13 SKIP relation transform.customer_revenue_ranking ...................... [[33mSKIP[0m]
[0m15:00:52.970841 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:00:52.970841 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:00:52.971873 [info ] [Thread-1 (]: 13 of 13 SKIP relation transform.product_revenue_ranking ....................... [[33mSKIP[0m]
[0m15:00:52.972843 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:00:52.974873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:52.974873 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:00:52.975875 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:00:52.975875 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:00:52.976867 [info ] [MainThread]: 
[0m15:00:52.977841 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m15:00:52.979841 [debug] [MainThread]: Command end result
[0m15:00:52.990848 [info ] [MainThread]: 
[0m15:00:52.992305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:00:52.993316 [info ] [MainThread]: 
[0m15:00:52.994314 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:00:52.995324 [info ] [MainThread]: 
[0m15:00:52.996315 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=9 TOTAL=13
[0m15:00:52.997593 [debug] [MainThread]: Command `dbt run` failed at 15:00:52.997593 after 8.90 seconds
[0m15:00:52.998556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7821D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D78379880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D7A2E03B0>]}
[0m15:00:52.998556 [debug] [MainThread]: Flushing usage events
[0m15:00:58.277936 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:02:44.208229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026295AEA540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026295AE9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026295AEA5A0>]}


============================== 15:02:44.213264 | a8e7bf14-7ea3-495a-8835-d6bead32370a ==============================
[0m15:02:44.213264 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:02:44.214267 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:02:44.731166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262975CEFF0>]}
[0m15:02:44.831783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629762B620>]}
[0m15:02:44.833963 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:02:44.843586 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:02:44.957826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:44.958827 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:02:45.117866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:02:45.124102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297B868A0>]}
[0m15:02:45.136107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629777EED0>]}
[0m15:02:45.136107 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:02:45.137102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297A679B0>]}
[0m15:02:45.140104 [info ] [MainThread]: 
[0m15:02:45.141067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:45.144097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:02:45.160101 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:02:45.160101 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:02:45.161068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:46.062166 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:02:46.068165 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:02:46.229002 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:02:46.231004 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:02:46.233006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:46.639883 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:02:46.641880 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:02:46.801252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:02:46.811239 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:02:46.812240 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:02:46.812240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:47.375083 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:02:47.383162 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:02:47.538146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:02:47.541144 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:02:47.541144 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:02:47.542145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:48.097841 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:02:48.099841 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:02:48.241992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026295B1A780>]}
[0m15:02:48.242993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:48.243965 [info ] [MainThread]: 
[0m15:02:48.248974 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:02:48.248974 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:02:48.250976 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:02:48.250976 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:02:48.262975 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:02:48.264973 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:02:48.252012 => 15:02:48.264973
[0m15:02:48.265974 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:02:48.302511 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:02:48.304511 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:02:48.304511 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:02:48.305511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:49.134025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:02:49.168057 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:02:48.265974 => 15:02:49.168057
[0m15:02:49.169059 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:02:49.313399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297AF7A40>]}
[0m15:02:49.316400 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.06s]
[0m15:02:49.320401 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:02:49.322403 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:02:49.323405 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:02:49.324353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:02:49.325395 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:02:49.329394 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:02:49.330394 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:02:49.325395 => 15:02:49.330394
[0m15:02:49.331366 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:02:49.387360 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:02:49.388359 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:02:49.389367 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:02:49.390367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:50.221197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:02:50.225179 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:02:49.332362 => 15:02:50.225179
[0m15:02:50.226181 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:02:50.369319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629784D430>]}
[0m15:02:50.372319 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.04s]
[0m15:02:50.376263 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:02:50.379263 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:02:50.380263 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:02:50.381181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:02:50.382224 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:02:50.387205 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:02:50.388190 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:02:50.382224 => 15:02:50.388190
[0m15:02:50.389192 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:02:50.392189 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:02:50.394204 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:02:50.395198 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:02:50.395198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:51.927369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:02:51.930363 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:02:50.389192 => 15:02:51.930363
[0m15:02:51.931364 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:02:52.078191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297CE9A60>]}
[0m15:02:52.081191 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.70s]
[0m15:02:52.082183 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:02:52.083218 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:02:52.083218 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:02:52.084192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:02:52.085217 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:02:52.089216 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:02:52.090217 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:02:52.085217 => 15:02:52.090217
[0m15:02:52.091184 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:02:52.095219 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:02:52.098217 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:02:52.098217 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month,'DD-MM-YYYY') AS DATE) AS payment_month,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source where REVENUE_TYPE=1
        );
[0m15:02:52.099217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:52.704696 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffdc-0001-08a0-0000-50e90002e20a
[0m15:02:52.704696 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'TRANSACTION_DATE'
[0m15:02:52.705686 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:02:52.091184 => 15:02:52.705686
[0m15:02:52.706687 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:02:52.863554 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:02:52.864559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8e7bf14-7ea3-495a-8835-d6bead32370a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297CE9A60>]}
[0m15:02:52.866573 [error] [Thread-1 (]: 4 of 13 ERROR creating sql table model staging.staging_transactions_table ...... [[31mERROR[0m in 0.78s]
[0m15:02:52.868898 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:02:52.871921 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:02:52.872973 [info ] [Thread-1 (]: 5 of 13 SKIP relation transform.churn_new_customer ............................. [[33mSKIP[0m]
[0m15:02:52.875694 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:02:52.876717 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:02:52.877681 [info ] [Thread-1 (]: 6 of 13 SKIP relation transform.churn_new_customers_l3m ........................ [[33mSKIP[0m]
[0m15:02:52.878721 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:02:52.879679 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:02:52.880729 [info ] [Thread-1 (]: 7 of 13 SKIP relation transform.churn_new_customers_lm ......................... [[33mSKIP[0m]
[0m15:02:52.881709 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:02:52.882681 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:02:52.883717 [info ] [Thread-1 (]: 8 of 13 SKIP relation transform.churn_new_customers_ltm ........................ [[33mSKIP[0m]
[0m15:02:52.884680 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:02:52.885678 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:02:52.885678 [info ] [Thread-1 (]: 9 of 13 SKIP relation transform.churned_customer_last_month .................... [[33mSKIP[0m]
[0m15:02:52.887681 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:02:52.887681 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:02:52.888677 [info ] [Thread-1 (]: 10 of 13 SKIP relation transform.churned_customer_last_three ................... [[33mSKIP[0m]
[0m15:02:52.889690 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:02:52.889690 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:02:52.891092 [info ] [Thread-1 (]: 11 of 13 SKIP relation transform.churned_customer_last_year .................... [[33mSKIP[0m]
[0m15:02:52.891674 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:02:52.891674 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:02:52.892715 [info ] [Thread-1 (]: 12 of 13 SKIP relation transform.customer_revenue_ranking ...................... [[33mSKIP[0m]
[0m15:02:52.893695 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:02:52.893695 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:02:52.894714 [info ] [Thread-1 (]: 13 of 13 SKIP relation transform.product_revenue_ranking ....................... [[33mSKIP[0m]
[0m15:02:52.895685 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:02:52.899723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:52.899723 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:02:52.900680 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:02:52.900680 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:02:52.901715 [info ] [MainThread]: 
[0m15:02:52.902714 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m15:02:52.904719 [debug] [MainThread]: Command end result
[0m15:02:52.916727 [info ] [MainThread]: 
[0m15:02:52.917726 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:52.918747 [info ] [MainThread]: 
[0m15:02:52.920255 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:02:52.920255 [info ] [MainThread]: 
[0m15:02:52.921296 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=9 TOTAL=13
[0m15:02:52.923296 [debug] [MainThread]: Command `dbt run` failed at 15:02:52.922294 after 8.80 seconds
[0m15:02:52.923296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262959A8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262978168A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026297C44BC0>]}
[0m15:02:52.924296 [debug] [MainThread]: Flushing usage events
[0m15:03:31.771429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB795A840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB79595E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB795A360>]}


============================== 15:03:31.777166 | 20424c19-7ebb-41d1-95f9-6d28df7039b6 ==============================
[0m15:03:31.777166 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:03:31.778142 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:03:32.282869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9496FF0>]}
[0m15:03:32.382490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB94976B0>]}
[0m15:03:32.384059 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:03:32.392687 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:03:32.497164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:03:32.498166 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:03:32.656894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:03:32.663727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9675D00>]}
[0m15:03:32.677768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB98F9EB0>]}
[0m15:03:32.678768 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:03:32.678768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB79298B0>]}
[0m15:03:32.681776 [info ] [MainThread]: 
[0m15:03:32.682745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:32.684734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:03:32.700773 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:03:32.700773 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:03:32.701769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:33.744909 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:03:33.746906 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:03:33.910429 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:03:33.912427 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:03:33.913428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:34.528572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:03:34.534569 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:03:34.694566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:03:34.705399 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:03:34.705399 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:03:34.706399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:35.252388 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:03:35.259400 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:03:35.413513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:03:35.424537 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:03:35.424537 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:03:35.424537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:35.853399 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:03:35.855357 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:03:36.004326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9A77290>]}
[0m15:03:36.005323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:36.006323 [info ] [MainThread]: 
[0m15:03:36.010324 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:03:36.011357 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:03:36.012371 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:03:36.013415 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:03:36.024414 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:03:36.026378 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:03:36.013415 => 15:03:36.025410
[0m15:03:36.026378 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:03:36.060412 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:03:36.062378 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:03:36.063413 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:03:36.063413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:36.893919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:03:36.920485 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:03:36.026378 => 15:03:36.920485
[0m15:03:36.921489 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:03:37.057686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9BB8BF0>]}
[0m15:03:37.057686 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.04s]
[0m15:03:37.059720 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:03:37.059720 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:03:37.060727 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:03:37.061720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:03:37.061720 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:03:37.065723 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:03:37.067687 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:03:37.062720 => 15:03:37.066687
[0m15:03:37.067687 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:03:37.123347 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:03:37.125366 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:03:37.126350 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:03:37.126350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:38.039892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:03:38.043891 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:03:37.068720 => 15:03:38.042891
[0m15:03:38.043891 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:03:38.188844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9773410>]}
[0m15:03:38.191924 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.13s]
[0m15:03:38.195924 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:03:38.197931 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:03:38.200923 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:03:38.204102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:03:38.204619 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:03:38.212633 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:03:38.215637 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:03:38.205636 => 15:03:38.214632
[0m15:03:38.215637 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:03:38.219663 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:03:38.220630 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:03:38.221664 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:03:38.221664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:39.101834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:03:39.104830 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:03:38.216672 => 15:03:39.103830
[0m15:03:39.104830 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:03:39.256930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9925BB0>]}
[0m15:03:39.259931 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.05s]
[0m15:03:39.263931 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:03:39.265885 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:03:39.267826 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:03:39.271561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:03:39.272549 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:03:39.280551 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:03:39.282506 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:03:39.272549 => 15:03:39.282506
[0m15:03:39.283546 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:03:39.287540 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:03:39.289541 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:03:39.290541 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month,'DD-MM-YYYY') AS DATE) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source where REVENUE_TYPE=1
        );
[0m15:03:39.290541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:39.715747 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffdd-0001-089f-0000-50e90002d49e
[0m15:03:39.716780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 13
too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:03:39.716780 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:03:39.283546 => 15:03:39.716780
[0m15:03:39.717780 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:03:39.875227 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:03:39.877227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20424c19-7ebb-41d1-95f9-6d28df7039b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB99B7E30>]}
[0m15:03:39.879226 [error] [Thread-1 (]: 4 of 13 ERROR creating sql table model staging.staging_transactions_table ...... [[31mERROR[0m in 0.61s]
[0m15:03:39.881247 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:03:39.884457 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:03:39.885469 [info ] [Thread-1 (]: 5 of 13 SKIP relation transform.churn_new_customer ............................. [[33mSKIP[0m]
[0m15:03:39.886223 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:03:39.887237 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:03:39.888275 [info ] [Thread-1 (]: 6 of 13 SKIP relation transform.churn_new_customers_l3m ........................ [[33mSKIP[0m]
[0m15:03:39.890235 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:03:39.890235 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:03:39.891233 [info ] [Thread-1 (]: 7 of 13 SKIP relation transform.churn_new_customers_lm ......................... [[33mSKIP[0m]
[0m15:03:39.892241 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:03:39.893236 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:03:39.894234 [info ] [Thread-1 (]: 8 of 13 SKIP relation transform.churn_new_customers_ltm ........................ [[33mSKIP[0m]
[0m15:03:39.896232 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:03:39.897242 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:03:39.897242 [info ] [Thread-1 (]: 9 of 13 SKIP relation transform.churned_customer_last_month .................... [[33mSKIP[0m]
[0m15:03:39.898240 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:03:39.899276 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:03:39.899276 [info ] [Thread-1 (]: 10 of 13 SKIP relation transform.churned_customer_last_three ................... [[33mSKIP[0m]
[0m15:03:39.900491 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:03:39.901532 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:03:39.901532 [info ] [Thread-1 (]: 11 of 13 SKIP relation transform.churned_customer_last_year .................... [[33mSKIP[0m]
[0m15:03:39.902498 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:03:39.902498 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:03:39.903532 [info ] [Thread-1 (]: 12 of 13 SKIP relation transform.customer_revenue_ranking ...................... [[33mSKIP[0m]
[0m15:03:39.904509 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:03:39.905534 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:03:39.905534 [info ] [Thread-1 (]: 13 of 13 SKIP relation transform.product_revenue_ranking ....................... [[33mSKIP[0m]
[0m15:03:39.906528 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:03:39.909498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:39.909498 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:03:39.910500 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:03:39.910500 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:03:39.910500 [info ] [MainThread]: 
[0m15:03:39.911537 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m15:03:39.914668 [debug] [MainThread]: Command end result
[0m15:03:39.925654 [info ] [MainThread]: 
[0m15:03:39.926643 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:39.927643 [info ] [MainThread]: 
[0m15:03:39.928654 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:03:39.929628 [info ] [MainThread]: 
[0m15:03:39.930627 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=9 TOTAL=13
[0m15:03:39.932632 [debug] [MainThread]: Command `dbt run` failed at 15:03:39.932632 after 8.25 seconds
[0m15:03:39.932632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB72B22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB795A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB9A4AD80>]}
[0m15:03:39.933662 [debug] [MainThread]: Flushing usage events
[0m15:04:33.199488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB8A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB8A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB8B500>]}


============================== 15:04:33.204834 | 5c92f3bd-9337-4e27-96bd-a24b6496c9d2 ==============================
[0m15:04:33.204834 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:04:33.205208 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:04:33.704362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6D72CB00>]}
[0m15:04:33.804984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6D66ECF0>]}
[0m15:04:33.807205 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:04:33.816080 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:04:33.929274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:33.929274 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:04:34.088759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:04:34.095042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DBFED20>]}
[0m15:04:34.107042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DAE1490>]}
[0m15:04:34.108009 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:04:34.109010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6D723F20>]}
[0m15:04:34.112049 [info ] [MainThread]: 
[0m15:04:34.113083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:34.115099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:04:34.131452 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:04:34.132508 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:04:34.132508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:35.634259 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:04:35.640258 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:04:35.799649 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:04:35.801624 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:04:35.802632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:36.340620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:04:36.346620 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:04:36.517571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:04:36.527580 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:04:36.528580 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:04:36.528580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:37.101548 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:04:37.103512 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:04:37.244589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:04:37.248589 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:04:37.249590 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:04:37.250591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:37.875767 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:04:37.878733 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:04:38.020004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DBEAAB0>]}
[0m15:04:38.021006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:38.021835 [info ] [MainThread]: 
[0m15:04:38.026886 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:04:38.027912 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:04:38.028887 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:04:38.029887 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:04:38.040429 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:04:38.042436 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:04:38.029887 => 15:04:38.041478
[0m15:04:38.042436 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:04:38.077473 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:04:38.079439 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:04:38.079439 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:04:38.080470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:38.882341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:38.907322 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:04:38.043471 => 15:04:38.907322
[0m15:04:38.907322 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:04:39.050906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DDCF5C0>]}
[0m15:04:39.050906 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.02s]
[0m15:04:39.052875 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:04:39.052875 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:04:39.053908 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:04:39.054872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:04:39.055907 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:04:39.059906 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:04:39.060873 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:04:39.055907 => 15:04:39.060873
[0m15:04:39.060873 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:04:39.114906 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:04:39.116872 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:04:39.117911 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:04:39.117911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:39.962686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:39.966687 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:04:39.061907 => 15:04:39.966687
[0m15:04:39.967672 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:04:40.114119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DB3AF90>]}
[0m15:04:40.115118 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.06s]
[0m15:04:40.117101 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:04:40.118112 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:04:40.120117 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:04:40.122074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:04:40.123076 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:04:40.131111 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:04:40.133074 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:04:40.124073 => 15:04:40.133074
[0m15:04:40.134073 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:04:40.139144 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:04:40.141138 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:04:40.142177 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:04:40.142177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:40.918102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:40.920094 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:04:40.135131 => 15:04:40.920094
[0m15:04:40.921095 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:04:41.064675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DB67680>]}
[0m15:04:41.066677 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 0.94s]
[0m15:04:41.068677 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:04:41.069677 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:04:41.069677 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:04:41.072283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:04:41.073283 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:04:41.080286 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:04:41.082247 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:04:41.073283 => 15:04:41.082247
[0m15:04:41.083241 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:04:41.087278 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:04:41.090241 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:04:41.091277 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month) AS DATE) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PAYMENT_MONTH IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source where REVENUE_TYPE=1
        );
[0m15:04:41.092279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:41.903434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:41.906435 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:04:41.084278 => 15:04:41.905434
[0m15:04:41.906435 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:04:42.049979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DC3B200>]}
[0m15:04:42.050980 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 0.98s]
[0m15:04:42.054025 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:04:42.055977 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:04:42.057493 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churn_new_customer ..................... [RUN]
[0m15:04:42.059987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:04:42.061022 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:04:42.067008 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:04:42.068976 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:04:42.061978 => 15:04:42.067976
[0m15:04:42.068976 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:04:42.072974 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:04:42.077007 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:04:42.077007 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:04:42.078008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:43.207507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:43.210502 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:04:42.070009 => 15:04:43.209505
[0m15:04:43.210502 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:04:43.356992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DDD6D80>]}
[0m15:04:43.357992 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churn_new_customer ................ [[32mSUCCESS 1[0m in 1.30s]
[0m15:04:43.358991 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:04:43.359959 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:04:43.360406 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m15:04:43.361413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.churn_new_customers_l3m)
[0m15:04:43.361413 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m15:04:43.364927 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:04:43.366928 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 15:04:43.361413 => 15:04:43.365927
[0m15:04:43.366928 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m15:04:43.370926 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:04:43.373924 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:04:43.374927 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:04:43.374927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:44.416390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:44.421353 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 15:04:43.367927 => 15:04:44.420354
[0m15:04:44.421353 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m15:04:44.572643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DD95220>]}
[0m15:04:44.575643 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 1.21s]
[0m15:04:44.579643 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:04:44.581644 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:04:44.583645 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m15:04:44.587611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m15:04:44.588599 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m15:04:44.595566 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:04:44.597558 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 15:04:44.588599 => 15:04:44.596560
[0m15:04:44.598589 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m15:04:44.601586 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:04:44.603591 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m15:04:44.604589 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:04:44.604589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:45.525914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:45.536911 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 15:04:44.598589 => 15:04:45.534911
[0m15:04:45.538913 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m15:04:45.690564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DD95580>]}
[0m15:04:45.693508 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 1.10s]
[0m15:04:45.697563 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:04:45.699567 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:04:45.702557 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m15:04:45.705519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m15:04:45.706519 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m15:04:45.713508 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:04:45.715472 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 15:04:45.707513 => 15:04:45.714511
[0m15:04:45.716507 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m15:04:45.720503 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:04:45.723500 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:04:45.724464 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:04:45.724464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:46.626349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:46.637348 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 15:04:45.716507 => 15:04:46.636348
[0m15:04:46.639350 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m15:04:46.802439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A687F1F10>]}
[0m15:04:46.805440 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 1.10s]
[0m15:04:46.809499 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:04:46.811498 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:04:46.813460 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m15:04:46.814434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m15:04:46.814434 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m15:04:46.819460 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:04:46.821431 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 15:04:46.815462 => 15:04:46.820465
[0m15:04:46.822461 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m15:04:46.825459 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:04:46.828427 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m15:04:46.828427 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:04:46.829427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:47.951425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:47.955385 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 15:04:46.822461 => 15:04:47.955385
[0m15:04:47.955385 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m15:04:48.104659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DDC4E00>]}
[0m15:04:48.105626 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.29s]
[0m15:04:48.106625 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:04:48.107703 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:04:48.108680 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.churned_customer_last_three ........... [RUN]
[0m15:04:48.111662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m15:04:48.111662 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m15:04:48.117662 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:04:48.118675 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 15:04:48.112626 => 15:04:48.118675
[0m15:04:48.119628 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m15:04:48.122660 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:04:48.124659 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m15:04:48.125659 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:04:48.125659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:49.177553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:49.180565 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 15:04:48.119628 => 15:04:49.180565
[0m15:04:49.181854 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m15:04:49.330170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DE28620>]}
[0m15:04:49.333165 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.churned_customer_last_three ...... [[32mSUCCESS 1[0m in 1.22s]
[0m15:04:49.337218 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:04:49.339165 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:04:49.342211 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m15:04:49.346213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m15:04:49.349159 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m15:04:49.362148 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:04:49.364195 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 15:04:49.350166 => 15:04:49.364195
[0m15:04:49.366170 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m15:04:49.373204 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:04:49.376202 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m15:04:49.377199 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:04:49.377199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:50.089954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:50.092919 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 15:04:49.366170 => 15:04:50.092919
[0m15:04:50.093925 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m15:04:50.236302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DE31F10>]}
[0m15:04:50.237273 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 0.89s]
[0m15:04:50.238280 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:04:50.238280 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:04:50.239272 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m15:04:50.240272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:04:50.240272 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:04:50.244273 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:04:50.245272 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:04:50.241273 => 15:04:50.245272
[0m15:04:50.246242 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:04:50.249270 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:04:50.250278 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:04:50.251275 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:04:50.251275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:51.500706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:51.505672 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:04:50.246242 => 15:04:51.504670
[0m15:04:51.505672 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:04:51.917019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DE329C0>]}
[0m15:04:51.917981 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.68s]
[0m15:04:51.918948 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:04:51.919981 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:04:51.920772 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m15:04:51.921392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:04:51.922432 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:04:51.925432 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:04:51.926433 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:04:51.922432 => 15:04:51.926433
[0m15:04:51.927400 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:04:51.930432 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:04:51.932398 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:04:51.932398 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:04:51.933432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:52.868508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:04:52.879508 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:04:51.927400 => 15:04:52.878509
[0m15:04:52.881509 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:04:53.036040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c92f3bd-9337-4e27-96bd-a24b6496c9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6DE31100>]}
[0m15:04:53.037040 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.11s]
[0m15:04:53.038041 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:04:53.040042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:53.041075 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:04:53.041075 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:04:53.042076 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:04:53.042076 [info ] [MainThread]: 
[0m15:04:53.043074 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.93 seconds (18.93s).
[0m15:04:53.046039 [debug] [MainThread]: Command end result
[0m15:04:53.057042 [info ] [MainThread]: 
[0m15:04:53.058043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:53.059041 [info ] [MainThread]: 
[0m15:04:53.060041 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m15:04:53.062039 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:53.061052 after 19.95 seconds
[0m15:04:53.062039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB62B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB613D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A6BB62B10>]}
[0m15:04:53.062039 [debug] [MainThread]: Flushing usage events
[0m15:06:40.180433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EF2A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EF2A7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EF29F40>]}


============================== 15:06:40.185434 | 627bb99c-dc73-41d4-a1b1-fbd250187045 ==============================
[0m15:06:40.185434 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:06:40.186438 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:06:40.696165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EFAAB40>]}
[0m15:06:40.796793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2034E930>]}
[0m15:06:40.798798 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:06:40.807946 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:06:40.920154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:40.921156 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:06:41.080741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:06:41.086959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE20A030E0>]}
[0m15:06:41.100957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE20EF56A0>]}
[0m15:06:41.101955 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:06:41.102958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2008A1E0>]}
[0m15:06:41.103956 [info ] [MainThread]: 
[0m15:06:41.105996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:41.106998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:06:41.121577 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:06:41.121577 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:06:41.122579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:42.184376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:06:42.190378 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:06:42.347110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:06:42.356365 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:06:42.357366 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:06:42.357366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:42.939666 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:06:42.942638 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:06:43.094687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:06:43.112664 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:06:43.113664 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:06:43.114663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:43.700087 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:06:43.703057 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:06:43.845330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE210494C0>]}
[0m15:06:43.846331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:43.847299 [info ] [MainThread]: 
[0m15:06:43.851296 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:06:43.851801 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:06:43.852806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:06:43.853808 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:06:43.864846 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:06:43.865843 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:06:43.853808 => 15:06:43.865843
[0m15:06:43.865843 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:06:43.899809 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:06:43.902864 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:06:43.903841 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month, 'DD-MM-YYYY') AS DATE) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        payment_month IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:06:43.903841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:44.321343 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe0-0001-085a-0000-50e90002f1e6
[0m15:06:44.322343 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 13
too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:06:44.322343 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:06:43.866842 => 15:06:44.322343
[0m15:06:44.323343 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:06:44.479479 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:06:44.481480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '627bb99c-dc73-41d4-a1b1-fbd250187045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE21166FF0>]}
[0m15:06:44.482468 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.63s]
[0m15:06:44.484900 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:06:44.488893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:44.489894 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:06:44.490857 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:06:44.491857 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:06:44.491857 [info ] [MainThread]: 
[0m15:06:44.492891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m15:06:44.494888 [debug] [MainThread]: Command end result
[0m15:06:44.563409 [info ] [MainThread]: 
[0m15:06:44.564367 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:44.565368 [info ] [MainThread]: 
[0m15:06:44.565368 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:06:44.566401 [info ] [MainThread]: 
[0m15:06:44.567366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:06:44.568368 [debug] [MainThread]: Command `dbt run` failed at 15:06:44.568368 after 4.47 seconds
[0m15:06:44.569402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EB9E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1EB9CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE20FB7E60>]}
[0m15:06:44.569402 [debug] [MainThread]: Flushing usage events
[0m15:07:04.021326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9B78D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9DDAB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9E1C93D0>]}


============================== 15:07:04.027367 | 084d2679-ac5b-4060-b5dd-0d05733acef5 ==============================
[0m15:07:04.027367 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:07:04.028367 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:07:04.525122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9FD6E180>]}
[0m15:07:04.625744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9EA288F0>]}
[0m15:07:04.627709 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:07:04.636709 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:07:04.747832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:04.748834 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:07:04.907467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:07:04.913476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA015EB10>]}
[0m15:07:04.927029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA0182E70>]}
[0m15:07:04.927029 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:07:04.927994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9E560C20>]}
[0m15:07:04.930025 [info ] [MainThread]: 
[0m15:07:04.930992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:04.933025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:07:04.947029 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:07:04.948025 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:07:04.948993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:06.055624 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:07:06.078583 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:07:06.232530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:07:06.259586 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:07:06.259586 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:07:06.260584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:06.820319 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:07:06.822330 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:07:06.975970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:07:06.981936 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:07:06.981936 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:07:06.982936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:07.526794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:07:07.528791 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:07:07.673461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA02A37D0>]}
[0m15:07:07.677467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:07.679468 [info ] [MainThread]: 
[0m15:07:07.692079 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:07:07.694079 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:07:07.696053 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:07:07.697051 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:07:07.708050 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:07:07.710017 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:07:07.697051 => 15:07:07.709017
[0m15:07:07.710017 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:07:07.744645 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:07:07.746611 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:07:07.747648 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month, 'DD-MM-YYYY')) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        payment_month IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:07:07.747648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:08.293964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe1-0001-086e-0000-50e900030182
[0m15:07:08.294998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 49 unexpected ')'.
syntax error line 9 at position 70 unexpected ','.
[0m15:07:08.294998 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:07:07.710017 => 15:07:08.294998
[0m15:07:08.295997 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:07:08.453572 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 49 unexpected ')'.
  syntax error line 9 at position 70 unexpected ','.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:07:08.455570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '084d2679-ac5b-4060-b5dd-0d05733acef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA03B82F0>]}
[0m15:07:08.457514 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.76s]
[0m15:07:08.459512 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:07:08.463505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:08.464542 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:07:08.464542 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:07:08.464542 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:07:08.465538 [info ] [MainThread]: 
[0m15:07:08.466506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m15:07:08.467505 [debug] [MainThread]: Command end result
[0m15:07:08.537545 [info ] [MainThread]: 
[0m15:07:08.538561 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:08.539545 [info ] [MainThread]: 
[0m15:07:08.539545 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 49 unexpected ')'.
  syntax error line 9 at position 70 unexpected ','.
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:07:08.540545 [info ] [MainThread]: 
[0m15:07:08.542053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:08.543060 [debug] [MainThread]: Command `dbt run` failed at 15:07:08.543060 after 4.61 seconds
[0m15:07:08.544061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9D8B10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9DD8D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9E0BCCE0>]}
[0m15:07:08.544061 [debug] [MainThread]: Flushing usage events
[0m15:07:26.111738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC429FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC429FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC429F10>]}


============================== 15:07:26.116768 | 4541263c-b790-4af6-b85f-16c558320e1e ==============================
[0m15:07:26.116768 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:07:26.117777 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:07:26.619421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AE009100>]}
[0m15:07:26.720047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC1EAC90>]}
[0m15:07:26.721659 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:07:26.731251 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:07:26.844912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:26.844912 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:07:27.004183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:07:27.010201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AE3CB230>]}
[0m15:07:27.025183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AE36D3D0>]}
[0m15:07:27.026183 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:07:27.027183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC429160>]}
[0m15:07:27.029183 [info ] [MainThread]: 
[0m15:07:27.029695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:27.031736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:07:27.046738 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:07:27.047739 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:07:27.047739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:28.119285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:07:28.121245 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:07:28.270401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:07:28.284357 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:07:28.284357 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:07:28.285357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:28.827064 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:07:28.834064 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:07:28.990845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:07:29.003881 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:07:29.004934 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:07:29.005901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:29.568248 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:07:29.576301 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:07:29.735412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AE3907A0>]}
[0m15:07:29.736426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:29.737392 [info ] [MainThread]: 
[0m15:07:29.741647 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:07:29.741647 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:07:29.743673 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:07:29.743673 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:07:29.754695 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:07:29.756656 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:07:29.744688 => 15:07:29.755689
[0m15:07:29.756656 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:07:29.790655 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:07:29.793688 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:07:29.793688 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month, 'DD-MM-YYYY') AS Date) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        payment_month IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:07:29.794689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:30.376126 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe1-0001-087f-0000-50e90002aa1a
[0m15:07:30.377172 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 13
too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:07:30.379168 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:07:29.757693 => 15:07:30.378173
[0m15:07:30.380168 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:07:30.541587 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:07:30.543581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4541263c-b790-4af6-b85f-16c558320e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AE0D5BB0>]}
[0m15:07:30.544581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.80s]
[0m15:07:30.547580 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:07:30.552577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:30.553577 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:07:30.554578 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:07:30.554578 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:07:30.555577 [info ] [MainThread]: 
[0m15:07:30.556560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m15:07:30.557534 [debug] [MainThread]: Command end result
[0m15:07:30.624124 [info ] [MainThread]: 
[0m15:07:30.625120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:30.626119 [info ] [MainThread]: 
[0m15:07:30.627120 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 13
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:07:30.628120 [info ] [MainThread]: 
[0m15:07:30.629119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:30.630118 [debug] [MainThread]: Command `dbt run` failed at 15:07:30.630118 after 4.61 seconds
[0m15:07:30.631120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC2CBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC1EAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC05CFB0>]}
[0m15:07:30.631120 [debug] [MainThread]: Flushing usage events
[0m15:08:54.891217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2565D9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2565DA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2565D9B80>]}


============================== 15:08:54.897254 | f5d01eb7-5280-49ce-abfb-0ea988ea536d ==============================
[0m15:08:54.897254 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:08:54.898217 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:08:55.492270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24FC51280>]}
[0m15:08:55.592891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E256639D00>]}
[0m15:08:55.594449 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:08:55.615354 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:08:56.899341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:56.899341 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:08:57.056855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:08:57.063226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25837E4B0>]}
[0m15:08:57.109791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25854C230>]}
[0m15:08:57.109791 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:08:57.110795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E258258830>]}
[0m15:08:57.112792 [info ] [MainThread]: 
[0m15:08:57.113756 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:08:57.115120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:08:57.131161 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:08:57.132161 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:08:57.133128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:58.233241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:08:58.235200 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:08:58.387156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:08:58.400928 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:08:58.401928 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:08:58.401928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:58.955799 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:08:58.962800 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:08:59.121220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:08:59.133306 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:08:59.135308 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:08:59.137309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:59.712917 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:08:59.715877 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:08:59.866689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2586A9CA0>]}
[0m15:08:59.867689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:59.868655 [info ] [MainThread]: 
[0m15:08:59.872658 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:08:59.873698 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:08:59.874692 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:08:59.874692 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:08:59.883693 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:08:59.885660 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:08:59.875693 => 15:08:59.884693
[0m15:08:59.885660 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:08:59.921700 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:08:59.924190 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:08:59.925198 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(payment_month, 'DD-MM-YYYY') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        payment_month IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:08:59.925198 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:00.660448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe3-0001-085a-0000-50e90002f1ea
[0m15:09:00.661449 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 8
too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:09:00.662449 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:08:59.885660 => 15:09:00.661449
[0m15:09:00.662449 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:09:00.852500 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 8
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:09:00.853500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d01eb7-5280-49ce-abfb-0ea988ea536d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E258823EC0>]}
[0m15:09:00.854502 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.98s]
[0m15:09:00.855465 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:09:00.858500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:00.859501 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:09:00.859501 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:09:00.860500 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:09:00.860500 [info ] [MainThread]: 
[0m15:09:00.861582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m15:09:00.862589 [debug] [MainThread]: Command end result
[0m15:09:00.932213 [info ] [MainThread]: 
[0m15:09:00.933212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:00.934224 [info ] [MainThread]: 
[0m15:09:00.934224 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 8
  too many arguments for function [TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:09:00.935254 [info ] [MainThread]: 
[0m15:09:00.936212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:00.937223 [debug] [MainThread]: Command `dbt run` failed at 15:09:00.937223 after 6.16 seconds
[0m15:09:00.938246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2560CB320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E256F58D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E256E555B0>]}
[0m15:09:00.938246 [debug] [MainThread]: Flushing usage events
[0m15:11:42.495946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F24E390A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F24E39130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F24E387D0>]}


============================== 15:11:42.501979 | 16ebfb80-ce0a-4383-a639-be1dba89e5de ==============================
[0m15:11:42.501979 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:11:42.502988 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:11:43.018999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F23C0FFE0>]}
[0m15:11:43.122486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F248A90A0>]}
[0m15:11:43.124115 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:11:43.133115 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:11:43.249187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:43.249187 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:11:43.411754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:11:43.417697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26B7A6F0>]}
[0m15:11:43.431974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26DC0110>]}
[0m15:11:43.433016 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:11:43.434016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26B475C0>]}
[0m15:11:43.436014 [info ] [MainThread]: 
[0m15:11:43.436409 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:43.438452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:11:43.455038 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:11:43.455038 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:11:43.455038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:44.511555 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:11:44.517557 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:11:44.676703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:11:44.699694 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:11:44.700694 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:11:44.700694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:45.269803 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:11:45.273765 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:11:45.422714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:11:45.428714 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:11:45.428714 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:11:45.428714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:45.829327 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:11:45.836329 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:11:46.009177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26EBF560>]}
[0m15:11:46.010219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:46.011189 [info ] [MainThread]: 
[0m15:11:46.015914 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:11:46.015914 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:11:46.017921 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:11:46.017921 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:11:46.028880 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:11:46.030880 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:11:46.018895 => 15:11:46.029914
[0m15:11:46.030880 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:11:46.063953 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:11:46.066920 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:11:46.067957 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TRY_TO_DATE(payment_date, 'DD-MM-YYYY') as transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:11:46.067957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:46.651405 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe5-0001-0892-0000-50e900025f2e
[0m15:11:46.653402 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 20
invalid identifier 'PAYMENT_DATE'
[0m15:11:46.654403 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:11:46.030880 => 15:11:46.653402
[0m15:11:46.655402 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:11:46.797436 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000904 (42000): SQL compilation error: error line 9 at position 20
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:11:46.798436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16ebfb80-ce0a-4383-a639-be1dba89e5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26E203B0>]}
[0m15:11:46.798436 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.78s]
[0m15:11:46.799553 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:11:46.802607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:46.802607 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:11:46.803607 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:11:46.803607 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:11:46.804607 [info ] [MainThread]: 
[0m15:11:46.804607 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m15:11:46.806607 [debug] [MainThread]: Command end result
[0m15:11:46.869430 [info ] [MainThread]: 
[0m15:11:46.876439 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:11:46.877168 [info ] [MainThread]: 
[0m15:11:46.878164 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000904 (42000): SQL compilation error: error line 9 at position 20
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:11:46.879163 [info ] [MainThread]: 
[0m15:11:46.880163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:11:46.881668 [debug] [MainThread]: Command `dbt run` failed at 15:11:46.881668 after 4.47 seconds
[0m15:11:46.881668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F257772F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F26AAB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F23E32E70>]}
[0m15:11:46.882677 [debug] [MainThread]: Flushing usage events
[0m15:12:05.750060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA05C4A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA05C49D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA05C4A570>]}


============================== 15:12:05.755060 | 972c326c-b192-4555-8963-aabc2710bd1a ==============================
[0m15:12:05.755060 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:12:05.756060 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:12:06.313783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA05C79580>]}
[0m15:12:06.416412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA078FBA70>]}
[0m15:12:06.418023 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:12:06.426650 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:12:06.537295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:06.538292 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:12:06.699470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:12:06.705674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA078FA210>]}
[0m15:12:06.718640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA07B98D40>]}
[0m15:12:06.718640 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:12:06.719640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA0792A060>]}
[0m15:12:06.721675 [info ] [MainThread]: 
[0m15:12:06.722640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:06.724645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:12:06.741715 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:12:06.742717 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:12:06.742717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:07.881357 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:12:07.885346 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:12:08.029592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:12:08.040594 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:12:08.040594 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:12:08.041594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:08.612819 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:12:08.620820 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:12:08.771579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:12:08.783549 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:12:08.783549 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:12:08.784548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:09.329220 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:12:09.337219 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:12:09.491263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA078F85C0>]}
[0m15:12:09.492264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:09.494265 [info ] [MainThread]: 
[0m15:12:09.499264 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:12:09.500289 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:12:09.501292 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:12:09.502295 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:12:09.514263 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:12:09.515302 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:12:09.502295 => 15:12:09.515302
[0m15:12:09.516263 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:12:09.552261 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:12:09.555337 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:12:09.556337 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TRY_TO_DATE(payment_month, 'DD-MM-YYYY') as transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:12:09.556337 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:12:10.116614 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe6-0001-087f-0000-50e90002aa2a
[0m15:12:10.117615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 9 at position 8
too many arguments for function [TRY_TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
[0m15:12:10.117615 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:12:09.516263 => 15:12:10.117615
[0m15:12:10.118615 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:12:10.274606 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 8
  too many arguments for function [TRY_TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:12:10.276609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '972c326c-b192-4555-8963-aabc2710bd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA07E85520>]}
[0m15:12:10.277592 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.staging_transactions_table ....... [[31mERROR[0m in 0.78s]
[0m15:12:10.280590 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:12:10.284584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:10.285585 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:12:10.285585 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:12:10.286584 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:12:10.287581 [info ] [MainThread]: 
[0m15:12:10.288543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m15:12:10.289549 [debug] [MainThread]: Command end result
[0m15:12:10.356543 [info ] [MainThread]: 
[0m15:12:10.357583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:10.357583 [info ] [MainThread]: 
[0m15:12:10.358584 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  000939 (22023): SQL compilation error: error line 9 at position 8
  too many arguments for function [TRY_TO_DATE(TRANSACTIONS_TABLE.PAYMENT_MONTH, 'DD-MM-YYYY')] expected 1, got 2
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:12:10.359551 [info ] [MainThread]: 
[0m15:12:10.360574 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:10.361584 [debug] [MainThread]: Command `dbt run` failed at 15:12:10.361584 after 4.70 seconds
[0m15:12:10.361584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA05CCACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA07CDF680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA058E5730>]}
[0m15:12:10.362581 [debug] [MainThread]: Flushing usage events
[0m15:14:59.151062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500855A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500855A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500855A1B0>]}


============================== 15:14:59.156095 | 099a5e22-3bec-4f13-a54f-45210cab4824 ==============================
[0m15:14:59.156095 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:14:59.157099 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:14:59.679222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025008E8D370>]}
[0m15:14:59.782829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A0D72C0>]}
[0m15:14:59.783797 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:14:59.793796 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:14:59.905322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:59.905322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:59.906321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:14:59.913250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A2EA210>]}
[0m15:14:59.924826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A340E60>]}
[0m15:14:59.924826 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:14:59.925865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A340CE0>]}
[0m15:14:59.927838 [info ] [MainThread]: 
[0m15:14:59.929839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:59.930837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:14:59.948453 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:14:59.948453 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:14:59.949454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:00.945304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:15:00.947830 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:15:01.108412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:15:01.125403 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:15:01.126404 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:15:01.126404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:01.684260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:15:01.687219 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:15:01.836953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:15:01.849028 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:15:01.850026 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:15:01.852026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:02.386103 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:15:02.393101 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:15:02.553440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A30E660>]}
[0m15:15:02.554474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:02.555477 [info ] [MainThread]: 
[0m15:15:02.559538 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:15:02.560648 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:15:02.575848 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:15:02.576867 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:15:02.587866 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:15:02.588830 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:15:02.576867 => 15:15:02.588830
[0m15:15:02.589864 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:15:02.624872 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:15:02.626861 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:15:02.627865 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TRY_TO_DATE(payment_month, 'DD-MM-YYYY') as transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:15:02.627865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:03.405012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:15:03.428001 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:15:02.589864 => 15:15:03.428001
[0m15:15:03.429002 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:15:03.568157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099a5e22-3bec-4f13-a54f-45210cab4824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500A669850>]}
[0m15:15:03.569156 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 0.99s]
[0m15:15:03.570144 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:15:03.572124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:03.573157 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:15:03.573157 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:15:03.573157 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:15:03.574160 [info ] [MainThread]: 
[0m15:15:03.575157 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m15:15:03.576125 [debug] [MainThread]: Command end result
[0m15:15:03.586654 [info ] [MainThread]: 
[0m15:15:03.587664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:03.588662 [info ] [MainThread]: 
[0m15:15:03.589699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:15:03.591525 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:03.590517 after 4.53 seconds
[0m15:15:03.591525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025008210140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500855A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002500855A240>]}
[0m15:15:03.591525 [debug] [MainThread]: Flushing usage events
[0m15:18:28.282236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D2194A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D2194A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D21949E80>]}


============================== 15:18:28.292655 | 61ae8899-36fa-4bf4-8654-b7c070a09910 ==============================
[0m15:18:28.292655 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:28.294482 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:18:29.071318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D219A1C40>]}
[0m15:18:29.174708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D23422630>]}
[0m15:18:29.175684 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:18:29.190450 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:18:29.318295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:29.318295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:29.319295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:18:29.326295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D23503800>]}
[0m15:18:29.339268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D23794AA0>]}
[0m15:18:29.339268 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:18:29.340304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D234230E0>]}
[0m15:18:29.343304 [info ] [MainThread]: 
[0m15:18:29.344269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:29.346273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:18:29.363786 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:18:29.363786 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:18:29.364788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:30.583436 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:18:30.588436 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:18:30.737091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:18:30.747092 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:18:30.748091 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:18:30.748091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.289684 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:18:31.292652 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:18:31.441057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:18:31.447060 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:18:31.447060 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:18:31.447060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:31.988656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:18:31.994654 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:18:32.152452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D21A5BB90>]}
[0m15:18:32.153467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:32.154433 [info ] [MainThread]: 
[0m15:18:32.177983 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:18:32.179016 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:18:32.179984 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_transactions_table'
[0m15:18:32.181019 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:18:32.192448 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:18:32.194412 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:18:32.181019 => 15:18:32.193445
[0m15:18:32.194412 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:18:32.229447 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:18:32.231413 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:18:32.232413 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TRY_TO_DATE(payment_month, 'DD-MM-YYYY') as transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:18:32.233412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:32.913048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:32.938018 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:18:32.195446 => 15:18:32.938018
[0m15:18:32.938018 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:18:33.077064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ae8899-36fa-4bf4-8654-b7c070a09910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D236CB230>]}
[0m15:18:33.079067 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 0.90s]
[0m15:18:33.081064 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:18:33.085070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:33.085632 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:18:33.086691 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:18:33.086691 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:18:33.087690 [info ] [MainThread]: 
[0m15:18:33.088693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m15:18:33.090674 [debug] [MainThread]: Command end result
[0m15:18:33.102642 [info ] [MainThread]: 
[0m15:18:33.109915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:33.110863 [info ] [MainThread]: 
[0m15:18:33.111621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:33.112629 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:33.112629 after 4.92 seconds
[0m15:18:33.113662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D2365EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D2223E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D238CBFB0>]}
[0m15:18:33.113662 [debug] [MainThread]: Flushing usage events
[0m15:21:51.066416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943581A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943581A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029435819E20>]}


============================== 15:21:51.071415 | 5fc7b637-9981-4d0a-8e7a-995cfee755b6 ==============================
[0m15:21:51.071415 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:21:51.072418 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:21:51.593874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437382C60>]}
[0m15:21:51.694498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437382C60>]}
[0m15:21:51.696357 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:21:51.705072 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:21:51.797311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:51.798314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:51.799312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:21:51.806114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294375BCB00>]}
[0m15:21:51.818664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294375F0950>]}
[0m15:21:51.818664 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:21:51.819665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029436290500>]}
[0m15:21:51.822703 [info ] [MainThread]: 
[0m15:21:51.824705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:51.825701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:21:51.842700 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:21:51.843699 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:21:51.843699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:52.889233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:21:52.891235 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:21:53.043304 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:21:53.044305 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:21:53.045306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:53.415667 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:21:53.417667 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:21:53.565230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:21:53.579191 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:21:53.580215 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:21:53.580215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:54.117494 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:21:54.119537 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:21:54.266504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:21:54.270503 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:21:54.270503 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:21:54.271505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:54.792469 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:21:54.794469 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:21:54.953198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437567B00>]}
[0m15:21:54.957196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:54.959132 [info ] [MainThread]: 
[0m15:21:54.962838 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:21:54.963875 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:21:54.964854 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:21:54.965840 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:21:54.977874 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:21:54.979838 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:21:54.965840 => 15:21:54.979838
[0m15:21:54.979838 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:21:55.013873 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:21:55.015847 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:21:55.016873 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:21:55.016873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:56.599986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:21:56.623955 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:21:54.980873 => 15:21:56.623955
[0m15:21:56.624951 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:21:56.762738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943584A060>]}
[0m15:21:56.763740 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.80s]
[0m15:21:56.764741 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:21:56.765739 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:21:56.766738 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:21:56.767739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:21:56.768739 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:21:56.772739 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:21:56.774740 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:21:56.768739 => 15:21:56.773739
[0m15:21:56.774740 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:21:56.778744 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:21:56.781739 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:21:56.782738 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:21:56.782738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:57.799152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:21:57.802149 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:21:56.775741 => 15:21:57.802149
[0m15:21:57.802149 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:21:57.953651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437994770>]}
[0m15:21:57.954666 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.19s]
[0m15:21:57.955000 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:21:57.956042 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:21:57.956042 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:21:57.975796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:21:57.976792 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:21:57.980792 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:21:57.982755 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:21:57.976792 => 15:21:57.981793
[0m15:21:57.982755 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:21:57.987793 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:21:57.989790 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:21:57.990792 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:21:57.990792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:58.995654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:21:58.998651 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:21:57.983792 => 15:21:58.997646
[0m15:21:58.998651 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:21:59.136501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437994170>]}
[0m15:21:59.137497 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.16s]
[0m15:21:59.138314 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:21:59.139356 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:21:59.139356 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:21:59.140637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:21:59.141678 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:21:59.145684 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:21:59.146680 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:21:59.141678 => 15:21:59.146680
[0m15:21:59.147646 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:21:59.150678 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:21:59.152678 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:21:59.152678 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TRY_TO_DATE(payment_month, 'DD-MM-YYYY') as transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:21:59.153677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:59.859631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:21:59.862602 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:21:59.147646 => 15:21:59.862602
[0m15:21:59.863602 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:22:00.014184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437994920>]}
[0m15:22:00.015184 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 0.87s]
[0m15:22:00.016206 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:22:00.017218 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:22:00.018185 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churn_new_customer ..................... [RUN]
[0m15:22:00.019199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:22:00.020185 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:22:00.023184 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:22:00.025183 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:22:00.020185 => 15:22:00.025183
[0m15:22:00.026185 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:22:00.029184 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:22:00.033181 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:22:00.034186 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:22:00.034186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:00.978326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:00.980322 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:22:00.026185 => 15:22:00.980322
[0m15:22:00.981322 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:22:01.135944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294379169C0>]}
[0m15:22:01.138943 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churn_new_customer ................ [[32mSUCCESS 1[0m in 1.12s]
[0m15:22:01.142942 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:22:01.144943 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:22:01.146912 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m15:22:01.147892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.churn_new_customers_l3m)
[0m15:22:01.147892 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m15:22:01.151901 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:22:01.153901 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 15:22:01.148900 => 15:22:01.152904
[0m15:22:01.153901 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m15:22:01.157899 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:22:01.160956 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:22:01.160956 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:22:01.161940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:01.909679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:01.913647 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 15:22:01.154939 => 15:22:01.912645
[0m15:22:01.913647 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m15:22:02.060628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943791EAE0>]}
[0m15:22:02.061628 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 0.91s]
[0m15:22:02.062628 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:22:02.063631 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:22:02.063631 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m15:22:02.064630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m15:22:02.066135 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m15:22:02.069144 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:22:02.070144 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 15:22:02.066135 => 15:22:02.070144
[0m15:22:02.071143 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m15:22:02.074145 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:22:02.077142 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m15:22:02.078155 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:22:02.079143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:02.817750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:02.821778 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 15:22:02.071143 => 15:22:02.820778
[0m15:22:02.821778 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m15:22:02.963886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294379D4D40>]}
[0m15:22:02.964885 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 0.90s]
[0m15:22:02.966849 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:22:02.967849 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:22:02.967849 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m15:22:02.969849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m15:22:02.970849 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m15:22:02.974372 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:22:02.976371 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 15:22:02.970849 => 15:22:02.975369
[0m15:22:02.976371 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m15:22:03.029405 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:22:03.032402 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:22:03.032402 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:22:03.033406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:03.750417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:03.753385 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 15:22:02.977372 => 15:22:03.753385
[0m15:22:03.754384 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m15:22:03.897873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294379DE210>]}
[0m15:22:03.899868 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 0.93s]
[0m15:22:03.903867 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:22:03.906867 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:22:03.909285 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m15:22:03.912668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m15:22:03.913632 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m15:22:03.922614 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:22:03.924619 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 15:22:03.914667 => 15:22:03.923617
[0m15:22:03.925616 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m15:22:03.929613 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:22:03.932648 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m15:22:03.933648 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:22:03.933648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:04.846402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:04.850371 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 15:22:03.925616 => 15:22:04.849376
[0m15:22:04.850371 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m15:22:04.997232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294376AA600>]}
[0m15:22:05.000289 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.09s]
[0m15:22:05.004304 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:22:05.005326 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:22:05.006226 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.churned_customer_last_three ........... [RUN]
[0m15:22:05.007269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m15:22:05.007269 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m15:22:05.012258 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:22:05.013257 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 15:22:05.008258 => 15:22:05.013257
[0m15:22:05.014264 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m15:22:05.017258 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:22:05.019226 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m15:22:05.020259 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:22:05.020259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:05.778939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:05.789604 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 15:22:05.014264 => 15:22:05.788602
[0m15:22:05.791605 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m15:22:05.978683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294376A82C0>]}
[0m15:22:05.979683 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.churned_customer_last_three ...... [[32mSUCCESS 1[0m in 0.97s]
[0m15:22:05.981190 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:22:05.982198 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:22:05.982198 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m15:22:05.983199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m15:22:05.984232 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m15:22:05.988233 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:22:05.989242 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 15:22:05.984232 => 15:22:05.989242
[0m15:22:05.990198 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m15:22:05.993231 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:22:05.995230 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m15:22:05.996227 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:22:05.997197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:06.795776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:06.798775 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 15:22:05.990198 => 15:22:06.797774
[0m15:22:06.798775 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m15:22:06.941209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294376A84D0>]}
[0m15:22:06.942208 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 0.96s]
[0m15:22:06.943208 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:22:06.944207 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:22:06.945208 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m15:22:06.946210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:22:06.947206 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:22:06.951208 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:22:06.953210 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:22:06.947206 => 15:22:06.952210
[0m15:22:06.953210 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:22:06.959205 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:22:06.961172 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:22:06.962206 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:22:06.962206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:08.075666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:08.086667 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:22:06.954210 => 15:22:08.085666
[0m15:22:08.089245 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:22:08.241867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294379A8200>]}
[0m15:22:08.243867 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.30s]
[0m15:22:08.247866 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:22:08.250867 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:22:08.252866 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m15:22:08.255825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:22:08.256811 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:22:08.262804 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:22:08.264819 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:22:08.257821 => 15:22:08.263828
[0m15:22:08.264819 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:22:08.268840 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:22:08.270816 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:22:08.271836 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:22:08.271836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.111922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:09.114915 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:22:08.265851 => 15:22:09.113915
[0m15:22:09.114915 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:22:09.264880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc7b637-9981-4d0a-8e7a-995cfee755b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294379A9370>]}
[0m15:22:09.266876 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.01s]
[0m15:22:09.271826 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:22:09.278869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.279866 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:22:09.279866 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:22:09.280910 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:22:09.280910 [info ] [MainThread]: 
[0m15:22:09.281887 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 17.46 seconds (17.46s).
[0m15:22:09.285874 [debug] [MainThread]: Command end result
[0m15:22:09.297454 [info ] [MainThread]: 
[0m15:22:09.298454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:09.300455 [info ] [MainThread]: 
[0m15:22:09.301457 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m15:22:09.303457 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:09.303457 after 18.32 seconds
[0m15:22:09.303457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029437382C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294374674A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294354F11F0>]}
[0m15:22:09.304497 [debug] [MainThread]: Flushing usage events
[0m15:23:22.782327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0DB6B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0DB6B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0DB69700>]}


============================== 15:23:22.787354 | 86b97cac-c5d1-4eae-addf-c7a06e54c30c ==============================
[0m15:23:22.787354 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:23:22.788319 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:23:23.382565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0F456FF0>]}
[0m15:23:23.483189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0EC43BC0>]}
[0m15:23:23.484851 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:23:23.503486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:23:24.861041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:24.861041 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:23:25.031143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:23:25.037179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FB08A40>]}
[0m15:23:25.066330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FAAF530>]}
[0m15:23:25.067365 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:23:25.067365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0EC99EB0>]}
[0m15:23:25.070365 [info ] [MainThread]: 
[0m15:23:25.071369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:25.073365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:23:25.089365 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:23:25.089365 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:23:25.090331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:26.273625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:23:26.279625 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:23:26.440061 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:23:26.442102 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:23:26.444153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:26.988138 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:23:26.991149 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:23:27.147240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:23:27.160741 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:23:27.160741 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:23:27.161741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:27.707902 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:23:27.710867 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:23:27.852856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:23:27.860851 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:23:27.861852 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:23:27.861852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:28.415251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:23:28.417266 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:23:28.566757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0EC79850>]}
[0m15:23:28.568262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:28.569271 [info ] [MainThread]: 
[0m15:23:28.573284 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:23:28.574317 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:23:28.575283 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:23:28.576285 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:23:28.585317 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:23:28.587284 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:23:28.576285 => 15:23:28.587284
[0m15:23:28.588283 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:23:28.622316 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:23:28.624283 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:23:28.625321 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:23:28.625321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:29.787123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:23:29.812112 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:23:28.588283 => 15:23:29.812112
[0m15:23:29.812112 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:23:29.956183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FD68410>]}
[0m15:23:29.959262 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.38s]
[0m15:23:29.963257 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:23:29.965265 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:23:29.968254 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:23:29.971200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:23:29.972719 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:23:29.978745 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:23:29.980734 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:23:29.973740 => 15:23:29.980734
[0m15:23:29.981733 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:23:30.036766 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:23:30.038732 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:23:30.038732 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:23:30.039762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.816794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:23:30.819791 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:23:29.981733 => 15:23:30.818791
[0m15:23:30.819791 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:23:30.970377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FD5F9B0>]}
[0m15:23:30.973371 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.00s]
[0m15:23:30.977373 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:23:30.980026 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:23:30.982026 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:23:30.984266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:23:30.986313 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:23:30.993290 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:23:30.995273 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:23:30.987301 => 15:23:30.994258
[0m15:23:30.995273 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:23:31.000257 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:23:31.002256 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:23:31.003256 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:23:31.003256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:31.956781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:23:31.960772 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:23:30.996291 => 15:23:31.959777
[0m15:23:31.960772 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:23:32.109023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FD8FA40>]}
[0m15:23:32.110024 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.13s]
[0m15:23:32.110990 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:23:32.111991 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:23:32.111991 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:23:32.113081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:23:32.114122 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:23:32.118122 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:23:32.119123 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:23:32.114122 => 15:23:32.119123
[0m15:23:32.120122 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:23:32.122121 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:23:32.125122 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:23:32.125122 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        CAST(TO_DATE(payment_month,'DD-MM-YYYY') AS DATE) AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:23:32.126123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:33.081637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff1-0001-085a-0000-50e90002f36a
[0m15:23:33.082637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100097 (22007): Can't parse '2020-01-04 00:00:00.0000000' as date with format 'DD-MM-YYYY'
[0m15:23:33.083641 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:23:32.120122 => 15:23:33.082637
[0m15:23:33.083641 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:23:33.298492 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  100097 (22007): Can't parse '2020-01-04 00:00:00.0000000' as date with format 'DD-MM-YYYY'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:23:33.298492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b97cac-c5d1-4eae-addf-c7a06e54c30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FB08AA0>]}
[0m15:23:33.299491 [error] [Thread-1 (]: 4 of 13 ERROR creating sql table model staging.staging_transactions_table ...... [[31mERROR[0m in 1.19s]
[0m15:23:33.300482 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:23:33.302743 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:23:33.302743 [info ] [Thread-1 (]: 5 of 13 SKIP relation transform.churn_new_customer ............................. [[33mSKIP[0m]
[0m15:23:33.303919 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:23:33.304927 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:23:33.304927 [info ] [Thread-1 (]: 6 of 13 SKIP relation transform.churn_new_customers_l3m ........................ [[33mSKIP[0m]
[0m15:23:33.305927 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:23:33.305927 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:23:33.306964 [info ] [Thread-1 (]: 7 of 13 SKIP relation transform.churn_new_customers_lm ......................... [[33mSKIP[0m]
[0m15:23:33.307926 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:23:33.308929 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:23:33.308929 [info ] [Thread-1 (]: 8 of 13 SKIP relation transform.churn_new_customers_ltm ........................ [[33mSKIP[0m]
[0m15:23:33.309929 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:23:33.310929 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:23:33.311927 [info ] [Thread-1 (]: 9 of 13 SKIP relation transform.churned_customer_last_month .................... [[33mSKIP[0m]
[0m15:23:33.312964 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:23:33.313929 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:23:33.314928 [info ] [Thread-1 (]: 10 of 13 SKIP relation transform.churned_customer_last_three ................... [[33mSKIP[0m]
[0m15:23:33.315927 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:23:33.315927 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:23:33.316960 [info ] [Thread-1 (]: 11 of 13 SKIP relation transform.churned_customer_last_year .................... [[33mSKIP[0m]
[0m15:23:33.317945 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:23:33.318937 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:23:33.318937 [info ] [Thread-1 (]: 12 of 13 SKIP relation transform.customer_revenue_ranking ...................... [[33mSKIP[0m]
[0m15:23:33.320927 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:23:33.320927 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:23:33.321931 [info ] [Thread-1 (]: 13 of 13 SKIP relation transform.product_revenue_ranking ....................... [[33mSKIP[0m]
[0m15:23:33.322956 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:23:33.325308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:33.325308 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:23:33.326308 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:23:33.326308 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:23:33.327308 [info ] [MainThread]: 
[0m15:23:33.327308 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m15:23:33.330342 [debug] [MainThread]: Command end result
[0m15:23:33.341343 [info ] [MainThread]: 
[0m15:23:33.342307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:23:33.343308 [info ] [MainThread]: 
[0m15:23:33.344309 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  100097 (22007): Can't parse '2020-01-04 00:00:00.0000000' as date with format 'DD-MM-YYYY'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:23:33.345310 [info ] [MainThread]: 
[0m15:23:33.345927 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=9 TOTAL=13
[0m15:23:33.346937 [debug] [MainThread]: Command `dbt run` failed at 15:23:33.346937 after 10.68 seconds
[0m15:23:33.347969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0FDACB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0D8B7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0F8DC380>]}
[0m15:23:33.347969 [debug] [MainThread]: Flushing usage events
[0m15:26:03.329792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2DAA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2DA9FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2DAA540>]}


============================== 15:26:03.334790 | 2901d99a-88db-4148-b5d6-1e7b62da892d ==============================
[0m15:26:03.334790 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:26:03.335768 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:26:03.853004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2F3A360>]}
[0m15:26:03.953621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4923BC0>]}
[0m15:26:03.955457 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:26:03.964309 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:26:04.077884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:04.078903 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:26:04.241944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:26:04.247979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4E472C0>]}
[0m15:26:04.262062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4D2F410>]}
[0m15:26:04.263062 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:26:04.264077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4DDC800>]}
[0m15:26:04.266062 [info ] [MainThread]: 
[0m15:26:04.267062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:04.269638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:26:04.284646 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:26:04.285647 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:26:04.285647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:05.336858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:05.342481 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:26:05.498800 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:26:05.499796 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:26:05.499796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:06.085617 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:06.091551 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:26:06.240163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:26:06.254763 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:26:06.255727 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:26:06.255727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:06.859859 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:26:06.862855 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:26:07.005352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:26:07.008305 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:26:07.009306 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:26:07.010307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:07.461786 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m15:26:07.469783 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:26:07.629750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4A3AFF0>]}
[0m15:26:07.630791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:07.631260 [info ] [MainThread]: 
[0m15:26:07.635929 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:26:07.635929 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:26:07.637944 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:26:07.637944 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:26:07.646930 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:26:07.647929 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:26:07.637944 => 15:26:07.647929
[0m15:26:07.648931 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:26:07.684479 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:26:07.686445 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:26:07.687449 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:26:07.687449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:08.795546 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:08.821537 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:26:07.649437 => 15:26:08.820541
[0m15:26:08.821537 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:26:08.963563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D500CDA0>]}
[0m15:26:08.966564 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.33s]
[0m15:26:08.970562 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:26:08.972578 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:26:08.975563 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:26:08.978511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:26:08.979507 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:26:08.987503 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:26:08.989508 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:26:08.980511 => 15:26:08.989508
[0m15:26:08.990511 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:26:09.047543 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:26:09.049508 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:26:09.050539 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:26:09.050539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:10.105893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:10.116893 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:26:08.991541 => 15:26:10.115894
[0m15:26:10.118892 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:26:10.277527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D500FC50>]}
[0m15:26:10.280527 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.30s]
[0m15:26:10.284531 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:26:10.286479 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:26:10.289734 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:26:10.292772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:26:10.293771 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:26:10.299719 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:26:10.301720 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:26:10.294773 => 15:26:10.300773
[0m15:26:10.302721 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:26:10.306728 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:26:10.308718 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:26:10.309763 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:26:10.309763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:11.185107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:11.189130 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:26:10.302721 => 15:26:11.189130
[0m15:26:11.190128 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:26:11.330778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D500E540>]}
[0m15:26:11.333780 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.04s]
[0m15:26:11.337782 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:26:11.339733 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:26:11.340778 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:26:11.342715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:26:11.342715 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:26:11.347788 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:26:11.349750 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:26:11.343753 => 15:26:11.349750
[0m15:26:11.350786 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:26:11.353783 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:26:11.355786 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:26:11.355786 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(SUBSTR(payment_month, 1, 10), 'YYYY-MM-DD') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:26:11.356784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:12.221860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:12.224896 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:26:11.350786 => 15:26:12.223893
[0m15:26:12.224896 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:26:12.363928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4FB6150>]}
[0m15:26:12.363928 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 1.02s]
[0m15:26:12.364930 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:26:12.366939 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:26:12.366939 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churn_new_customer ..................... [RUN]
[0m15:26:12.368479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:26:12.368479 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:26:12.372521 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:26:12.374488 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:26:12.369521 => 15:26:12.373519
[0m15:26:12.374488 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:26:12.378488 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:26:12.382487 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:26:12.383520 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:26:12.383520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:13.382881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:13.385851 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:26:12.375506 => 15:26:13.385851
[0m15:26:13.386851 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:26:13.534878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D50259A0>]}
[0m15:26:13.537878 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churn_new_customer ................ [[32mSUCCESS 1[0m in 1.17s]
[0m15:26:13.541880 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:26:13.543896 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:26:13.546893 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m15:26:13.549823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.churn_new_customers_l3m)
[0m15:26:13.551828 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m15:26:13.558835 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:26:13.561842 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 15:26:13.552869 => 15:26:13.560832
[0m15:26:13.562873 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m15:26:13.568870 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:26:13.571867 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:26:13.571867 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:26:13.571867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:14.453780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:14.460782 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 15:26:13.562873 => 15:26:14.459778
[0m15:26:14.461847 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m15:26:14.611441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D50090A0>]}
[0m15:26:14.614443 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 1.06s]
[0m15:26:14.618442 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:26:14.620442 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:26:14.623457 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m15:26:14.627457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m15:26:14.627457 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m15:26:14.631411 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:26:14.633377 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 15:26:14.628410 => 15:26:14.632411
[0m15:26:14.633377 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m15:26:14.636414 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:26:14.639410 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m15:26:14.639410 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:26:14.640411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:15.478324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:15.480903 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 15:26:14.633377 => 15:26:15.480903
[0m15:26:15.480903 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m15:26:15.620943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D50663C0>]}
[0m15:26:15.623944 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 0.99s]
[0m15:26:15.627944 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:26:15.629945 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:26:15.632897 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m15:26:15.636712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m15:26:15.638707 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m15:26:15.644712 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:26:15.646696 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 15:26:15.640730 => 15:26:15.645711
[0m15:26:15.647731 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m15:26:15.650731 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:26:15.652732 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:26:15.653733 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:26:15.653733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:16.700845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:16.703815 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 15:26:15.647731 => 15:26:16.703815
[0m15:26:16.704814 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m15:26:16.850479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D5066AB0>]}
[0m15:26:16.853478 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 1.21s]
[0m15:26:16.857480 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:26:16.859480 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:26:16.860485 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m15:26:16.863485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m15:26:16.864423 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m15:26:16.872477 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:26:16.874472 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 15:26:16.865465 => 15:26:16.873516
[0m15:26:16.875512 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m15:26:16.879473 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:26:16.882508 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m15:26:16.882508 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:26:16.883508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:17.763818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:17.771846 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 15:26:16.875512 => 15:26:17.770824
[0m15:26:17.773851 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m15:26:17.922641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D5024D10>]}
[0m15:26:17.925642 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.06s]
[0m15:26:17.929658 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:26:17.931658 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:26:17.934642 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.churned_customer_last_three ........... [RUN]
[0m15:26:17.937587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m15:26:17.939590 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m15:26:17.948582 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:26:17.950582 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 15:26:17.939590 => 15:26:17.949639
[0m15:26:17.951618 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m15:26:17.955617 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:26:17.957581 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m15:26:17.958615 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:26:17.959618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:19.222091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:19.233091 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 15:26:17.951618 => 15:26:19.232089
[0m15:26:19.235090 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m15:26:19.386907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D5088770>]}
[0m15:26:19.389906 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.churned_customer_last_three ...... [[32mSUCCESS 1[0m in 1.45s]
[0m15:26:19.393509 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:26:19.395509 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:26:19.397450 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m15:26:19.416697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m15:26:19.417698 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m15:26:19.423691 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:26:19.424691 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 15:26:19.418698 => 15:26:19.424691
[0m15:26:19.425692 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m15:26:19.430691 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:26:19.433692 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m15:26:19.433692 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:26:19.434723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:20.688386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:20.692403 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 15:26:19.425692 => 15:26:20.692403
[0m15:26:20.692403 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m15:26:20.830672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D50A81A0>]}
[0m15:26:20.831635 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 1.41s]
[0m15:26:20.832606 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:26:20.833637 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:26:20.834635 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m15:26:20.835634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:26:20.835634 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:26:20.839636 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:26:20.840638 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:26:20.835634 => 15:26:20.839636
[0m15:26:20.840638 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:26:20.844613 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:26:20.846604 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:26:20.847602 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:26:20.848605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:21.814018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:21.816990 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:26:20.841637 => 15:26:21.816990
[0m15:26:21.816990 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:26:21.956778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D5090830>]}
[0m15:26:21.956778 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.12s]
[0m15:26:21.957887 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:26:21.958933 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:26:21.958933 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m15:26:21.960932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:26:21.960932 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:26:21.964930 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:26:21.965932 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:26:21.960932 => 15:26:21.965932
[0m15:26:21.966930 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:26:21.969933 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:26:21.971901 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:26:21.972937 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:26:21.972937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:22.927589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:22.930592 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:26:21.966930 => 15:26:22.930592
[0m15:26:22.931608 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:26:23.081815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901d99a-88db-4148-b5d6-1e7b62da892d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D4BFC2F0>]}
[0m15:26:23.084816 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 1.12s]
[0m15:26:23.088814 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:26:23.095738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:23.097707 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:26:23.097707 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:26:23.097707 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:26:23.098708 [info ] [MainThread]: 
[0m15:26:23.099724 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.83 seconds (18.83s).
[0m15:26:23.103728 [debug] [MainThread]: Command end result
[0m15:26:23.114283 [info ] [MainThread]: 
[0m15:26:23.115318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:23.115318 [info ] [MainThread]: 
[0m15:26:23.116317 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m15:26:23.118284 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:23.118284 after 19.88 seconds
[0m15:26:23.118284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2C7B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2DA9FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D2DAA720>]}
[0m15:26:23.119317 [debug] [MainThread]: Flushing usage events
[0m15:27:58.596931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940741A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029407419E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940741A5D0>]}


============================== 15:27:58.602931 | dd6be331-70e1-4cf8-ad08-5b69b6421da8 ==============================
[0m15:27:58.602931 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:27:58.603972 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:27:59.143367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029407D66FF0>]}
[0m15:27:59.246956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029407DCBE90>]}
[0m15:27:59.248958 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:27:59.258991 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:27:59.381567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:59.381567 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:27:59.549611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:27:59.556647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940747A030>]}
[0m15:27:59.570610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940938C680>]}
[0m15:27:59.571645 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:27:59.572611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029409387260>]}
[0m15:27:59.575614 [info ] [MainThread]: 
[0m15:27:59.577608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:59.580629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:27:59.598610 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:27:59.599628 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:27:59.600610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:00.525857 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:28:00.530856 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:28:00.684875 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:28:00.685877 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:28:00.685877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:01.217824 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:28:01.222822 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:28:01.383486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:28:01.394465 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:28:01.395466 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:28:01.395466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:01.836545 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:28:01.839516 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:28:01.988868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:28:01.991868 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:28:01.992868 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:28:01.992868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:02.548444 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:28:02.551373 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:28:02.706839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029409139F10>]}
[0m15:28:02.707842 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:02.708811 [info ] [MainThread]: 
[0m15:28:02.712516 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:28:02.713543 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:28:02.714517 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:28:02.715544 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:28:02.725514 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:28:02.727516 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:28:02.715544 => 15:28:02.726515
[0m15:28:02.727516 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:28:02.765140 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:28:02.766106 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:28:02.767140 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:28:02.768108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:03.737690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:28:03.763242 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:28:02.728515 => 15:28:03.763242
[0m15:28:03.763242 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:28:03.912301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940966E510>]}
[0m15:28:03.913302 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.20s]
[0m15:28:03.915434 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:28:03.916476 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:28:03.917472 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:28:03.918431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:28:03.919473 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:28:03.925464 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:28:03.927431 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:28:03.920474 => 15:28:03.926467
[0m15:28:03.927431 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:28:03.982087 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:28:03.984050 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:28:03.985089 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:28:03.985089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:04.917498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:28:04.928446 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:28:03.928432 => 15:28:04.927496
[0m15:28:04.930444 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:28:05.081212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940966CB00>]}
[0m15:28:05.084211 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.16s]
[0m15:28:05.088211 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:28:05.090215 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:28:05.093505 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:28:05.095833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:28:05.097881 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:28:05.105870 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:28:05.108832 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:28:05.098884 => 15:28:05.107830
[0m15:28:05.109830 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:28:05.113866 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:28:05.115829 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:28:05.116863 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:28:05.116863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:06.084643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:28:06.095644 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:28:05.109830 => 15:28:06.094643
[0m15:28:06.097644 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:28:06.248671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940966F1A0>]}
[0m15:28:06.249670 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.15s]
[0m15:28:06.250554 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:28:06.251621 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:28:06.252667 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:28:06.253631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:28:06.253631 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:28:06.258708 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:28:06.259706 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:28:06.254665 => 15:28:06.259706
[0m15:28:06.260672 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:28:06.263706 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:28:06.265705 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:28:06.265705 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(SUBSTR(payment_month, 1, 10), 'DD-MM-YYYY') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:28:06.266707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:07.005886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff6-0001-089f-0000-50e90002d6da
[0m15:28:07.006887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100097 (22007): Can't parse '2020-01-04' as date with format 'DD-MM-YYYY'
[0m15:28:07.006887 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:28:06.260672 => 15:28:07.006887
[0m15:28:07.007887 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:28:07.161319 [debug] [Thread-1 (]: Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  100097 (22007): Can't parse '2020-01-04' as date with format 'DD-MM-YYYY'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:28:07.162319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6be331-70e1-4cf8-ad08-5b69b6421da8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940936B4D0>]}
[0m15:28:07.163320 [error] [Thread-1 (]: 4 of 13 ERROR creating sql table model staging.staging_transactions_table ...... [[31mERROR[0m in 0.91s]
[0m15:28:07.165700 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:28:07.167699 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:28:07.168698 [info ] [Thread-1 (]: 5 of 13 SKIP relation transform.churn_new_customer ............................. [[33mSKIP[0m]
[0m15:28:07.170695 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:28:07.170695 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:28:07.171694 [info ] [Thread-1 (]: 6 of 13 SKIP relation transform.churn_new_customers_l3m ........................ [[33mSKIP[0m]
[0m15:28:07.172717 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:28:07.174208 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:28:07.174208 [info ] [Thread-1 (]: 7 of 13 SKIP relation transform.churn_new_customers_lm ......................... [[33mSKIP[0m]
[0m15:28:07.175259 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:28:07.176261 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:28:07.177256 [info ] [Thread-1 (]: 8 of 13 SKIP relation transform.churn_new_customers_ltm ........................ [[33mSKIP[0m]
[0m15:28:07.178217 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:28:07.178217 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:28:07.179254 [info ] [Thread-1 (]: 9 of 13 SKIP relation transform.churned_customer_last_month .................... [[33mSKIP[0m]
[0m15:28:07.180219 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:28:07.181260 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:28:07.181260 [info ] [Thread-1 (]: 10 of 13 SKIP relation transform.churned_customer_last_three ................... [[33mSKIP[0m]
[0m15:28:07.182217 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:28:07.183217 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:28:07.184217 [info ] [Thread-1 (]: 11 of 13 SKIP relation transform.churned_customer_last_year .................... [[33mSKIP[0m]
[0m15:28:07.184217 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:28:07.185251 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:28:07.185251 [info ] [Thread-1 (]: 12 of 13 SKIP relation transform.customer_revenue_ranking ...................... [[33mSKIP[0m]
[0m15:28:07.186250 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:28:07.187250 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:28:07.187250 [info ] [Thread-1 (]: 13 of 13 SKIP relation transform.product_revenue_ranking ....................... [[33mSKIP[0m]
[0m15:28:07.188248 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:28:07.191232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:07.192218 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:28:07.192218 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:28:07.193220 [debug] [MainThread]: Connection 'model.mini_project_dbt.staging_transactions_table' was properly closed.
[0m15:28:07.193220 [info ] [MainThread]: 
[0m15:28:07.194234 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m15:28:07.196249 [debug] [MainThread]: Command end result
[0m15:28:07.208241 [info ] [MainThread]: 
[0m15:28:07.209234 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:28:07.210216 [info ] [MainThread]: 
[0m15:28:07.212218 [error] [MainThread]:   Database Error in model staging_transactions_table (models\staging\staging_transactions_table.sql)
  100097 (22007): Can't parse '2020-01-04' as date with format 'DD-MM-YYYY'
  compiled Code at target\run\mini_project_dbt\models\staging\staging_transactions_table.sql
[0m15:28:07.212218 [info ] [MainThread]: 
[0m15:28:07.213252 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=9 TOTAL=13
[0m15:28:07.215251 [debug] [MainThread]: Command `dbt run` failed at 15:28:07.214247 after 8.71 seconds
[0m15:28:07.215251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029408F4F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940949EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002940741A150>]}
[0m15:28:07.215251 [debug] [MainThread]: Flushing usage events
[0m15:29:15.634169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F92A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F92A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F92AD80>]}


============================== 15:29:15.640144 | 3c308a23-969e-4a98-81cb-1e0e40476806 ==============================
[0m15:29:15.640144 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:29:15.641111 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:29:16.154157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643FCC1EB0>]}
[0m15:29:16.254788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643FA33BC0>]}
[0m15:29:16.255785 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:29:16.264782 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:29:16.375980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:16.376977 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\staging\staging_transactions_table.sql
[0m15:29:16.538437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:29:16.544959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264415CBEF0>]}
[0m15:29:16.556956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002644188F500>]}
[0m15:29:16.557955 [info ] [MainThread]: Found 13 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:29:16.558922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F955D30>]}
[0m15:29:16.560922 [info ] [MainThread]: 
[0m15:29:16.562956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:16.564956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:29:16.579923 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:29:16.580962 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:29:16.580962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:17.630885 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:29:17.632885 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:29:17.800314 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:29:17.801312 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:29:17.802318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:18.217297 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:29:18.220305 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:29:18.380440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:29:18.391428 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:29:18.391428 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:29:18.392428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:18.943786 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:29:18.947745 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:29:19.084495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:29:19.087493 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:29:19.088493 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:29:19.088493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:19.630978 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:29:19.638985 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:29:19.798984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441A35730>]}
[0m15:29:19.803037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:19.804991 [info ] [MainThread]: 
[0m15:29:19.819047 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:29:19.820989 [info ] [Thread-1 (]: 1 of 13 START sql table model staging.staging_country_region_table ............. [RUN]
[0m15:29:19.823973 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:29:19.823973 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:29:19.835019 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:29:19.836995 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:29:19.824973 => 15:29:19.835984
[0m15:29:19.836995 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:29:19.871551 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:29:19.873513 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:29:19.874548 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:29:19.874548 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:20.942697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:20.968234 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:29:19.837984 => 15:29:20.967237
[0m15:29:20.968234 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:29:21.379741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B9AB10>]}
[0m15:29:21.380741 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging.staging_country_region_table ........ [[32mSUCCESS 1[0m in 1.56s]
[0m15:29:21.381742 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:29:21.382739 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:29:21.382739 [info ] [Thread-1 (]: 2 of 13 START sql table model staging.staging_customers_table .................. [RUN]
[0m15:29:21.384740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:29:21.384740 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:29:21.388740 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:29:21.389706 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:29:21.384740 => 15:29:21.389706
[0m15:29:21.389706 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:29:21.444779 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:29:21.446747 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:29:21.447779 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:29:21.447779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:22.435738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:22.440722 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:29:21.390739 => 15:29:22.440722
[0m15:29:22.441728 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:29:22.593215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B9B410>]}
[0m15:29:22.596215 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging.staging_customers_table ............. [[32mSUCCESS 1[0m in 1.21s]
[0m15:29:22.600215 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:29:22.602215 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:29:22.603214 [info ] [Thread-1 (]: 3 of 13 START sql table model staging.staging_products_table ................... [RUN]
[0m15:29:22.605153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:29:22.605153 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:29:22.610153 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:29:22.611153 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:29:22.605153 => 15:29:22.611153
[0m15:29:22.612157 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:29:22.616154 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:29:22.618169 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:29:22.619152 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:29:22.619152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:23.638611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:23.643622 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:29:22.612157 => 15:29:23.643622
[0m15:29:23.643622 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:29:23.783411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264418CC440>]}
[0m15:29:23.784375 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging.staging_products_table .............. [[32mSUCCESS 1[0m in 1.18s]
[0m15:29:23.785410 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:29:23.785410 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:29:23.786376 [info ] [Thread-1 (]: 4 of 13 START sql table model staging.staging_transactions_table ............... [RUN]
[0m15:29:23.787410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:29:23.788409 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:29:23.792378 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:29:23.793376 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:29:23.788409 => 15:29:23.793376
[0m15:29:23.794377 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:29:23.797410 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:29:23.800375 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:29:23.801375 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(SUBSTR(payment_month, 1, 10), 'YYYY-DD-MM') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:29:23.801375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:24.602232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:24.606205 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:29:23.794377 => 15:29:24.605202
[0m15:29:24.606205 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:29:24.748762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B0B410>]}
[0m15:29:24.751762 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging.staging_transactions_table .......... [[32mSUCCESS 1[0m in 0.96s]
[0m15:29:24.755953 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:29:24.759952 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:29:24.761967 [info ] [Thread-1 (]: 5 of 13 START sql table model transform.churn_new_customer ..................... [RUN]
[0m15:29:24.765943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:29:24.767002 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:29:24.772989 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:29:24.774952 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:29:24.767969 => 15:29:24.773956
[0m15:29:24.774952 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:29:24.777986 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:29:24.782532 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:29:24.783498 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:29:24.784505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:25.741254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:25.744247 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:29:24.775986 => 15:29:25.743250
[0m15:29:25.744247 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:29:25.889920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441BCF0B0>]}
[0m15:29:25.892997 [info ] [Thread-1 (]: 5 of 13 OK created sql table model transform.churn_new_customer ................ [[32mSUCCESS 1[0m in 1.13s]
[0m15:29:25.896998 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:29:25.898996 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:29:25.901996 [info ] [Thread-1 (]: 6 of 13 START sql table model transform.churn_new_customers_l3m ................ [RUN]
[0m15:29:25.904942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.churn_new_customers_l3m)
[0m15:29:25.905989 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_l3m
[0m15:29:25.913980 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:29:25.915938 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (compile): 15:29:25.906947 => 15:29:25.914978
[0m15:29:25.916937 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_l3m
[0m15:29:25.923969 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:29:25.926970 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_l3m"
[0m15:29:25.926970 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_l3m"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_l3m
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:29:25.927969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:26.802029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:26.804024 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_l3m (execute): 15:29:25.916937 => 15:29:26.804024
[0m15:29:26.805025 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_l3m: Close
[0m15:29:26.954082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B950D0>]}
[0m15:29:26.957083 [info ] [Thread-1 (]: 6 of 13 OK created sql table model transform.churn_new_customers_l3m ........... [[32mSUCCESS 1[0m in 1.05s]
[0m15:29:26.961033 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_l3m
[0m15:29:26.963034 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_lm
[0m15:29:26.966035 [info ] [Thread-1 (]: 7 of 13 START sql table model transform.churn_new_customers_lm ................. [RUN]
[0m15:29:26.969843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_l3m, now model.mini_project_dbt.churn_new_customers_lm)
[0m15:29:26.971852 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_lm
[0m15:29:26.982912 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:29:26.985861 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (compile): 15:29:26.973837 => 15:29:26.984896
[0m15:29:26.986896 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_lm
[0m15:29:26.991902 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_lm"
[0m15:29:26.996458 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_lm"
[0m15:29:26.997455 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_lm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_lm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:29:26.998454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:27.886663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:27.890635 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_lm (execute): 15:29:26.986896 => 15:29:27.889632
[0m15:29:27.890635 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_lm: Close
[0m15:29:28.039451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B95760>]}
[0m15:29:28.040406 [info ] [Thread-1 (]: 7 of 13 OK created sql table model transform.churn_new_customers_lm ............ [[32mSUCCESS 1[0m in 1.07s]
[0m15:29:28.041371 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_lm
[0m15:29:28.042404 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:29:28.043153 [info ] [Thread-1 (]: 8 of 13 START sql table model transform.churn_new_customers_ltm ................ [RUN]
[0m15:29:28.061556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_lm, now model.mini_project_dbt.churn_new_customers_ltm)
[0m15:29:28.062542 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customers_ltm
[0m15:29:28.065578 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:29:28.066578 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (compile): 15:29:28.062542 => 15:29:28.066578
[0m15:29:28.067542 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customers_ltm
[0m15:29:28.070577 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:29:28.072542 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customers_ltm"
[0m15:29:28.073580 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customers_ltm"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customers_ltm
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c.churned_customers, 0) AS churned_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c ON n.month = c.month
ORDER BY month
        );
[0m15:29:28.073580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:29.142407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:29.145382 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customers_ltm (execute): 15:29:28.067542 => 15:29:29.145382
[0m15:29:29.146376 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customers_ltm: Close
[0m15:29:29.287237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441B95430>]}
[0m15:29:29.290274 [info ] [Thread-1 (]: 8 of 13 OK created sql table model transform.churn_new_customers_ltm ........... [[32mSUCCESS 1[0m in 1.23s]
[0m15:29:29.294275 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customers_ltm
[0m15:29:29.296229 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_month
[0m15:29:29.298266 [info ] [Thread-1 (]: 9 of 13 START sql table model transform.churned_customer_last_month ............ [RUN]
[0m15:29:29.301218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customers_ltm, now model.mini_project_dbt.churned_customer_last_month)
[0m15:29:29.302837 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_month
[0m15:29:29.309863 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:29:29.311847 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (compile): 15:29:29.303890 => 15:29:29.310849
[0m15:29:29.311847 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_month
[0m15:29:29.314884 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_month"
[0m15:29:29.316876 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_month"
[0m15:29:29.317880 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_month"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_month
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -1, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:29:29.318881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:30.318370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:30.323302 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_month (execute): 15:29:29.311847 => 15:29:30.322339
[0m15:29:30.323302 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_month: Close
[0m15:29:30.466963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264416BDB20>]}
[0m15:29:30.469951 [info ] [Thread-1 (]: 9 of 13 OK created sql table model transform.churned_customer_last_month ....... [[32mSUCCESS 1[0m in 1.17s]
[0m15:29:30.473950 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_month
[0m15:29:30.475970 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_three
[0m15:29:30.479068 [info ] [Thread-1 (]: 10 of 13 START sql table model transform.churned_customer_last_three ........... [RUN]
[0m15:29:30.482014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_month, now model.mini_project_dbt.churned_customer_last_three)
[0m15:29:30.483066 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_three
[0m15:29:30.489038 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:29:30.490038 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (compile): 15:29:30.484018 => 15:29:30.490038
[0m15:29:30.491006 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_three
[0m15:29:30.494046 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_three"
[0m15:29:30.496046 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_three"
[0m15:29:30.497048 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_three"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_three
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:29:30.497048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:31.446891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:31.449860 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_three (execute): 15:29:30.491006 => 15:29:31.449860
[0m15:29:31.450861 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_three: Close
[0m15:29:31.599567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441C48650>]}
[0m15:29:31.602568 [info ] [Thread-1 (]: 10 of 13 OK created sql table model transform.churned_customer_last_three ...... [[32mSUCCESS 1[0m in 1.12s]
[0m15:29:31.606517 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_three
[0m15:29:31.608519 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churned_customer_last_year
[0m15:29:31.610504 [info ] [Thread-1 (]: 11 of 13 START sql table model transform.churned_customer_last_year ............ [RUN]
[0m15:29:31.610976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_three, now model.mini_project_dbt.churned_customer_last_year)
[0m15:29:31.612021 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churned_customer_last_year
[0m15:29:31.616989 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:29:31.618987 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (compile): 15:29:31.612987 => 15:29:31.618034
[0m15:29:31.618987 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churned_customer_last_year
[0m15:29:31.624987 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churned_customer_last_year"
[0m15:29:31.627020 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churned_customer_last_year"
[0m15:29:31.628020 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churned_customer_last_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churned_customer_last_year
         as
        (
 
WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  AS t
    LEFT JOIN MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table AS c
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -12, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m15:29:31.628988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:32.590280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:32.594249 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churned_customer_last_year (execute): 15:29:31.620021 => 15:29:32.594249
[0m15:29:32.594249 [debug] [Thread-1 (]: On model.mini_project_dbt.churned_customer_last_year: Close
[0m15:29:32.748172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441C51DF0>]}
[0m15:29:32.751177 [info ] [Thread-1 (]: 11 of 13 OK created sql table model transform.churned_customer_last_year ....... [[32mSUCCESS 1[0m in 1.14s]
[0m15:29:32.755123 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churned_customer_last_year
[0m15:29:32.757118 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:29:32.760433 [info ] [Thread-1 (]: 12 of 13 START sql table model transform.customer_revenue_ranking .............. [RUN]
[0m15:29:32.763853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churned_customer_last_year, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:29:32.764855 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:29:32.770801 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:29:32.771803 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:29:32.765808 => 15:29:32.771803
[0m15:29:32.772801 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:29:32.778805 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:29:32.780799 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:29:32.780799 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:29:32.781799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:33.996519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:34.008550 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:29:32.772801 => 15:29:34.007552
[0m15:29:34.009614 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:29:34.149930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441C52AB0>]}
[0m15:29:34.150894 [info ] [Thread-1 (]: 12 of 13 OK created sql table model transform.customer_revenue_ranking ......... [[32mSUCCESS 1[0m in 1.39s]
[0m15:29:34.151892 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:29:34.152861 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:29:34.152861 [info ] [Thread-1 (]: 13 of 13 START sql table model transform.product_revenue_ranking ............... [RUN]
[0m15:29:34.153861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:29:34.154892 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:29:34.157892 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:29:34.158892 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:29:34.154892 => 15:29:34.158892
[0m15:29:34.159859 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:29:34.162860 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:29:34.165862 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:29:34.165862 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:29:34.166897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:34.924604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:34.930208 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:29:34.159859 => 15:29:34.930208
[0m15:29:34.931206 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:29:35.079496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c308a23-969e-4a98-81cb-1e0e40476806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026441C523F0>]}
[0m15:29:35.082499 [info ] [Thread-1 (]: 13 of 13 OK created sql table model transform.product_revenue_ranking .......... [[32mSUCCESS 1[0m in 0.92s]
[0m15:29:35.086498 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:29:35.094666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:35.095664 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:29:35.096634 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:29:35.096634 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:29:35.096634 [info ] [MainThread]: 
[0m15:29:35.097634 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 18.53 seconds (18.53s).
[0m15:29:35.101624 [debug] [MainThread]: Command end result
[0m15:29:35.114609 [info ] [MainThread]: 
[0m15:29:35.115607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:35.116609 [info ] [MainThread]: 
[0m15:29:35.117606 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m15:29:35.118607 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:35.118607 after 19.57 seconds
[0m15:29:35.119608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F511C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F550F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002643F73DFA0>]}
[0m15:29:35.119608 [debug] [MainThread]: Flushing usage events
[0m15:34:01.145075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B36FCADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B36FCAC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B36FC9490>]}


============================== 15:34:01.151109 | a9dcf710-843e-4c76-b929-5f1fa2d111c3 ==============================
[0m15:34:01.151109 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:34:01.152075 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m staging_transactions_table', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:34:01.718594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9dcf710-843e-4c76-b929-5f1fa2d111c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3701AB40>]}
[0m15:34:01.831256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9dcf710-843e-4c76-b929-5f1fa2d111c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B38BC6ED0>]}
[0m15:34:01.833080 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:34:01.843096 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:34:01.963206 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 0 files added, 1 files changed.
[0m15:34:01.963206 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churned_customer_last_three.sql
[0m15:34:01.964207 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churned_customer_last_year.sql
[0m15:34:01.964207 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churn_new_customers_ltm.sql
[0m15:34:01.965210 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churned_customer_last_month.sql
[0m15:34:01.965210 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churn_new_customers_lm.sql
[0m15:34:01.965210 [debug] [MainThread]: Partial parsing: deleted file: mini_project_dbt://models\transform\churn_new_customers_l3m.sql
[0m15:34:01.966207 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:34:02.137828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:34:02.143903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9dcf710-843e-4c76-b929-5f1fa2d111c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B38C2A210>]}
[0m15:34:02.156996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9dcf710-843e-4c76-b929-5f1fa2d111c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B38D88800>]}
[0m15:34:02.157999 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:34:02.158996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9dcf710-843e-4c76-b929-5f1fa2d111c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B38F4DFA0>]}
[0m15:34:02.160998 [info ] [MainThread]: 
[0m15:34:02.163030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:02.164034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:34:02.183051 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:34:02.183995 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:34:02.183995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:03.174459 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:34:03.176465 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:34:03.326003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:03.327003 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:34:03.327003 [info ] [MainThread]: 
[0m15:34:03.328003 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:34:03.329003 [error] [MainThread]: Encountered an error:

[0m15:34:03.383085 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 572, in create_schemas
    for ls_future in as_completed(list_futures):
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:34:03.386050 [debug] [MainThread]: Command `dbt run` failed at 15:34:03.386050 after 2.33 seconds
[0m15:34:03.387053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B36FCA270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B390E1EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B36F99A30>]}
[0m15:34:03.387053 [debug] [MainThread]: Flushing usage events
[0m15:34:21.957616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C99040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C99070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C985F0>]}


============================== 15:34:21.962615 | 3a9aaed5-44c0-4b02-ac5b-622e966714e6 ==============================
[0m15:34:21.962615 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:34:21.963580 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:34:22.482649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C76AE8A0>]}
[0m15:34:22.584236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C9BAA0>]}
[0m15:34:22.586261 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:34:22.594884 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:34:22.697438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:22.697438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:22.698441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:34:22.704744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C98170>]}
[0m15:34:22.717751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C8A63B00>]}
[0m15:34:22.718708 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:34:22.719710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C88E78F0>]}
[0m15:34:22.720741 [info ] [MainThread]: 
[0m15:34:22.722741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:22.723706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:34:22.738742 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:34:22.739743 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:34:22.740742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:23.944488 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:34:23.946446 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:34:24.104084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:34:24.115039 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:34:24.115039 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:34:24.116044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:24.693630 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:34:24.697122 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:34:24.853926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:34:24.863852 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:34:24.864851 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:34:24.864851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:25.446912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:34:25.453911 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:34:26.074210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C89EA8D0>]}
[0m15:34:26.076233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:26.076799 [info ] [MainThread]: 
[0m15:34:26.081542 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:34:26.081542 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:34:26.083576 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:34:26.083576 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:34:26.094617 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:34:26.095618 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:34:26.084544 => 15:34:26.095618
[0m15:34:26.096583 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:34:26.131168 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:34:26.137164 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:34:26.137164 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
),
total_new_customers AS (
    SELECT
        COUNT(customer_id) AS total_new_customers
    FROM customer_transactions
)

SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months,
    (SELECT total_new_customers FROM total_new_customers) AS total_new_customers
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:34:26.138169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:34:27.253699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:34:27.277667 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:34:26.096583 => 15:34:27.277667
[0m15:34:27.278668 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:34:27.419202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9aaed5-44c0-4b02-ac5b-622e966714e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C8A604A0>]}
[0m15:34:27.434410 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.34s]
[0m15:34:27.438463 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:34:27.445475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:27.447482 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:34:27.447482 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:34:27.448400 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:34:27.448400 [info ] [MainThread]: 
[0m15:34:27.449400 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m15:34:27.450398 [debug] [MainThread]: Command end result
[0m15:34:27.461398 [info ] [MainThread]: 
[0m15:34:27.462401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:27.462401 [info ] [MainThread]: 
[0m15:34:27.463398 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:34:27.464328 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:27.464328 after 5.59 seconds
[0m15:34:27.465369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C655AB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C6A4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C6C6A780>]}
[0m15:34:27.465369 [debug] [MainThread]: Flushing usage events
[0m15:35:09.850377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741BCA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741BCA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741BC9FD0>]}


============================== 15:35:09.855404 | f66b5707-3699-49c1-91e3-f8a1f9b8e40c ==============================
[0m15:35:09.855404 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:35:09.856369 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:35:10.372322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B742526FC0>]}
[0m15:35:10.480470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7436B25D0>]}
[0m15:35:10.482471 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:35:10.492469 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:35:10.587062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:10.588051 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:35:10.747781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:35:10.754117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B743C51FD0>]}
[0m15:35:10.768172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B74397B5C0>]}
[0m15:35:10.768172 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:35:10.769173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B742501250>]}
[0m15:35:10.771172 [info ] [MainThread]: 
[0m15:35:10.772190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:10.773696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:35:10.790705 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:35:10.790705 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:35:10.791704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:11.778040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:35:11.780040 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:35:11.922549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:35:11.934551 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:35:11.934551 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:35:11.935570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:12.480532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:35:12.483038 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:35:12.619990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:35:12.623984 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:35:12.623984 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:35:12.624984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:13.147772 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:35:13.149771 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:35:13.288951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B743B3CE30>]}
[0m15:35:13.289953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:13.289953 [info ] [MainThread]: 
[0m15:35:13.293954 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:35:13.294954 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:35:13.295954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:35:13.295954 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:35:13.305954 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:35:13.307953 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:35:13.296954 => 15:35:13.306953
[0m15:35:13.307953 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:35:13.342988 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:35:13.346953 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:35:13.347983 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:35:13.348953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:14.457538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:35:14.483543 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:35:13.308986 => 15:35:14.482543
[0m15:35:14.483543 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:35:14.621302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b5707-3699-49c1-91e3-f8a1f9b8e40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B743E372C0>]}
[0m15:35:14.622337 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.33s]
[0m15:35:14.623301 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:35:14.625339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:14.625339 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:35:14.626337 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:35:14.626337 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:35:14.627336 [info ] [MainThread]: 
[0m15:35:14.627336 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m15:35:14.629302 [debug] [MainThread]: Command end result
[0m15:35:14.640761 [info ] [MainThread]: 
[0m15:35:14.641413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:14.642421 [info ] [MainThread]: 
[0m15:35:14.642421 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:14.644454 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:14.644454 after 4.89 seconds
[0m15:35:14.644454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B74249B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7414376B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B743B84710>]}
[0m15:35:14.645454 [debug] [MainThread]: Flushing usage events
[0m15:47:13.683097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A86CAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A86CA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A86C9C10>]}


============================== 15:47:13.689097 | 6a9f1993-4dee-4763-9d01-b5705f36c833 ==============================
[0m15:47:13.689097 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:47:13.690096 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:47:14.300789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA2F4440>]}
[0m15:47:14.403380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A73DBE30>]}
[0m15:47:14.405382 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:47:14.433381 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:47:15.806267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:15.807289 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:47:15.969863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:47:15.976129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA3B93A0>]}
[0m15:47:16.015099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA524440>]}
[0m15:47:16.015099 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:47:16.020097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA670440>]}
[0m15:47:16.022097 [info ] [MainThread]: 
[0m15:47:16.029099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:47:16.042115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:47:16.060101 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:47:16.061102 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:47:16.061102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:17.257017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:47:17.263107 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:47:17.414957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:47:17.425955 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:47:17.426957 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:47:17.426957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:17.834497 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:47:17.836500 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:47:17.986761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:47:17.990296 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:47:17.990296 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:47:17.991336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:18.408509 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m15:47:18.415510 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:47:18.567522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA6FC0B0>]}
[0m15:47:18.568525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:18.568525 [info ] [MainThread]: 
[0m15:47:18.572526 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:47:18.573525 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:47:18.574526 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:47:18.574526 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:47:18.585535 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:47:18.587533 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:47:18.575525 => 15:47:18.586533
[0m15:47:18.587533 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:47:18.623646 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:47:18.628645 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:47:18.628645 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Churned if no purchase in the last 12 months
    GROUP BY month
),
previous_month_churn AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_previous_month
    FROM customer_transactions
    WHERE last_purchase_date >= DATEADD(month, -2, CURRENT_DATE)  -- Active in the previous month
    AND last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Not active in the current month
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months,
    COALESCE(pm.churned_customers_previous_month, 0) AS churned_customers_previous_month
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
FULL OUTER JOIN previous_month_churn pm ON n.month = DATEADD(month, 1, pm.month)  -- Join to get churn from the previous month
ORDER BY month;
[0m15:47:18.629645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:19.355775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0009-0001-0878-0000-50e90002cb2e
[0m15:47:19.355775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 68 at position 14 unexpected ';'.
[0m15:47:19.356775 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:47:18.588538 => 15:47:19.355775
[0m15:47:19.356775 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:47:19.547739 [debug] [Thread-1 (]: Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 68 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:47:19.548739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9f1993-4dee-4763-9d01-b5705f36c833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8AA8F08C0>]}
[0m15:47:19.549740 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churn_new_customer ............. [[31mERROR[0m in 0.98s]
[0m15:47:19.550507 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:47:19.554552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:19.554552 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:47:19.554552 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:47:19.555552 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:47:19.555552 [info ] [MainThread]: 
[0m15:47:19.556553 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m15:47:19.558518 [debug] [MainThread]: Command end result
[0m15:47:19.570516 [info ] [MainThread]: 
[0m15:47:19.571652 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:19.572660 [info ] [MainThread]: 
[0m15:47:19.573661 [error] [MainThread]:   Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 68 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:47:19.574464 [info ] [MainThread]: 
[0m15:47:19.575473 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:47:19.576505 [debug] [MainThread]: Command `dbt run` failed at 15:47:19.576505 after 6.01 seconds
[0m15:47:19.576505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A85990A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A86CA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A86CAD50>]}
[0m15:47:19.577506 [debug] [MainThread]: Flushing usage events
[0m15:47:32.970420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017995A2A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017995A2A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017995A29F40>]}


============================== 15:47:32.975459 | 7374fb9b-e776-49a3-b037-5de2ae9e49f5 ==============================
[0m15:47:32.975459 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:47:32.976431 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:47:33.485549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017995A29D30>]}
[0m15:47:33.586171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179975A7C20>]}
[0m15:47:33.588164 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:47:33.596801 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:47:33.707582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:33.708583 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:47:33.862633 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:47:33.868847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179979E5940>]}
[0m15:47:33.881443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017997884560>]}
[0m15:47:33.881443 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:47:33.882467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017994898440>]}
[0m15:47:33.884457 [info ] [MainThread]: 
[0m15:47:33.885433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:47:33.887457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:47:33.904428 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:47:33.905462 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:47:33.905462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:34.848943 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:47:34.850943 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:47:34.996968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:47:35.006002 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:47:35.007002 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:47:35.007002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:35.573645 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:47:35.575645 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:47:35.721478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:47:35.726997 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:47:35.726997 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:47:35.727997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:36.150924 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:47:36.153851 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:47:36.302707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001799771A4E0>]}
[0m15:47:36.304708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:36.305666 [info ] [MainThread]: 
[0m15:47:36.310025 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:47:36.311068 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:47:36.312069 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:47:36.313035 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:47:36.322034 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:47:36.324033 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:47:36.313035 => 15:47:36.324033
[0m15:47:36.325045 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:47:36.360067 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:47:36.364067 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:47:36.364067 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  -- Churned if no purchase in the last 12 months
    GROUP BY month
),
previous_month_churn AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_previous_month
    FROM customer_transactions
    WHERE last_purchase_date >= DATEADD(month, -2, CURRENT_DATE)  -- Active in the previous month
    AND last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  -- Not active in the current month
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months,
    COALESCE(pm.churned_customers_previous_month, 0) AS churned_customers_previous_month
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
FULL OUTER JOIN previous_month_churn pm ON n.month = DATEADD(month, 1, pm.month)  -- Join to get churn from the previous month
ORDER BY month
        );
[0m15:47:36.365068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:37.477688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:47:37.500728 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:47:36.326034 => 15:47:37.500728
[0m15:47:37.501728 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:47:37.646894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7374fb9b-e776-49a3-b037-5de2ae9e49f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179979E43E0>]}
[0m15:47:37.649843 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.33s]
[0m15:47:37.651840 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:47:37.653863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:37.653863 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:47:37.654863 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:47:37.654863 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:47:37.655864 [info ] [MainThread]: 
[0m15:47:37.655864 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m15:47:37.657859 [debug] [MainThread]: Command end result
[0m15:47:37.670829 [info ] [MainThread]: 
[0m15:47:37.671881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:37.672840 [info ] [MainThread]: 
[0m15:47:37.673831 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:47:37.675833 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:37.675833 after 4.79 seconds
[0m15:47:37.675833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017996386F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001799753D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001799567EFF0>]}
[0m15:47:37.676863 [debug] [MainThread]: Flushing usage events
[0m15:50:13.166724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECDD9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECDDA2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECDD8D70>]}


============================== 15:50:13.172759 | 10af919d-0d01-4f57-ad81-1f0b2fb82dc4 ==============================
[0m15:50:13.172759 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:50:13.173724 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m15:50:13.686469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEE9164E0>]}
[0m15:50:13.788087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED6A2390>]}
[0m15:50:13.789088 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:50:13.798090 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:50:13.909611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:13.909611 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:50:14.065868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:50:14.071797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED823560>]}
[0m15:50:14.084816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEEBA3EF0>]}
[0m15:50:14.085796 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:50:14.086764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEE9F5520>]}
[0m15:50:14.087796 [info ] [MainThread]: 
[0m15:50:14.108635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:14.112627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:50:14.128633 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:50:14.128633 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:50:14.129633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:15.240635 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:50:15.241635 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:50:15.397792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:50:15.424163 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:50:15.424163 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:50:15.425164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:16.005584 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:50:16.007585 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:50:16.157020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:50:16.165020 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:50:16.165020 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:50:16.166567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:16.670256 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:50:16.675256 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:50:16.837551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEEE59790>]}
[0m15:50:16.838553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:16.839554 [info ] [MainThread]: 
[0m15:50:16.843552 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:50:16.843552 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:50:16.845554 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:50:16.845554 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:50:16.856588 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:50:16.857586 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:50:16.846558 => 15:50:16.857586
[0m15:50:16.858553 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:50:16.893140 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:50:16.898172 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:50:16.898172 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, DATE_TRUNC('month', CURRENT_DATE))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:50:16.899172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:18.101127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:50:18.125676 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:50:16.858553 => 15:50:18.125676
[0m15:50:18.125676 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:50:18.279120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10af919d-0d01-4f57-ad81-1f0b2fb82dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEEFBB230>]}
[0m15:50:18.282122 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.43s]
[0m15:50:18.286116 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:50:18.294173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:18.294173 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:50:18.294173 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:50:18.295158 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:50:18.295158 [info ] [MainThread]: 
[0m15:50:18.296139 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m15:50:18.297126 [debug] [MainThread]: Command end result
[0m15:50:18.309295 [info ] [MainThread]: 
[0m15:50:18.316660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:18.317620 [info ] [MainThread]: 
[0m15:50:18.317620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:50:18.319653 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:18.319653 after 5.24 seconds
[0m15:50:18.319653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECA8E0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECC9D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BECB8CB60>]}
[0m15:50:18.320653 [debug] [MainThread]: Flushing usage events
[0m15:52:19.082401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001300732A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001300732A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130073287A0>]}


============================== 15:52:19.088414 | 33978355-c8c2-4d5a-84a3-93beddb82fcb ==============================
[0m15:52:19.088414 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:52:19.089375 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:52:19.593461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001300737ADB0>]}
[0m15:52:19.695083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013008E02A50>]}
[0m15:52:19.696666 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:52:19.705295 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:52:19.815924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:19.816917 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:52:19.972130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:52:19.978647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013008F7B6E0>]}
[0m15:52:19.991615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130090F01D0>]}
[0m15:52:19.992616 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:52:19.993156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130092972F0>]}
[0m15:52:19.995196 [info ] [MainThread]: 
[0m15:52:19.996199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:19.998163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:52:20.014164 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:52:20.014164 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:52:20.015166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:21.176340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:52:21.182339 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:52:21.362847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:52:21.374458 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:52:21.374458 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:52:21.375459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:21.960789 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:52:21.962758 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:52:22.117057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:52:22.125057 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:52:22.127058 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:52:22.128058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:22.688373 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:52:22.695373 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:52:22.856185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001300904A7E0>]}
[0m15:52:22.859309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:22.862255 [info ] [MainThread]: 
[0m15:52:22.871252 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:52:22.872853 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:52:22.874909 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:52:22.875869 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:52:22.884863 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:52:22.886864 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:52:22.876909 => 15:52:22.886864
[0m15:52:22.887863 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:52:22.923861 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:52:22.927898 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:52:22.928896 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    ) AS transactions
    GROUP BY customer_id
),
date_range AS (
    SELECT
        MIN(DATE_TRUNC('month', first_purchase_date)) AS start_date,
        MAX(DATE_TRUNC('month', last_purchase_date)) AS end_date
    FROM customer_transactions
),
all_months AS (
    SELECT
        DATE_TRUNC('month', start_date + INTERVAL '1 month' * generate_series(0, (EXTRACT(YEAR FROM end_date) - EXTRACT(YEAR FROM start_date)) * 12 + EXTRACT(MONTH FROM end_date) - EXTRACT(MONTH FROM start_date)))::int) AS month
    FROM date_range
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  
    GROUP BY month
)
SELECT
    am.month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM all_months am
LEFT JOIN monthly_customers n ON am.month = n.month
LEFT JOIN churned_customers c1 ON am.month = c1.month
LEFT JOIN churned_customers_3_months c3 ON am.month = c3.month
LEFT JOIN churned_customers_12_months c12 ON am.month = c12.month
ORDER BY am.month
        );
[0m15:52:22.929898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:23.334459 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000e-0001-086e-0000-50e9000303c6
[0m15:52:23.335458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 220 unexpected 'AS'.
syntax error line 26 at position 1 unexpected ','.
[0m15:52:23.336458 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:52:22.887863 => 15:52:23.336458
[0m15:52:23.337458 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:52:23.489428 [debug] [Thread-1 (]: Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 220 unexpected 'AS'.
  syntax error line 26 at position 1 unexpected ','.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:52:23.490429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33978355-c8c2-4d5a-84a3-93beddb82fcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130094E6810>]}
[0m15:52:23.491428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churn_new_customer ............. [[31mERROR[0m in 0.62s]
[0m15:52:23.493392 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:52:23.497234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:23.497234 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:52:23.498234 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:52:23.499234 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:52:23.499234 [info ] [MainThread]: 
[0m15:52:23.500473 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m15:52:23.502522 [debug] [MainThread]: Command end result
[0m15:52:23.515490 [info ] [MainThread]: 
[0m15:52:23.516480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:23.516480 [info ] [MainThread]: 
[0m15:52:23.517483 [error] [MainThread]:   Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 220 unexpected 'AS'.
  syntax error line 26 at position 1 unexpected ','.
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:52:23.518487 [info ] [MainThread]: 
[0m15:52:23.519513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:52:23.521482 [debug] [MainThread]: Command `dbt run` failed at 15:52:23.520517 after 4.53 seconds
[0m15:52:23.521482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013006EB1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130092AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001300936F0B0>]}
[0m15:52:23.522515 [debug] [MainThread]: Flushing usage events
[0m15:53:21.296006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5CAFA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5CAF9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5CAF86E0>]}


============================== 15:53:21.301200 | 2a6923ee-fb4b-42b3-ab79-f055bed2d501 ==============================
[0m15:53:21.301200 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:53:21.302171 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m churn_new_customer', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:53:21.811473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5E6437D0>]}
[0m15:53:21.911094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5E6437D0>]}
[0m15:53:21.913287 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:53:21.921906 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:53:22.034529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:22.034529 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:53:22.187438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:53:22.193983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5E641C40>]}
[0m15:53:22.207542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5E87FF20>]}
[0m15:53:22.207542 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:53:22.208532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5C6B9F10>]}
[0m15:53:22.210571 [info ] [MainThread]: 
[0m15:53:22.212560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:22.214532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:53:22.229566 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:53:22.230532 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:53:22.230532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:23.199536 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:53:23.205602 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:53:23.358124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:53:23.380120 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:53:23.381123 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:53:23.381123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:23.942436 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.0 seconds
[0m15:53:23.945371 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:53:24.092270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:53:24.103235 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:53:24.103235 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:53:24.103235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:24.661625 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:53:24.668678 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:53:24.818077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5E78AF00>]}
[0m15:53:24.822075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:24.824934 [info ] [MainThread]: 
[0m15:53:24.837495 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:53:24.838481 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:53:24.840472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.churn_new_customer'
[0m15:53:24.840472 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:53:24.851471 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:53:24.853478 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:53:24.841512 => 15:53:24.853478
[0m15:53:24.854510 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:53:24.889504 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:53:24.893505 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:53:24.893505 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    ) AS transactions
    GROUP BY customer_id
),
date_range AS (
    SELECT
        MIN(DATE_TRUNC('month', first_purchase_date)) AS start_date,
        MAX(DATE_TRUNC('month', last_purchase_date)) AS end_date
    FROM customer_transactions
),
all_months AS (
    SELECT
        DATE_TRUNC('month', start_date + INTERVAL '1 month' * generate_series(0, (EXTRACT(YEAR FROM end_date) - EXTRACT(YEAR FROM start_date)) * 12 + EXTRACT(MONTH FROM end_date) - EXTRACT(MONTH FROM start_date)))::int AS month
    FROM date_range
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, CURRENT_DATE)  
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, CURRENT_DATE)  
    GROUP BY month
)
SELECT
    am.month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM all_months am
LEFT JOIN monthly_customers n ON am.month = n.month
LEFT JOIN churned_customers c1 ON am.month = c1.month
LEFT JOIN churned_customers_3_months c3 ON am.month = c3.month
LEFT JOIN churned_customers_12_months c12 ON am.month = c12.month
ORDER BY am.month
        );
[0m15:53:24.894508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:25.390892 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000f-0001-085a-0000-50e90002f43a
[0m15:53:25.392893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function GENERATE_SERIES
[0m15:53:25.393835 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:53:24.854510 => 15:53:25.393835
[0m15:53:25.394871 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:53:25.554125 [debug] [Thread-1 (]: Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  002140 (42601): SQL compilation error:
  Unknown function GENERATE_SERIES
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:53:25.556127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a6923ee-fb4b-42b3-ab79-f055bed2d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5EB898E0>]}
[0m15:53:25.557133 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.churn_new_customer ............. [[31mERROR[0m in 0.72s]
[0m15:53:25.560110 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:53:25.564181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:25.565181 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:53:25.566181 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:53:25.566181 [debug] [MainThread]: Connection 'model.mini_project_dbt.churn_new_customer' was properly closed.
[0m15:53:25.567182 [info ] [MainThread]: 
[0m15:53:25.568186 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m15:53:25.570181 [debug] [MainThread]: Command end result
[0m15:53:25.583141 [info ] [MainThread]: 
[0m15:53:25.584138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:25.585192 [info ] [MainThread]: 
[0m15:53:25.586150 [error] [MainThread]:   Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  002140 (42601): SQL compilation error:
  Unknown function GENERATE_SERIES
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:53:25.587148 [info ] [MainThread]: 
[0m15:53:25.588137 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:25.589147 [debug] [MainThread]: Command `dbt run` failed at 15:53:25.589147 after 4.38 seconds
[0m15:53:25.590174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5B8E13A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5C710170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D5C9D7AA0>]}
[0m15:53:25.590174 [debug] [MainThread]: Flushing usage events
[0m15:55:33.446532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C77B48EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C77B49A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C77B482C0>]}


============================== 15:55:33.452438 | 5a1b0ff3-afb0-42a6-a1a8-3b059353d526 ==============================
[0m15:55:33.452438 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:55:33.453405 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:55:34.020564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C796DF080>]}
[0m15:55:34.120185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C78467BC0>]}
[0m15:55:34.122376 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:55:34.142985 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:55:35.349089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:55:35.349089 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m15:55:35.350089 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:55:35.505213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:55:35.511210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79620260>]}
[0m15:55:35.538670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79908140>]}
[0m15:55:35.539691 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:55:35.540656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C796D06E0>]}
[0m15:55:35.542656 [info ] [MainThread]: 
[0m15:55:35.543656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:55:35.545679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:55:35.561733 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:55:35.562685 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:55:35.562685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:36.539132 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:55:36.541126 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:55:36.693841 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:55:36.694842 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:55:36.696843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:37.255637 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:55:37.257639 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:55:37.406996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m15:55:37.416004 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:55:37.417005 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:55:37.417005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:37.986593 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:55:37.989562 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:55:38.135069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m15:55:38.139069 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:55:38.139069 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:55:38.140069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:38.591714 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.0 seconds
[0m15:55:38.595677 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:55:38.751071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79909D90>]}
[0m15:55:38.752111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:38.752575 [info ] [MainThread]: 
[0m15:55:38.756460 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:55:38.757485 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.staging_country_region_table .............. [RUN]
[0m15:55:38.758459 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:55:38.759488 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:55:38.772061 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:55:38.773060 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:55:38.759488 => 15:55:38.773060
[0m15:55:38.774035 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:55:38.807061 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:55:38.809026 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:55:38.809026 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:55:38.810058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:40.004677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:40.028701 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:55:38.774035 => 15:55:40.028701
[0m15:55:40.028701 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:55:40.175969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D481D0>]}
[0m15:55:40.177964 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.staging_country_region_table ......... [[32mSUCCESS 1[0m in 1.42s]
[0m15:55:40.181969 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:55:40.184963 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:55:40.186963 [info ] [Thread-1 (]: 2 of 8 START sql table model staging.staging_customers_table ................... [RUN]
[0m15:55:40.189917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:55:40.191918 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:55:40.198900 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:55:40.200904 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:55:40.192955 => 15:55:40.199924
[0m15:55:40.200904 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:55:40.204935 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:55:40.206933 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:55:40.206933 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:55:40.207937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:41.172492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:41.176541 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:55:40.201933 => 15:55:41.176541
[0m15:55:41.176541 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:55:41.319004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D48050>]}
[0m15:55:41.319004 [info ] [Thread-1 (]: 2 of 8 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 1.13s]
[0m15:55:41.321037 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:55:41.321037 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:55:41.322039 [info ] [Thread-1 (]: 3 of 8 START sql table model staging.staging_products_table .................... [RUN]
[0m15:55:41.323038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:55:41.323038 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:55:41.377091 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:55:41.378089 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:55:41.323038 => 15:55:41.378089
[0m15:55:41.379630 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:55:41.382667 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:55:41.384678 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:55:41.384678 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:55:41.385672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:42.462926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:42.466890 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:55:41.379630 => 15:55:42.466890
[0m15:55:42.466890 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:55:42.613338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D4B0E0>]}
[0m15:55:42.616343 [info ] [Thread-1 (]: 3 of 8 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.29s]
[0m15:55:42.619574 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:55:42.621538 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:55:42.623570 [info ] [Thread-1 (]: 4 of 8 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:55:42.626510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:55:42.628512 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:55:42.638506 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:55:42.640505 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:55:42.629550 => 15:55:42.639504
[0m15:55:42.640505 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:55:42.643502 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:55:42.645502 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:55:42.646502 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(SUBSTR(payment_month, 1, 10), 'YYYY-DD-MM') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:55:42.646502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:43.505947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:43.509940 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:55:42.641502 => 15:55:43.508940
[0m15:55:43.509940 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:55:43.649619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79A7C260>]}
[0m15:55:43.650619 [info ] [Thread-1 (]: 4 of 8 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 1.02s]
[0m15:55:43.651586 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:55:43.653582 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:55:43.653582 [info ] [Thread-1 (]: 5 of 8 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:55:43.655612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:55:43.655612 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:55:43.659620 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:55:43.661582 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:55:43.655612 => 15:55:43.660618
[0m15:55:43.661582 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:55:43.665618 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:55:43.669583 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:55:43.669583 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, DATE_TRUNC('month', CURRENT_DATE)) 
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, DATE_TRUNC('month', CURRENT_DATE)) 
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, DATE_TRUNC('month', CURRENT_DATE)) 
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:55:43.670586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:44.295848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0011-0001-085a-0000-50e90002f446
[0m15:55:44.295848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[CUSTOMER_TRANSACTIONS.LAST_PURCHASE_DATE] is not a valid group by expression
[0m15:55:44.296847 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:55:43.662618 => 15:55:44.296847
[0m15:55:44.296847 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:55:44.455311 [debug] [Thread-1 (]: Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_TRANSACTIONS.LAST_PURCHASE_DATE] is not a valid group by expression
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:55:44.456313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79CBFC80>]}
[0m15:55:44.456313 [error] [Thread-1 (]: 5 of 8 ERROR creating sql table model transform.churn_new_customer ............. [[31mERROR[0m in 0.80s]
[0m15:55:44.458310 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:55:44.458310 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m15:55:44.459277 [info ] [Thread-1 (]: 6 of 8 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m15:55:44.460407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.cross_sell_product_churn)
[0m15:55:44.461414 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m15:55:44.464414 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m15:55:44.465413 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 15:55:44.461414 => 15:55:44.465413
[0m15:55:44.465413 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m15:55:44.469415 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m15:55:44.472447 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m15:55:44.472447 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
recent_product_churn AS (
    SELECT
        customer_id,
        product_id
    FROM customer_product_sales
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC
        );
[0m15:55:44.473447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:45.390261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:45.394253 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 15:55:44.466415 => 15:55:45.393254
[0m15:55:45.394253 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m15:55:45.542179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D3A000>]}
[0m15:55:45.544183 [info ] [Thread-1 (]: 6 of 8 OK created sql table model transform.cross_sell_product_churn ........... [[32mSUCCESS 1[0m in 1.08s]
[0m15:55:45.547211 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m15:55:45.548210 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:55:45.550211 [info ] [Thread-1 (]: 7 of 8 START sql table model transform.customer_revenue_ranking ................ [RUN]
[0m15:55:45.552218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_product_churn, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:55:45.554217 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:55:45.561237 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:55:45.563254 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:55:45.555256 => 15:55:45.562203
[0m15:55:45.563254 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:55:45.568235 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:55:45.569238 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:55:45.570243 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:55:45.571240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:46.425317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:46.430314 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:55:45.564235 => 15:55:46.430314
[0m15:55:46.431314 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:55:46.573581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D87B30>]}
[0m15:55:46.576640 [info ] [Thread-1 (]: 7 of 8 OK created sql table model transform.customer_revenue_ranking ........... [[32mSUCCESS 1[0m in 1.02s]
[0m15:55:46.580640 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:55:46.582642 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:55:46.585646 [info ] [Thread-1 (]: 8 of 8 START sql table model transform.product_revenue_ranking ................. [RUN]
[0m15:55:46.589673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:55:46.590709 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:55:46.599699 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:55:46.601252 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:55:46.591708 => 15:55:46.601252
[0m15:55:46.602265 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:55:46.607265 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:55:46.609264 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:55:46.610296 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:55:46.610296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:47.469759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:47.473754 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:55:46.603302 => 15:55:47.473754
[0m15:55:47.474745 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:55:47.619056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a1b0ff3-afb0-42a6-a1a8-3b059353d526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79D87320>]}
[0m15:55:47.622057 [info ] [Thread-1 (]: 8 of 8 OK created sql table model transform.product_revenue_ranking ............ [[32mSUCCESS 1[0m in 1.03s]
[0m15:55:47.626005 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:55:47.634060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:47.635006 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:55:47.635006 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m15:55:47.636002 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:55:47.636002 [info ] [MainThread]: 
[0m15:55:47.636986 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m15:55:47.639989 [debug] [MainThread]: Command end result
[0m15:55:47.650925 [info ] [MainThread]: 
[0m15:55:47.650925 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:55:47.651902 [info ] [MainThread]: 
[0m15:55:47.652926 [error] [MainThread]:   Database Error in model churn_new_customer (models\transform\churn_new_customer.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_TRANSACTIONS.LAST_PURCHASE_DATE] is not a valid group by expression
  compiled Code at target\run\mini_project_dbt\models\transform\churn_new_customer.sql
[0m15:55:47.653828 [info ] [MainThread]: 
[0m15:55:47.654836 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:55:47.655836 [debug] [MainThread]: Command `dbt run` failed at 15:55:47.655836 after 14.32 seconds
[0m15:55:47.656876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7787CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C77B21340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C77B226C0>]}
[0m15:55:47.657838 [debug] [MainThread]: Flushing usage events
[0m15:57:28.385009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6AB69B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6AB69CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6AB68920>]}


============================== 15:57:28.391009 | eef29352-5477-4b4a-a304-ab08aa755870 ==============================
[0m15:57:28.391009 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:57:28.391937 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m15:57:28.892672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6A49A2A0>]}
[0m15:57:28.993292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6B3EBBC0>]}
[0m15:57:28.995334 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:57:29.004998 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:57:29.115011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:29.116014 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m15:57:29.268722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m15:57:29.275154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6C8CAE40>]}
[0m15:57:29.287174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6C994290>]}
[0m15:57:29.287174 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:57:29.288160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6AB3A480>]}
[0m15:57:29.291123 [info ] [MainThread]: 
[0m15:57:29.293583 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:29.295084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m15:57:29.311147 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:57:29.312146 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:57:29.312146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:30.374664 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:57:30.380662 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:57:30.541897 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m15:57:30.541897 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m15:57:30.542863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:31.082456 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:57:31.085443 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m15:57:31.242123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m15:57:31.252647 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m15:57:31.253647 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m15:57:31.253647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:31.685327 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.0 seconds
[0m15:57:31.687326 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m15:57:31.839597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m15:57:31.852258 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m15:57:31.853257 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m15:57:31.854260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:32.440896 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:57:32.441931 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m15:57:32.587697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CADEEA0>]}
[0m15:57:32.588698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:32.589665 [info ] [MainThread]: 
[0m15:57:32.592999 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m15:57:32.594024 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.staging_country_region_table .............. [RUN]
[0m15:57:32.595017 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m15:57:32.596026 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m15:57:32.608032 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m15:57:32.609998 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 15:57:32.596026 => 15:57:32.609032
[0m15:57:32.611001 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m15:57:32.644656 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_country_region_table"
[0m15:57:32.647615 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_country_region_table"
[0m15:57:32.647615 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_country_region_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_country_region_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        raw_data.public.COUNTRY_REGION_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)
SELECT
    *
FROM
    source
        );
[0m15:57:32.648616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:34.134102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:34.177790 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 15:57:32.611001 => 15:57:34.177790
[0m15:57:34.178789 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_country_region_table: Close
[0m15:57:34.319118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CBF9E80>]}
[0m15:57:34.320114 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.staging_country_region_table ......... [[32mSUCCESS 1[0m in 1.72s]
[0m15:57:34.321080 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m15:57:34.322114 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m15:57:34.322797 [info ] [Thread-1 (]: 2 of 8 START sql table model staging.staging_customers_table ................... [RUN]
[0m15:57:34.341218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m15:57:34.341218 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m15:57:34.345219 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m15:57:34.347183 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 15:57:34.342213 => 15:57:34.346180
[0m15:57:34.348220 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m15:57:34.351765 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_customers_table"
[0m15:57:34.352765 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_customers_table"
[0m15:57:34.353769 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_customers_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_customers_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(CUSTOMER_ID AS INT)        AS customer_id,
        CAST(CUSTOMERNAME AS STRING)    AS customer_name,
        COMPANY                         AS company
    FROM raw_data.public.CUSTOMERS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:57:34.353769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:35.180366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:35.184365 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 15:57:34.348220 => 15:57:35.184365
[0m15:57:35.184365 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_customers_table: Close
[0m15:57:35.330098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CD8E3C0>]}
[0m15:57:35.333103 [info ] [Thread-1 (]: 2 of 8 OK created sql table model staging.staging_customers_table .............. [[32mSUCCESS 1[0m in 0.99s]
[0m15:57:35.337156 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m15:57:35.339237 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m15:57:35.340236 [info ] [Thread-1 (]: 3 of 8 START sql table model staging.staging_products_table .................... [RUN]
[0m15:57:35.342199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m15:57:35.342199 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m15:57:35.396761 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m15:57:35.398728 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 15:57:35.342199 => 15:57:35.397761
[0m15:57:35.398728 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m15:57:35.401763 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_products_table"
[0m15:57:35.403763 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_products_table"
[0m15:57:35.403763 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_products_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_products_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        PRODUCT_ID,
        PRODUCT_FAMILY,
        PRODUCT_SUB_FAMILY
    FROM raw_data.public.PRODUCTS_TABLE
    WHERE
        
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        PRODUCT_FAMILY IS NOT NULL
         AND 
    
        PRODUCT_SUB_FAMILY IS NOT NULL
        
    

)
SELECT * FROM source
        );
[0m15:57:35.403763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:36.370876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:36.373838 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 15:57:35.398728 => 15:57:36.373838
[0m15:57:36.373838 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_products_table: Close
[0m15:57:36.519082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CDAE900>]}
[0m15:57:36.522079 [info ] [Thread-1 (]: 3 of 8 OK created sql table model staging.staging_products_table ............... [[32mSUCCESS 1[0m in 1.18s]
[0m15:57:36.526082 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m15:57:36.528079 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m15:57:36.530073 [info ] [Thread-1 (]: 4 of 8 START sql table model staging.staging_transactions_table ................ [RUN]
[0m15:57:36.533068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m15:57:36.534043 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m15:57:36.542054 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m15:57:36.544015 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 15:57:36.535057 => 15:57:36.544015
[0m15:57:36.545049 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m15:57:36.549013 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.staging_transactions_table"
[0m15:57:36.552047 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.staging_transactions_table"
[0m15:57:36.552047 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.staging_transactions_table"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
         as
        (
WITH source AS (
    SELECT
        DISTINCT
        CAST(customer_id AS INT)        AS customer_id,
        PRODUCT_ID,
        TO_DATE(SUBSTR(payment_month, 1, 10), 'YYYY-DD-MM') AS transaction_date,
        CAST(REVENUE_TYPE AS INT)       AS revenue_type,
        CAST(REVENUE AS FLOAT)          AS revenue,
        CAST(QUANTITY AS INT)           AS quantity,
        COMPANIES
    FROM raw_data.public.TRANSACTIONS_TABLE
    WHERE
        
    
        customer_id IS NOT NULL
         AND 
    
        PRODUCT_ID IS NOT NULL
         AND 
    
        transaction_date IS NOT NULL
         AND 
    
        revenue_type IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        COMPANIES IS NOT NULL
        
    

)
SELECT * FROM source WHERE revenue_type = 1
        );
[0m15:57:36.553046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:37.342297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:37.345263 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 15:57:36.545049 => 15:57:37.345263
[0m15:57:37.345263 [debug] [Thread-1 (]: On model.mini_project_dbt.staging_transactions_table: Close
[0m15:57:37.489583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6C9DFC50>]}
[0m15:57:37.492522 [info ] [Thread-1 (]: 4 of 8 OK created sql table model staging.staging_transactions_table ........... [[32mSUCCESS 1[0m in 0.96s]
[0m15:57:37.496582 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m15:57:37.500722 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m15:57:37.502722 [info ] [Thread-1 (]: 5 of 8 START sql table model transform.churn_new_customer ...................... [RUN]
[0m15:57:37.506670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m15:57:37.508661 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m15:57:37.522703 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m15:57:37.524657 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 15:57:37.510722 => 15:57:37.524657
[0m15:57:37.525660 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m15:57:37.531655 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.churn_new_customer"
[0m15:57:37.537689 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.churn_new_customer"
[0m15:57:37.537689 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.churn_new_customer"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.churn_new_customer
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date,
        MAX(transaction_date) AS last_purchase_date
    FROM (
        SELECT
            customer_id,
            transaction_date
        FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    ) AS transactions
    GROUP BY customer_id
),
max_transaction_date AS (
    SELECT MAX(transaction_date) AS max_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
),
monthly_customers AS (
    SELECT
        DATE_TRUNC('month', first_purchase_date) AS month,
        COUNT(customer_id) AS new_customers
    FROM customer_transactions
    GROUP BY month
),
churned_customers AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_1_month
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -1, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 1 month
    GROUP BY month
),
churned_customers_3_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_3_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -3, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 3 months
    GROUP BY month
),
churned_customers_12_months AS (
    SELECT
        DATE_TRUNC('month', last_purchase_date) AS month,
        COUNT(customer_id) AS churned_customers_12_months
    FROM customer_transactions
    WHERE last_purchase_date < DATEADD(month, -12, (SELECT max_date FROM max_transaction_date))  -- Churned if no purchase in the last 12 months
    GROUP BY month
)
SELECT
    COALESCE(n.month, c1.month, c3.month, c12.month) AS month,
    COALESCE(n.new_customers, 0) AS new_customers,
    COALESCE(c1.churned_customers_1_month, 0) AS churned_customers_1_month,
    COALESCE(c3.churned_customers_3_months, 0) AS churned_customers_3_months,
    COALESCE(c12.churned_customers_12_months, 0) AS churned_customers_12_months
FROM monthly_customers n
FULL OUTER JOIN churned_customers c1 ON n.month = c1.month
FULL OUTER JOIN churned_customers_3_months c3 ON n.month = c3.month
FULL OUTER JOIN churned_customers_12_months c12 ON n.month = c12.month
ORDER BY month
        );
[0m15:57:37.538689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:38.584854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:38.587815 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 15:57:37.526701 => 15:57:38.587815
[0m15:57:38.588817 [debug] [Thread-1 (]: On model.mini_project_dbt.churn_new_customer: Close
[0m15:57:38.747173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CDC5760>]}
[0m15:57:38.750173 [info ] [Thread-1 (]: 5 of 8 OK created sql table model transform.churn_new_customer ................. [[32mSUCCESS 1[0m in 1.24s]
[0m15:57:38.754174 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m15:57:38.756179 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m15:57:38.759423 [info ] [Thread-1 (]: 6 of 8 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m15:57:38.761536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.cross_sell_product_churn)
[0m15:57:38.763600 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m15:57:38.770550 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m15:57:38.772565 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 15:57:38.764600 => 15:57:38.772565
[0m15:57:38.773580 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m15:57:38.775579 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m15:57:38.779159 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m15:57:38.779159 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
recent_product_churn AS (
    SELECT
        customer_id,
        product_id
    FROM customer_product_sales
    WHERE last_purchase_date < DATEADD(month, -3, CURRENT_DATE)  -- Assuming churn if no purchase in the last 3 months
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC
        );
[0m15:57:38.780157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:39.713453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:39.724452 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 15:57:38.773580 => 15:57:39.723451
[0m15:57:39.726453 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m15:57:39.869891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CAA46B0>]}
[0m15:57:39.870893 [info ] [Thread-1 (]: 6 of 8 OK created sql table model transform.cross_sell_product_churn ........... [[32mSUCCESS 1[0m in 1.11s]
[0m15:57:39.871852 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m15:57:39.872890 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m15:57:39.873890 [info ] [Thread-1 (]: 7 of 8 START sql table model transform.customer_revenue_ranking ................ [RUN]
[0m15:57:39.875890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_product_churn, now model.mini_project_dbt.customer_revenue_ranking)
[0m15:57:39.876890 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m15:57:39.881891 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:57:39.883495 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 15:57:39.876890 => 15:57:39.883495
[0m15:57:39.884457 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m15:57:39.890489 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.customer_revenue_ranking"
[0m15:57:39.893490 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.customer_revenue_ranking"
[0m15:57:39.893490 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.customer_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.customer_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    customer_id,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS customer_rank
FROM transactions
GROUP BY customer_id
        );
[0m15:57:39.894487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:40.802939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:40.805936 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 15:57:39.884457 => 15:57:40.804936
[0m15:57:40.805936 [debug] [Thread-1 (]: On model.mini_project_dbt.customer_revenue_ranking: Close
[0m15:57:40.954016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CD48DA0>]}
[0m15:57:40.957014 [info ] [Thread-1 (]: 7 of 8 OK created sql table model transform.customer_revenue_ranking ........... [[32mSUCCESS 1[0m in 1.08s]
[0m15:57:40.961018 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m15:57:40.963014 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m15:57:40.966014 [info ] [Thread-1 (]: 8 of 8 START sql table model transform.product_revenue_ranking ................. [RUN]
[0m15:57:40.969005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.product_revenue_ranking)
[0m15:57:40.970004 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m15:57:40.978019 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:57:40.980069 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 15:57:40.970999 => 15:57:40.979059
[0m15:57:40.981058 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m15:57:40.985018 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.product_revenue_ranking"
[0m15:57:40.987531 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.product_revenue_ranking"
[0m15:57:40.988544 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.product_revenue_ranking"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.product_revenue_ranking
         as
        (
WITH transactions AS (
    SELECT * FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
)
SELECT
    PRODUCT_ID,
    SUM(revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(revenue) DESC) AS product_rank
FROM transactions
GROUP BY PRODUCT_ID
        );
[0m15:57:40.988544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:42.015928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:42.025922 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 15:57:40.981058 => 15:57:42.024920
[0m15:57:42.026920 [debug] [Thread-1 (]: On model.mini_project_dbt.product_revenue_ranking: Close
[0m15:57:42.175581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef29352-5477-4b4a-a304-ab08aa755870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6CD48410>]}
[0m15:57:42.178666 [info ] [Thread-1 (]: 8 of 8 OK created sql table model transform.product_revenue_ranking ............ [[32mSUCCESS 1[0m in 1.21s]
[0m15:57:42.182666 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m15:57:42.190608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:42.190608 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m15:57:42.192118 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m15:57:42.192118 [debug] [MainThread]: Connection 'model.mini_project_dbt.product_revenue_ranking' was properly closed.
[0m15:57:42.193126 [info ] [MainThread]: 
[0m15:57:42.194128 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 12.90 seconds (12.90s).
[0m15:57:42.196126 [debug] [MainThread]: Command end result
[0m15:57:42.208127 [info ] [MainThread]: 
[0m15:57:42.209359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:42.210373 [info ] [MainThread]: 
[0m15:57:42.211374 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:57:42.212382 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:42.212382 after 13.91 seconds
[0m15:57:42.213401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6AF32030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA69782300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6A7B74A0>]}
[0m15:57:42.213401 [debug] [MainThread]: Flushing usage events
[0m16:02:54.917903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420E991C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420E9A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420E99EE0>]}


============================== 16:02:54.929123 | 43323a1b-bcd1-42b0-8e61-0c840c62dd5b ==============================
[0m16:02:54.929123 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:02:54.931124 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m cross_sell_product_churn', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:02:55.733889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B42178FD40>]}
[0m16:02:55.835317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420C6D8E0>]}
[0m16:02:55.837167 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:02:55.852231 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:02:55.985263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:55.986263 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:02:56.144360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:02:56.150668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422B1A210>]}
[0m16:02:56.163216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422CB49B0>]}
[0m16:02:56.164244 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:02:56.165218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422E18EC0>]}
[0m16:02:56.168236 [info ] [MainThread]: 
[0m16:02:56.170250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:56.171400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:02:56.187406 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:02:56.188407 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:02:56.188407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:57.591926 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:02:57.598925 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:02:57.765949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m16:02:57.780996 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:02:57.780996 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:02:57.781995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:58.666938 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:02:58.674013 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:02:58.829042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m16:02:58.833077 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:02:58.833077 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:02:58.834077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:59.248936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:02:59.251937 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:02:59.674790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422F8D670>]}
[0m16:02:59.675826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:59.675826 [info ] [MainThread]: 
[0m16:02:59.687883 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m16:02:59.688883 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m16:02:59.689905 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.cross_sell_product_churn'
[0m16:02:59.689905 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m16:02:59.700454 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:02:59.702420 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 16:02:59.691413 => 16:02:59.701454
[0m16:02:59.702420 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m16:02:59.739455 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:02:59.742456 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m16:02:59.743422 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
previous_month_end AS (
    SELECT DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 day' AS end_date
),
recent_product_churn AS (
    SELECT
        cps.customer_id,
        cps.product_id
    FROM customer_product_sales cps
    CROSS JOIN previous_month_end pme
    WHERE cps.last_purchase_date < pme.end_date  -- Churn if no purchase in the previous month
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC;
[0m16:02:59.744461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:00.336800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0019-0001-086e-0000-50e90003044e
[0m16:03:00.336800 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 67 unexpected ';'.
[0m16:03:00.337836 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 16:02:59.703421 => 16:03:00.337836
[0m16:03:00.338831 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m16:03:00.496052 [debug] [Thread-1 (]: Database Error in model cross_sell_product_churn (models\transform\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 67 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\cross_sell_product_churn.sql
[0m16:03:00.496052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43323a1b-bcd1-42b0-8e61-0c840c62dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422E97200>]}
[0m16:03:00.497053 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.cross_sell_product_churn ....... [[31mERROR[0m in 0.81s]
[0m16:03:00.497983 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m16:03:00.501359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:00.501359 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:03:00.501359 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m16:03:00.502358 [debug] [MainThread]: Connection 'model.mini_project_dbt.cross_sell_product_churn' was properly closed.
[0m16:03:00.502358 [info ] [MainThread]: 
[0m16:03:00.503326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m16:03:00.504326 [debug] [MainThread]: Command end result
[0m16:03:00.516375 [info ] [MainThread]: 
[0m16:03:00.517325 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:00.518325 [info ] [MainThread]: 
[0m16:03:00.518325 [error] [MainThread]:   Database Error in model cross_sell_product_churn (models\transform\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 67 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\cross_sell_product_churn.sql
[0m16:03:00.519325 [info ] [MainThread]: 
[0m16:03:00.520326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:00.522326 [debug] [MainThread]: Command `dbt run` failed at 16:03:00.521326 after 5.69 seconds
[0m16:03:00.522326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420A5D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420E6A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B420E6AD80>]}
[0m16:03:00.523324 [debug] [MainThread]: Flushing usage events
[0m16:03:09.643953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C41669760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4166A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4166A8D0>]}


============================== 16:03:09.649371 | 7e290d86-526a-4cc1-b7e2-d16af98508a5 ==============================
[0m16:03:09.649371 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:03:09.650341 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m cross_sell_product_churn', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:03:10.157622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C420D3F80>]}
[0m16:03:10.257244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C41699D30>]}
[0m16:03:10.259020 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:03:10.267652 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:03:10.376787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:10.377788 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:03:10.532922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:03:10.539389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C431A18E0>]}
[0m16:03:10.549885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C43433CE0>]}
[0m16:03:10.550886 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:03:10.551886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4357EA50>]}
[0m16:03:10.553924 [info ] [MainThread]: 
[0m16:03:10.554888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:10.556922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:03:10.572884 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:03:10.573886 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:03:10.574886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:11.216440 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:03:11.218448 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:03:11.364548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m16:03:11.386546 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:03:11.386546 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:03:11.387546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:12.349220 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:03:12.352188 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:03:12.495692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m16:03:12.506758 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:03:12.507718 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:03:12.508718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:13.060972 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:03:13.062970 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:03:13.207762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C435E7A70>]}
[0m16:03:13.208762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:13.209762 [info ] [MainThread]: 
[0m16:03:13.213764 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m16:03:13.214798 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m16:03:13.215799 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.cross_sell_product_churn'
[0m16:03:13.216763 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m16:03:13.225763 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:03:13.227762 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 16:03:13.216763 => 16:03:13.226795
[0m16:03:13.227762 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m16:03:13.263319 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:03:13.265318 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m16:03:13.266319 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
previous_month_end AS (
    SELECT DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 day' AS end_date
),
recent_product_churn AS (
    SELECT
        cps.customer_id,
        cps.product_id
    FROM customer_product_sales cps
    CROSS JOIN previous_month_end pme
    WHERE cps.last_purchase_date < pme.end_date  -- Churn if no purchase in the previous month
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC
        );
[0m16:03:13.266319 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:14.328598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:03:14.354192 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 16:03:13.228796 => 16:03:14.354192
[0m16:03:14.354192 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m16:03:14.498789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e290d86-526a-4cc1-b7e2-d16af98508a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4389A090>]}
[0m16:03:14.500836 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.cross_sell_product_churn ........... [[32mSUCCESS 1[0m in 1.28s]
[0m16:03:14.505835 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m16:03:14.512835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:14.514802 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:03:14.515843 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m16:03:14.516838 [debug] [MainThread]: Connection 'model.mini_project_dbt.cross_sell_product_churn' was properly closed.
[0m16:03:14.518837 [info ] [MainThread]: 
[0m16:03:14.519778 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m16:03:14.522780 [debug] [MainThread]: Command end result
[0m16:03:14.540041 [info ] [MainThread]: 
[0m16:03:14.540713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:14.541723 [info ] [MainThread]: 
[0m16:03:14.542722 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:14.543749 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:14.543749 after 4.99 seconds
[0m16:03:14.543749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4163AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4163A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C436CA660>]}
[0m16:03:14.544745 [debug] [MainThread]: Flushing usage events
[0m16:04:42.668047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214504BA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214504BA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214504B9CD0>]}


============================== 16:04:42.674850 | 197bd94c-02b6-4df8-bf04-957f388a1db9 ==============================
[0m16:04:42.674850 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:04:42.675850 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m cross_sell_product_churn', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:04:43.208498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021451FEF2F0>]}
[0m16:04:43.313130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021452025550>]}
[0m16:04:43.314201 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:04:43.324174 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:04:43.434838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:43.435846 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:04:43.602400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:04:43.609539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214524525A0>]}
[0m16:04:43.620578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214522B0230>]}
[0m16:04:43.621582 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:04:43.621582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214522B0140>]}
[0m16:04:43.624550 [info ] [MainThread]: 
[0m16:04:43.626544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:43.628543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:04:43.645129 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:04:43.646128 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:04:43.647163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:44.618939 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:04:44.625958 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:04:44.782813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m16:04:44.793781 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:04:44.794785 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:04:44.794785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:45.347063 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:04:45.350054 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:04:45.489328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m16:04:45.492732 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:04:45.493764 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:04:45.493764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:45.899991 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:04:45.902993 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:04:46.054054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021452073D10>]}
[0m16:04:46.057989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:46.060618 [info ] [MainThread]: 
[0m16:04:46.073345 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:46.075361 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m16:04:46.077362 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.cross_sell_product_churn'
[0m16:04:46.078362 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:46.091392 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:46.093360 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 16:04:46.079360 => 16:04:46.092357
[0m16:04:46.093360 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:46.144370 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:46.147365 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:46.148364 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
previous_month_end AS (
    SELECT
        DISTINCT DATE_TRUNC('month', last_purchase_date) - INTERVAL '1 day' AS end_date
    FROM customer_product_sales
),
recent_product_churn AS (
    SELECT
        cps.customer_id,
        cps.product_id
    FROM customer_product_sales cps
    JOIN previous_month_end pme ON cps.last_purchase_date < pme.end_date  -- Churn if no purchase in the previous month
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC;
[0m16:04:46.148364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:46.699234 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb001a-0001-0892-0000-50e9000311da
[0m16:04:46.700270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 67 unexpected ';'.
[0m16:04:46.701273 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 16:04:46.094360 => 16:04:46.701273
[0m16:04:46.702274 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m16:04:46.850502 [debug] [Thread-1 (]: Database Error in model cross_sell_product_churn (models\transform\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 67 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\cross_sell_product_churn.sql
[0m16:04:46.851502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '197bd94c-02b6-4df8-bf04-957f388a1db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021452533350>]}
[0m16:04:46.851502 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.cross_sell_product_churn ....... [[31mERROR[0m in 0.77s]
[0m16:04:46.852529 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:46.856413 [error] [MainThread]: CANCEL query list_MINI_PROJECT_OUTPUT_DB ....................................... [[31mCANCEL[0m]
[0m16:04:46.857421 [error] [MainThread]: CANCEL query list_MINI_PROJECT_OUTPUT_DB_staging ............................... [[31mCANCEL[0m]
[0m16:04:46.857421 [error] [MainThread]: CANCEL query model.mini_project_dbt.cross_sell_product_churn ................... [[31mCANCEL[0m]
[0m16:04:46.858624 [info ] [MainThread]: 
[0m16:04:46.859668 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m16:04:46.860694 [info ] [MainThread]: 
[0m16:04:46.861677 [error] [MainThread]:   Database Error in model cross_sell_product_churn (models\transform\cross_sell_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 67 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\cross_sell_product_churn.sql
[0m16:04:46.862694 [info ] [MainThread]: 
[0m16:04:46.863678 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:46.864676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:46.864676 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:04:46.864676 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m16:04:46.865678 [debug] [MainThread]: Connection 'model.mini_project_dbt.cross_sell_product_churn' was properly closed.
[0m16:04:46.865678 [info ] [MainThread]: 
[0m16:04:46.866677 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m16:04:46.868701 [error] [MainThread]: Encountered an error:

[0m16:04:46.923970 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\graph\queue.py", line 198, in join
    self.inner.join()
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m16:04:46.925936 [debug] [MainThread]: Command `dbt run` failed at 16:04:46.925936 after 4.35 seconds
[0m16:04:46.925936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214500B90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021450515760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214526E9A30>]}
[0m16:04:46.926971 [debug] [MainThread]: Flushing usage events
[0m16:04:54.032236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEA539D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEA53BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEA53A810>]}


============================== 16:04:54.037115 | 8a026fad-f91a-4110-b788-ed2a8cdf0780 ==============================
[0m16:04:54.037115 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:04:54.038119 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m cross_sell_product_churn', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:04:54.552591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEBF6F2F0>]}
[0m16:04:54.663180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC1DECF0>]}
[0m16:04:54.665180 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:04:54.674186 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:04:54.788224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:54.788224 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:04:54.940396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:04:54.946403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC2AA210>]}
[0m16:04:54.958403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC3A4290>]}
[0m16:04:54.959404 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:04:54.960405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC50B3E0>]}
[0m16:04:54.962404 [info ] [MainThread]: 
[0m16:04:54.963433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:54.965123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:04:54.982175 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:04:54.982175 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:04:54.983142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:55.634004 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:04:55.640001 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:04:55.791206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m16:04:55.801174 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:04:55.801174 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:04:55.801174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:56.383097 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:04:56.390097 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:04:56.552905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m16:04:56.565905 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:04:56.566909 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:04:56.566909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:56.979266 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:04:56.983229 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:04:57.130020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEA568290>]}
[0m16:04:57.131987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:57.132962 [info ] [MainThread]: 
[0m16:04:57.136853 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:57.137853 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m16:04:57.138853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.cross_sell_product_churn'
[0m16:04:57.139855 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:57.149855 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:57.150853 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 16:04:57.139855 => 16:04:57.150853
[0m16:04:57.150853 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:57.186877 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:57.190851 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m16:04:57.190851 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
previous_month_end AS (
    SELECT
        DISTINCT DATE_TRUNC('month', last_purchase_date) - INTERVAL '1 day' AS end_date
    FROM customer_product_sales
),
recent_product_churn AS (
    SELECT
        cps.customer_id,
        cps.product_id
    FROM customer_product_sales cps
    JOIN previous_month_end pme ON cps.last_purchase_date < pme.end_date  -- Churn if no purchase in the previous month
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC
        );
[0m16:04:57.191854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:58.246260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:04:58.271232 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 16:04:57.151854 => 16:04:58.271232
[0m16:04:58.272231 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m16:04:58.417172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a026fad-f91a-4110-b788-ed2a8cdf0780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC74F140>]}
[0m16:04:58.420173 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.cross_sell_product_churn ........... [[32mSUCCESS 1[0m in 1.28s]
[0m16:04:58.423829 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m16:04:58.431775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:58.432781 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:04:58.433767 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m16:04:58.433767 [debug] [MainThread]: Connection 'model.mini_project_dbt.cross_sell_product_churn' was properly closed.
[0m16:04:58.433767 [info ] [MainThread]: 
[0m16:04:58.434879 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m16:04:58.435895 [debug] [MainThread]: Command end result
[0m16:04:58.447919 [info ] [MainThread]: 
[0m16:04:58.448933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:58.449885 [info ] [MainThread]: 
[0m16:04:58.450887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:58.451920 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:58.451920 after 4.53 seconds
[0m16:04:58.451920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE9EE17C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC4CAB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDEC233770>]}
[0m16:04:58.452920 [debug] [MainThread]: Flushing usage events
[0m16:07:23.624919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AE8F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AE9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AE8B60>]}


============================== 16:07:23.630109 | b4c2cee9-be3f-4399-b6f6-46abe20fd063 ==============================
[0m16:07:23.630109 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:07:23.631106 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m cross_sell_product_churn', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m16:07:24.133598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274E540B0>]}
[0m16:07:24.235259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AE92E0>]}
[0m16:07:24.237034 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:07:24.245665 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:07:24.359252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:24.359252 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:07:24.513407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:07:24.519622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927677A210>]}
[0m16:07:24.532991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192768C00B0>]}
[0m16:07:24.534027 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:07:24.534998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274B3AC30>]}
[0m16:07:24.537038 [info ] [MainThread]: 
[0m16:07:24.539024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:24.539994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:07:24.556025 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:07:24.556993 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:07:24.556993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:25.474676 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:07:25.475676 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:07:25.623291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m16:07:25.650935 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:07:25.651934 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:07:25.652928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:26.208315 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:07:26.210280 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:07:26.350449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m16:07:26.362447 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:07:26.363449 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:07:26.365445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:26.938322 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:07:26.941320 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:07:27.102064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019276B57A10>]}
[0m16:07:27.103026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:27.104025 [info ] [MainThread]: 
[0m16:07:27.107640 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m16:07:27.108640 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.cross_sell_product_churn ................ [RUN]
[0m16:07:27.109640 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.cross_sell_product_churn'
[0m16:07:27.110641 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m16:07:27.118673 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:07:27.120642 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 16:07:27.110641 => 16:07:27.119640
[0m16:07:27.121651 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m16:07:27.157152 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.cross_sell_product_churn"
[0m16:07:27.160119 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.cross_sell_product_churn"
[0m16:07:27.161154 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.cross_sell_product_churn"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.cross_sell_product_churn
         as
        (WITH customer_product_sales AS (
    SELECT
        customer_id,
        product_id,
        COUNT(*) AS purchase_count,
        MAX(transaction_date) AS last_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id, product_id
),
cross_sell AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS distinct_products_purchased
    FROM customer_product_sales
    GROUP BY customer_id
),
previous_month AS (
    SELECT
        customer_id,
        product_id,
        last_purchase_date,
        DATE_TRUNC('month', last_purchase_date) - INTERVAL '1 month' AS previous_month_start,
        DATE_TRUNC('month', last_purchase_date) AS previous_month_end
    FROM customer_product_sales
),
recent_product_churn AS (
    SELECT
        pm.customer_id,
        pm.product_id
    FROM previous_month pm
    LEFT JOIN customer_product_sales cps ON pm.customer_id = cps.customer_id 
        AND pm.product_id = cps.product_id
        AND cps.last_purchase_date >= pm.previous_month_start
        AND cps.last_purchase_date < pm.previous_month_end
    WHERE cps.customer_id IS NULL  -- No purchase in the previous month
),
product_churn AS (
    SELECT
        customer_id,
        COUNT(DISTINCT product_id) AS churned_products
    FROM recent_product_churn
    GROUP BY customer_id
)
SELECT
    cs.customer_id,
    cs.distinct_products_purchased,
    COALESCE(pc.churned_products, 0) AS churned_products
FROM cross_sell cs
LEFT JOIN product_churn pc ON cs.customer_id = pc.customer_id
ORDER BY cs.distinct_products_purchased DESC, churned_products DESC
        );
[0m16:07:27.161154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:28.083373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:28.108344 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 16:07:27.121651 => 16:07:28.108344
[0m16:07:28.108344 [debug] [Thread-1 (]: On model.mini_project_dbt.cross_sell_product_churn: Close
[0m16:07:28.246177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c2cee9-be3f-4399-b6f6-46abe20fd063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019276D2A270>]}
[0m16:07:28.247178 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.cross_sell_product_churn ........... [[32mSUCCESS 1[0m in 1.14s]
[0m16:07:28.248176 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m16:07:28.251179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:28.251179 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:07:28.252179 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m16:07:28.252179 [debug] [MainThread]: Connection 'model.mini_project_dbt.cross_sell_product_churn' was properly closed.
[0m16:07:28.253178 [info ] [MainThread]: 
[0m16:07:28.254178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m16:07:28.255179 [debug] [MainThread]: Command end result
[0m16:07:28.267523 [info ] [MainThread]: 
[0m16:07:28.268855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:28.269884 [info ] [MainThread]: 
[0m16:07:28.270864 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:28.271889 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:28.271889 after 4.73 seconds
[0m16:07:28.272899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001927674F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AC2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019274AC23C0>]}
[0m16:07:28.272899 [debug] [MainThread]: Flushing usage events
[0m16:37:13.929839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F763A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F763A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F7639FD0>]}


============================== 16:37:13.941040 | fb82d974-dcb0-44ab-af9a-a49feceac346 ==============================
[0m16:37:13.941040 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:37:13.943647 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m new_logos_fiscal_year', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:37:14.823500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F736E330>]}
[0m16:37:14.924095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F6413E30>]}
[0m16:37:14.926062 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:37:14.949683 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:37:16.220759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:37:16.220759 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\new_logos_fiscal_year.sql
[0m16:37:16.221760 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m16:37:16.374999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m16:37:16.380999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F960E000>]}
[0m16:37:16.416249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F9433FE0>]}
[0m16:37:16.417247 [info ] [MainThread]: Found 9 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:37:16.418216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F95E9250>]}
[0m16:37:16.419248 [info ] [MainThread]: 
[0m16:37:16.420257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:16.421918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m16:37:16.436966 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m16:37:16.437966 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m16:37:16.437966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:18.092544 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:37:18.094501 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m16:37:18.250120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m16:37:18.259128 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m16:37:18.260129 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m16:37:18.260129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:18.800891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:37:18.802847 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m16:37:18.950142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m16:37:18.964154 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m16:37:18.966143 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m16:37:18.968164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:19.412741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:37:19.414735 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m16:37:19.553297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F9759AC0>]}
[0m16:37:19.554301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:19.555299 [info ] [MainThread]: 
[0m16:37:19.560383 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_logos_fiscal_year
[0m16:37:19.561383 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.new_logos_fiscal_year ................... [RUN]
[0m16:37:19.562382 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.new_logos_fiscal_year'
[0m16:37:19.563384 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_logos_fiscal_year
[0m16:37:19.573467 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_logos_fiscal_year"
[0m16:37:19.574466 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_logos_fiscal_year (compile): 16:37:19.563384 => 16:37:19.574466
[0m16:37:19.575434 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_logos_fiscal_year
[0m16:37:19.609049 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.new_logos_fiscal_year"
[0m16:37:19.612016 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.new_logos_fiscal_year"
[0m16:37:19.612016 [debug] [Thread-1 (]: On model.mini_project_dbt.new_logos_fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.new_logos_fiscal_year"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.new_logos_fiscal_year
         as
        (WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY customer_id
),
fiscal_years AS (
    SELECT
        customer_id,
        first_purchase_date,
        CASE 
            WHEN EXTRACT(MONTH FROM first_purchase_date) >= 4 THEN EXTRACT(YEAR FROM first_purchase_date)  -- FY starts in April
            ELSE EXTRACT(YEAR FROM first_purchase_date) - 1
        END AS fiscal_year
    FROM customer_first_purchase
)
SELECT
    fiscal_year,
    COUNT(customer_id) AS new_logos
FROM fiscal_years
GROUP BY fiscal_year
ORDER BY fiscal_year
        );
[0m16:37:19.613016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:20.769416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:20.790002 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_logos_fiscal_year (execute): 16:37:19.575434 => 16:37:20.790002
[0m16:37:20.791002 [debug] [Thread-1 (]: On model.mini_project_dbt.new_logos_fiscal_year: Close
[0m16:37:20.938770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb82d974-dcb0-44ab-af9a-a49feceac346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F9899250>]}
[0m16:37:20.940775 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.new_logos_fiscal_year .............. [[32mSUCCESS 1[0m in 1.38s]
[0m16:37:20.944768 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_logos_fiscal_year
[0m16:37:20.950764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:20.951763 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m16:37:20.952730 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m16:37:20.952730 [debug] [MainThread]: Connection 'model.mini_project_dbt.new_logos_fiscal_year' was properly closed.
[0m16:37:20.952730 [info ] [MainThread]: 
[0m16:37:20.953732 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m16:37:20.955702 [debug] [MainThread]: Command end result
[0m16:37:21.020218 [info ] [MainThread]: 
[0m16:37:21.021218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:21.022218 [info ] [MainThread]: 
[0m16:37:21.022218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:21.024253 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:21.024253 after 7.21 seconds
[0m16:37:21.024253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F76BAC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F807F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F7FB8DD0>]}
[0m16:37:21.025251 [debug] [MainThread]: Flushing usage events
[0m17:16:49.351685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCF2CA390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCF2CB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCF2CAF60>]}


============================== 17:16:49.362685 | d21e2fc4-a160-435c-933d-a87af1fdcdd3 ==============================
[0m17:16:49.362685 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:16:49.363682 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:16:50.255250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCFD10740>]}
[0m17:16:50.361796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD0D9E9C0>]}
[0m17:16:50.363555 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:16:50.393939 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:16:51.735516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m17:16:51.736520 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:16:51.736520 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\new_logos_fiscal_year.sql
[0m17:16:51.737517 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\cross_sell_product_churn.sql
[0m17:16:51.738517 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\customer_revenue_ranking.sql
[0m17:16:51.738517 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\churn_new_customer.sql
[0m17:16:51.739517 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\product_revenue_ranking.sql
[0m17:16:51.917126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:16:51.924628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD1039AF0>]}
[0m17:16:51.958628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD10E4890>]}
[0m17:16:51.959630 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:16:51.960629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD1215700>]}
[0m17:16:51.961629 [info ] [MainThread]: 
[0m17:16:51.963629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:51.964630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:16:51.981630 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:16:51.982631 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:16:51.982631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:53.662809 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m17:16:53.664810 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:16:53.816743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:16:53.827712 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:16:53.827712 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:16:53.828715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:54.400544 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:16:54.402514 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:16:54.547527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:16:54.551102 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:16:54.551102 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:16:54.552100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:55.144287 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:16:55.145284 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:16:55.294791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCEE49F10>]}
[0m17:16:55.295789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:55.296756 [info ] [MainThread]: 
[0m17:16:55.321013 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:16:55.321013 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:16:55.323014 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:16:55.324014 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:16:55.333013 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:16:55.335035 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:16:55.324014 => 17:16:55.335035
[0m17:16:55.336014 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:16:55.370696 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:16:55.372664 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:16:55.373698 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    GROUP BY customer_id, month
)
select * from customer_revenue
        );
[0m17:16:55.373698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:56.358081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:16:56.380065 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:16:55.336014 => 17:16:56.380065
[0m17:16:56.380065 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:16:56.522242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd21e2fc4-a160-435c-933d-a87af1fdcdd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DD129B0E0>]}
[0m17:16:56.525240 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.20s]
[0m17:16:56.529240 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:16:56.534882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:56.535933 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:16:56.536932 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:16:56.536932 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:16:56.537912 [info ] [MainThread]: 
[0m17:16:56.538879 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m17:16:56.539880 [debug] [MainThread]: Command end result
[0m17:16:56.601506 [info ] [MainThread]: 
[0m17:16:56.602529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:56.603506 [info ] [MainThread]: 
[0m17:16:56.604550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:56.605539 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:56.605539 after 7.38 seconds
[0m17:16:56.605539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCF29AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCEFCF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DCFB92480>]}
[0m17:16:56.606539 [debug] [MainThread]: Flushing usage events
[0m17:18:59.141665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3110DAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3110DB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3110D9A90>]}


============================== 17:18:59.147103 | 52dabe89-53cf-4ead-a030-9abdf91af836 ==============================
[0m17:18:59.147103 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:18:59.148069 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:18:59.652414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3110A9E80>]}
[0m17:18:59.763937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311A2A5D0>]}
[0m17:18:59.765944 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:18:59.774944 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:18:59.890815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:59.890815 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:19:00.067383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:19:00.073384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E311B65760>]}
[0m17:19:00.086406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E312EA00E0>]}
[0m17:19:00.086406 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:19:00.087410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E312CC72C0>]}
[0m17:19:00.089408 [info ] [MainThread]: 
[0m17:19:00.091409 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:00.093408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:19:00.109408 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:19:00.110410 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:19:00.110410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:01.318485 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:19:01.321491 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:19:01.475279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m17:19:01.485818 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:19:01.486814 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:19:01.486814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:01.879855 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:19:01.881855 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:19:02.021807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m17:19:02.033809 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:19:02.035814 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:19:02.036810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:02.587969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:19:02.589972 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:19:02.733500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E313173200>]}
[0m17:19:02.734501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:02.735468 [info ] [MainThread]: 
[0m17:19:02.739157 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:19:02.757443 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:19:02.759477 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:19:02.759477 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:19:02.771472 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:19:02.772473 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:19:02.760477 => 17:19:02.772473
[0m17:19:02.773472 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:19:02.809094 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:19:02.811063 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:19:02.812099 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    GROUP BY customer_id, month
    order by month 
)
select * from customer_revenue
        );
[0m17:19:02.812099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:05.292590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:19:05.316136 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:19:02.773472 => 17:19:05.316136
[0m17:19:05.317139 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:19:05.460227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52dabe89-53cf-4ead-a030-9abdf91af836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3133183B0>]}
[0m17:19:05.463232 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 2.70s]
[0m17:19:05.467170 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:19:05.475220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:05.476221 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:19:05.477190 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m17:19:05.477190 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:19:05.478191 [info ] [MainThread]: 
[0m17:19:05.478191 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m17:19:05.480187 [debug] [MainThread]: Command end result
[0m17:19:05.492231 [info ] [MainThread]: 
[0m17:19:05.493122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:05.494131 [info ] [MainThread]: 
[0m17:19:05.495175 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:05.496488 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:05.495479 after 6.44 seconds
[0m17:19:05.497020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E310FD1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3110AAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E312FF7A10>]}
[0m17:19:05.497020 [debug] [MainThread]: Flushing usage events
[0m17:19:33.579509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9798A8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9798A9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9798A80E0>]}


============================== 17:19:33.585543 | 40e54d7b-7ef9-4db5-afbf-254c438e8cf8 ==============================
[0m17:19:33.585543 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:19:33.586510 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:19:34.102464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97B496870>]}
[0m17:19:34.215949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97A13B2F0>]}
[0m17:19:34.217723 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:19:34.226497 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:19:34.337116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:34.338117 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:19:34.492675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:19:34.499670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97A1C7020>]}
[0m17:19:34.512718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97B6700E0>]}
[0m17:19:34.513681 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:19:34.514713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97B82D700>]}
[0m17:19:34.515713 [info ] [MainThread]: 
[0m17:19:34.517680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:34.518679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:19:34.534265 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:19:34.535265 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:19:34.535265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:35.401315 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:19:35.403317 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:19:35.554337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:19:35.580266 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:19:35.581264 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:19:35.581264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:36.136087 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:19:36.139056 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:19:36.289481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:19:36.301482 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:19:36.302483 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:19:36.305491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:36.864250 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:19:36.871309 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:19:37.019352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97A1711C0>]}
[0m17:19:37.020361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:37.021361 [info ] [MainThread]: 
[0m17:19:37.026387 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:19:37.026387 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:19:37.028392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:19:37.028392 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:19:37.039399 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:19:37.040394 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:19:37.029363 => 17:19:37.040394
[0m17:19:37.041361 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:19:37.073960 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:19:37.075925 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:19:37.076926 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    GROUP BY customer_id, month
    ordere by customer_id, month
)
select * from customer_revenue
        );
[0m17:19:37.076926 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:37.691997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0065-0001-0892-0000-50e90003134a
[0m17:19:37.693000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 4 unexpected 'ordere'.
[0m17:19:37.693000 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:19:37.041361 => 17:19:37.693000
[0m17:19:37.693995 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:19:37.856713 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 4 unexpected 'ordere'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:19:37.856713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e54d7b-7ef9-4db5-afbf-254c438e8cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B97B8183B0>]}
[0m17:19:37.857712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.83s]
[0m17:19:37.858675 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:19:37.861711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:37.861711 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:19:37.862710 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:19:37.862710 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:19:37.863711 [info ] [MainThread]: 
[0m17:19:37.863711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m17:19:37.865252 [debug] [MainThread]: Command end result
[0m17:19:37.877320 [info ] [MainThread]: 
[0m17:19:37.879327 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:37.880330 [info ] [MainThread]: 
[0m17:19:37.881364 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 4 unexpected 'ordere'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:19:37.882338 [info ] [MainThread]: 
[0m17:19:37.883330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:19:37.884326 [debug] [MainThread]: Command `dbt run` failed at 17:19:37.884326 after 4.39 seconds
[0m17:19:37.885361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9797585C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979759FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979759B50>]}
[0m17:19:37.885361 [debug] [MainThread]: Flushing usage events
[0m17:20:46.484478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680D459F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680D45A030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680D459BB0>]}


============================== 17:20:46.490512 | b26bc646-2427-4726-8729-a8546725d93f ==============================
[0m17:20:46.490512 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:20:46.491480 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:20:46.999596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680DEE31D0>]}
[0m17:20:47.099219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680DDE8080>]}
[0m17:20:47.101184 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:20:47.110219 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:20:47.213883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:47.214883 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:20:47.369093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:20:47.376127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F020320>]}
[0m17:20:47.388122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F2B4A40>]}
[0m17:20:47.389122 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:20:47.389122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F1BFFE0>]}
[0m17:20:47.391127 [info ] [MainThread]: 
[0m17:20:47.393096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:47.395133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:20:47.411126 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:20:47.412128 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:20:47.412128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:48.563964 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:20:48.565978 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:20:48.716003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:20:48.730974 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:20:48.730974 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:20:48.731977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:49.283324 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:20:49.289319 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:20:49.450699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:20:49.463773 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:20:49.465773 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:20:49.468340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:50.036274 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:20:50.043271 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:20:50.196907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F446EA0>]}
[0m17:20:50.198907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:50.199930 [info ] [MainThread]: 
[0m17:20:50.203936 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:20:50.204963 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:20:50.205942 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:20:50.206936 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:20:50.215971 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:20:50.217937 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:20:50.206936 => 17:20:50.217937
[0m17:20:50.218938 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:20:50.252939 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:20:50.255488 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:20:50.255488 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    GROUP BY customer_id, month
    order by customer_id, month
)
select * from customer_revenue
        );
[0m17:20:50.256497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:51.199074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:20:51.222067 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:20:50.218938 => 17:20:51.222067
[0m17:20:51.223068 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:20:51.360991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b26bc646-2427-4726-8729-a8546725d93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F6B4230>]}
[0m17:20:51.363993 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.16s]
[0m17:20:51.367991 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:20:51.375594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:51.376600 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:20:51.377556 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:20:51.377556 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:20:51.378559 [info ] [MainThread]: 
[0m17:20:51.378559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m17:20:51.380523 [debug] [MainThread]: Command end result
[0m17:20:51.392559 [info ] [MainThread]: 
[0m17:20:51.393544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:51.394552 [info ] [MainThread]: 
[0m17:20:51.395552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:20:51.416036 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:51.416036 after 5.03 seconds
[0m17:20:51.416036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680D2E6F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F446EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680F0AEA50>]}
[0m17:20:51.417035 [debug] [MainThread]: Flushing usage events
[0m17:24:37.390902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A773A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A773AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7739F10>]}


============================== 17:24:37.396935 | 6b4f409f-7a7e-4210-b36f-f58729eb6704 ==============================
[0m17:24:37.396935 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:24:37.397904 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:24:37.954308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A92437D0>]}
[0m17:24:38.053926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A727D070>]}
[0m17:24:38.055896 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:24:38.074521 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:24:39.345082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:39.345082 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:24:39.497100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:24:39.503318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7709C10>]}
[0m17:24:39.528541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A9503FE0>]}
[0m17:24:39.529583 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:24:39.530547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A96BC170>]}
[0m17:24:39.532591 [info ] [MainThread]: 
[0m17:24:39.533588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:39.534926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:24:39.550451 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:24:39.550451 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:24:39.551448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:40.528103 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:24:40.530070 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:24:40.677139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:24:40.686176 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:24:40.686176 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:24:40.687155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:41.234981 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:24:41.241978 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:24:41.397098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:24:41.409099 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:24:41.410084 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:24:41.412085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:41.966481 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:24:41.973492 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:24:42.120778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A7FABF50>]}
[0m17:24:42.121779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:42.122745 [info ] [MainThread]: 
[0m17:24:42.126755 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:24:42.127797 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:24:42.128801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:24:42.129798 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:24:42.138771 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:24:42.140772 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:24:42.129798 => 17:24:42.139805
[0m17:24:42.140772 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:24:42.174359 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:24:42.190501 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:24:42.191501 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) - total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month;
[0m17:24:42.192535 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:42.956483 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006a-0001-0892-0000-50e900031356
[0m17:24:42.957482 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 14 unexpected ';'.
[0m17:24:42.957482 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:24:42.140772 => 17:24:42.957482
[0m17:24:42.958482 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:24:43.114247 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:24:43.115248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b4f409f-7a7e-4210-b36f-f58729eb6704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A9962CF0>]}
[0m17:24:43.116247 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.99s]
[0m17:24:43.117246 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:24:43.120247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:43.120247 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:24:43.121247 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:24:43.121247 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:24:43.121247 [info ] [MainThread]: 
[0m17:24:43.122250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:24:43.124213 [debug] [MainThread]: Command end result
[0m17:24:43.137242 [info ] [MainThread]: 
[0m17:24:43.137242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:43.139213 [info ] [MainThread]: 
[0m17:24:43.139213 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:24:43.140221 [info ] [MainThread]: 
[0m17:24:43.141254 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:43.142220 [debug] [MainThread]: Command `dbt run` failed at 17:24:43.142220 after 5.86 seconds
[0m17:24:43.143254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A77384A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A75FDF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166A81A0560>]}
[0m17:24:43.143254 [debug] [MainThread]: Flushing usage events
[0m17:24:53.213615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D9A9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D9AB200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D9A9F40>]}


============================== 17:24:53.219616 | 64f763e7-17e1-43e8-bce0-f2e529263300 ==============================
[0m17:24:53.219616 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:24:53.220615 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:24:53.727223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585F4F77D0>]}
[0m17:24:53.826844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D899280>]}
[0m17:24:53.828936 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:24:53.837483 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:24:53.948224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:53.948224 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:24:54.103823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:24:54.109850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585F6A64B0>]}
[0m17:24:54.122883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585F7D49B0>]}
[0m17:24:54.123880 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:24:54.124852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E2B1220>]}
[0m17:24:54.126853 [info ] [MainThread]: 
[0m17:24:54.128854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:54.130905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:24:54.144939 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:24:54.145933 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:24:54.145933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:55.032699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:24:55.034695 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:24:55.176646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m17:24:55.189656 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:24:55.190656 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:24:55.190656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:55.756864 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:24:55.759835 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:24:55.909854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m17:24:55.918846 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:24:55.919847 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:24:55.919847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:56.475645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:24:56.482645 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:24:56.638769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585DDDF560>]}
[0m17:24:56.639732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:56.640702 [info ] [MainThread]: 
[0m17:24:56.644309 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:24:56.645337 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:24:56.646311 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:24:56.647334 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:24:56.656359 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:24:56.658317 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:24:56.647334 => 17:24:56.657351
[0m17:24:56.658317 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:24:56.692932 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:24:56.694899 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:24:56.694899 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) - total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:24:56.695901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:57.969333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:24:57.993842 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:24:56.659350 => 17:24:57.992842
[0m17:24:57.993842 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:24:58.274482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f763e7-17e1-43e8-bce0-f2e529263300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585FBE1730>]}
[0m17:24:58.275477 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.63s]
[0m17:24:58.276403 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:24:58.278995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:58.278995 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:24:58.279995 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m17:24:58.279995 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:24:58.279995 [info ] [MainThread]: 
[0m17:24:58.280998 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m17:24:58.282979 [debug] [MainThread]: Command end result
[0m17:24:58.346315 [info ] [MainThread]: 
[0m17:24:58.347322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:58.348317 [info ] [MainThread]: 
[0m17:24:58.349317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:58.350316 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:58.350316 after 5.23 seconds
[0m17:24:58.351348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D5B0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D702DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585D62B3E0>]}
[0m17:24:58.351348 [debug] [MainThread]: Flushing usage events
[0m17:39:56.254211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF53C5A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF53C5A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF53C59EE0>]}


============================== 17:39:56.266285 | 51771d9a-09b3-4aec-9511-4fa97af665c1 ==============================
[0m17:39:56.266285 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:39:56.268296 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:39:57.103253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF546F1220>]}
[0m17:39:57.213450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5373DA30>]}
[0m17:39:57.214451 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:39:57.240472 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:39:58.619172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:58.620135 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:39:58.797373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:39:58.803502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF55C37560>]}
[0m17:39:58.835498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF55A481D0>]}
[0m17:39:58.836498 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:39:58.837498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF55970440>]}
[0m17:39:58.839496 [info ] [MainThread]: 
[0m17:39:58.840496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:58.842497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:39:58.859498 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:39:58.860501 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:39:58.860501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:00.284003 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:40:00.286972 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:40:00.439182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m17:40:00.449182 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:40:00.449182 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:40:00.450180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:00.858839 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:40:00.863828 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:40:01.011143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m17:40:01.014151 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:40:01.014151 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:40:01.016151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:01.583935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:40:01.590884 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:40:01.749786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF559064E0>]}
[0m17:40:01.750807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:01.751404 [info ] [MainThread]: 
[0m17:40:01.775342 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:40:01.776378 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:40:01.777377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:40:01.777377 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:40:01.785377 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:40:01.787722 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:40:01.778379 => 17:40:01.786712
[0m17:40:01.787722 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:40:01.822754 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:40:01.825734 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:40:01.826731 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM staging_transactions_table 
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (total_revenue- previous_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE "No loss" END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:40:01.826731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:02.593530 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007a-0001-086e-0000-50e9000305fa
[0m17:40:02.593530 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STAGING_TRANSACTIONS_TABLE' does not exist or not authorized.
[0m17:40:02.594508 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:40:01.788753 => 17:40:02.594508
[0m17:40:02.595505 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:40:02.779606 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  002003 (42S02): SQL compilation error:
  Object 'STAGING_TRANSACTIONS_TABLE' does not exist or not authorized.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:40:02.780606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51771d9a-09b3-4aec-9511-4fa97af665c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF55EADAF0>]}
[0m17:40:02.780606 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 1.00s]
[0m17:40:02.782574 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:40:02.784574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:02.785574 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:40:02.785574 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m17:40:02.786573 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:40:02.786573 [info ] [MainThread]: 
[0m17:40:02.787573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m17:40:02.788578 [debug] [MainThread]: Command end result
[0m17:40:02.804576 [info ] [MainThread]: 
[0m17:40:02.805575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:02.806576 [info ] [MainThread]: 
[0m17:40:02.806576 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  002003 (42S02): SQL compilation error:
  Object 'STAGING_TRANSACTIONS_TABLE' does not exist or not authorized.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:40:02.807574 [info ] [MainThread]: 
[0m17:40:02.808607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:40:02.810575 [debug] [MainThread]: Command `dbt run` failed at 17:40:02.810575 after 6.68 seconds
[0m17:40:02.810575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF53AFB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF559AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF55C0DFA0>]}
[0m17:40:02.811574 [debug] [MainThread]: Flushing usage events
[0m17:40:36.853668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7E12A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7E12A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7E129CA0>]}


============================== 17:40:36.858701 | 9f417378-499c-4b7a-8fbd-21f1ea96cf2d ==============================
[0m17:40:36.858701 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:40:36.859667 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:40:37.367943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EB368A0>]}
[0m17:40:37.467561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EA5D3A0>]}
[0m17:40:37.469263 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:40:37.479407 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:40:37.589602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:37.590607 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:40:37.763395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:40:37.770397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7FDE8230>]}
[0m17:40:37.783397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7FF2FCB0>]}
[0m17:40:37.787410 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:40:37.788410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7E158B00>]}
[0m17:40:37.790406 [info ] [MainThread]: 
[0m17:40:37.791520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:40:37.793137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:40:37.809658 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:40:37.809658 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:40:37.810691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:38.958552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:40:38.959552 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:40:39.102354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:40:39.113369 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:40:39.114369 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:40:39.114369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:40.405962 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:40:40.412960 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:40:40.564955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:40:40.568992 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:40:40.569992 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:40:40.570991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:41.204494 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:40:41.212486 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:40:41.365724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0011EDB0>]}
[0m17:40:41.367777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:41.368736 [info ] [MainThread]: 
[0m17:40:41.374738 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:40:41.375778 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:40:41.377777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:40:41.378740 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:40:41.390773 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:40:41.392768 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:40:41.379739 => 17:40:41.391768
[0m17:40:41.392768 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:40:41.427806 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:40:41.430806 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:40:41.430806 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (total_revenue- previous_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE "No loss" END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:40:41.431809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:42.400358 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007a-0001-087f-0000-50e90002ad5e
[0m17:40:42.401349 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 58
invalid identifier '"No loss"'
[0m17:40:42.402346 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:40:41.393767 => 17:40:42.401349
[0m17:40:42.402346 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:40:42.553830 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 22 at position 58
  invalid identifier '"No loss"'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:40:42.553830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f417378-499c-4b7a-8fbd-21f1ea96cf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B003A8650>]}
[0m17:40:42.554833 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 1.18s]
[0m17:40:42.555829 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:40:42.558830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:42.558830 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:40:42.559865 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:40:42.559865 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:40:42.560828 [info ] [MainThread]: 
[0m17:40:42.560828 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m17:40:42.562833 [debug] [MainThread]: Command end result
[0m17:40:42.574833 [info ] [MainThread]: 
[0m17:40:42.575874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:42.576831 [info ] [MainThread]: 
[0m17:40:42.577830 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 22 at position 58
  invalid identifier '"No loss"'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:40:42.578418 [info ] [MainThread]: 
[0m17:40:42.579426 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:40:42.580460 [debug] [MainThread]: Command `dbt run` failed at 17:40:42.580460 after 5.81 seconds
[0m17:40:42.581460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0011FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7EBD11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B002408F0>]}
[0m17:40:42.581460 [debug] [MainThread]: Flushing usage events
[0m17:40:59.869705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021787D0A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021787D09F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021787D0A750>]}


============================== 17:40:59.875707 | 3977db4f-4188-4f3b-a3c9-1bbbb7758af5 ==============================
[0m17:40:59.875707 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:40:59.876671 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:41:00.383883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178998A2D0>]}
[0m17:41:00.483504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021788658080>]}
[0m17:41:00.485534 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:41:00.494160 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:41:00.607791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:00.608793 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:41:00.763649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:41:00.769917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021789CB7230>]}
[0m17:41:00.782090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021789B24890>]}
[0m17:41:00.782090 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:41:00.783106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021789C8DCD0>]}
[0m17:41:00.785139 [info ] [MainThread]: 
[0m17:41:00.787123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:41:00.788089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:41:00.805131 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:41:00.805131 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:41:00.805131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:01.926497 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:41:01.930484 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:41:02.088648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:41:02.114667 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:41:02.115669 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:41:02.115669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:02.661910 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:41:02.667909 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:41:02.820276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:41:02.832280 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:41:02.834239 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:41:02.834239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:03.373708 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:41:03.381706 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:41:03.532214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217898F68A0>]}
[0m17:41:03.534215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:03.535258 [info ] [MainThread]: 
[0m17:41:03.543209 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:41:03.544225 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:41:03.546691 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:41:03.547699 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:41:03.560207 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:41:03.562222 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:41:03.548696 => 17:41:03.561221
[0m17:41:03.563207 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:41:03.597243 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:41:03.599242 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:41:03.600242 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (total_revenue- previous_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 'No loss' END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:41:03.600242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:04.336137 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007b-0001-087f-0000-50e90002ad66
[0m17:41:04.337134 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'No loss' is not recognized
[0m17:41:04.338142 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:41:03.563207 => 17:41:04.337134
[0m17:41:04.338142 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:41:04.490926 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  100038 (22018): Numeric value 'No loss' is not recognized
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:41:04.492926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3977db4f-4188-4f3b-a3c9-1bbbb7758af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021789F059D0>]}
[0m17:41:04.493929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.95s]
[0m17:41:04.496904 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:41:04.500902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:04.501899 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:41:04.502861 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:41:04.502861 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:41:04.503858 [info ] [MainThread]: 
[0m17:41:04.504891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m17:41:04.506896 [debug] [MainThread]: Command end result
[0m17:41:04.519889 [info ] [MainThread]: 
[0m17:41:04.520856 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:41:04.521882 [info ] [MainThread]: 
[0m17:41:04.521882 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  100038 (22018): Numeric value 'No loss' is not recognized
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m17:41:04.522859 [info ] [MainThread]: 
[0m17:41:04.523856 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:41:04.525889 [debug] [MainThread]: Command `dbt run` failed at 17:41:04.524872 after 4.74 seconds
[0m17:41:04.525889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786CC2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217879FADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021787A2CCE0>]}
[0m17:41:04.525889 [debug] [MainThread]: Flushing usage events
[0m17:41:17.223684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB8A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB8AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB88260>]}


============================== 17:41:17.229688 | c7c7f506-8d4b-4481-98f5-dce4ef6be767 ==============================
[0m17:41:17.229688 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:41:17.230685 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:41:17.733430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB8A000>]}
[0m17:41:17.834053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049E4B50D0>]}
[0m17:41:17.835406 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:41:17.844027 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:41:17.954350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:17.955335 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:41:18.108968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:41:18.115008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049F72D760>]}
[0m17:41:18.127176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049F95BEC0>]}
[0m17:41:18.127176 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:41:18.130832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049FB042F0>]}
[0m17:41:18.132842 [info ] [MainThread]: 
[0m17:41:18.137843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:41:18.138847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:41:18.155854 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:41:18.155854 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:41:18.156855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:19.153992 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:41:19.155962 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:41:19.301781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m17:41:19.327428 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:41:19.327428 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:41:19.328433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:19.886792 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:41:19.888779 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:41:20.029020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m17:41:20.033984 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:41:20.034986 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:41:20.035987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:20.470635 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m17:41:20.474602 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:41:20.614820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049F884260>]}
[0m17:41:20.616328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:20.617343 [info ] [MainThread]: 
[0m17:41:20.621341 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:41:20.622366 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:41:20.623337 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:41:20.624364 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:41:20.634370 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:41:20.635367 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:41:20.624364 => 17:41:20.635367
[0m17:41:20.636337 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:41:20.670372 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:41:20.673371 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:41:20.673371 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (total_revenue- previous_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:41:20.674370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:21.683763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:41:21.707833 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:41:20.636337 => 17:41:21.707833
[0m17:41:21.707833 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:41:21.850727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c7f506-8d4b-4481-98f5-dce4ef6be767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049FD843B0>]}
[0m17:41:21.851682 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m17:41:21.853681 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:41:21.855647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:21.855647 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:41:21.855647 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m17:41:21.856682 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:41:21.856682 [info ] [MainThread]: 
[0m17:41:21.857688 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m17:41:21.858652 [debug] [MainThread]: Command end result
[0m17:41:21.921655 [info ] [MainThread]: 
[0m17:41:21.922655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:21.923371 [info ] [MainThread]: 
[0m17:41:21.924430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:21.925412 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:21.925412 after 4.79 seconds
[0m17:41:21.926416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049CC01430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB5A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002049DB5AFF0>]}
[0m17:41:21.926416 [debug] [MainThread]: Flushing usage events
[0m17:56:20.956926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695EBA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695EBADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695EB9FA0>]}


============================== 17:56:20.968793 | 22aa080c-66a9-4455-9365-392d28710f55 ==============================
[0m17:56:20.968793 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:20.970737 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:56:21.854784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276979CD310>]}
[0m17:56:21.964030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027697A35E20>]}
[0m17:56:21.965482 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:56:21.986531 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:23.375193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:23.376193 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:56:23.556261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:56:23.563261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027696049A00>]}
[0m17:56:23.591321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027697D14B60>]}
[0m17:56:23.591321 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:56:23.592318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276963216A0>]}
[0m17:56:23.594322 [info ] [MainThread]: 
[0m17:56:23.596317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:23.597286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:56:23.613317 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:56:23.614284 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:56:23.614284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:24.693963 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:56:24.695000 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:56:24.832289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m17:56:24.842289 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:56:24.843290 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:56:24.843290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:25.391119 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:56:25.396115 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:56:25.542225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m17:56:25.547224 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:56:25.548225 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:56:25.548225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:25.936471 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:56:25.938467 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:56:26.087574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027697C6E8A0>]}
[0m17:56:26.089595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:26.090220 [info ] [MainThread]: 
[0m17:56:26.115030 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:56:26.116062 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:56:26.118026 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:56:26.118026 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:56:26.129034 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:56:26.132029 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:56:26.119028 => 17:56:26.132029
[0m17:56:26.133029 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:56:26.167025 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:56:26.170448 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:56:26.170448 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (total_revenue- previous_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss < 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:56:26.171447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:26.973871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:56:26.998875 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:56:26.133029 => 17:56:26.998875
[0m17:56:26.998875 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:56:27.136273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22aa080c-66a9-4455-9365-392d28710f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027697C6E210>]}
[0m17:56:27.137275 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:56:27.137894 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:56:27.148575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:27.148575 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:56:27.149575 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m17:56:27.150574 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:56:27.150574 [info ] [MainThread]: 
[0m17:56:27.152536 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m17:56:27.153544 [debug] [MainThread]: Command end result
[0m17:56:27.214086 [info ] [MainThread]: 
[0m17:56:27.215082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:27.216087 [info ] [MainThread]: 
[0m17:56:27.217172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:56:27.218181 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:27.218181 after 6.38 seconds
[0m17:56:27.219213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695DA6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695DB90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695DB8AD0>]}
[0m17:56:27.219213 [debug] [MainThread]: Flushing usage events
[0m17:57:49.742497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A49A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A49A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A499E50>]}


============================== 17:57:49.748499 | 8526da5d-4596-4266-a551-91190fe098d5 ==============================
[0m17:57:49.748499 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:57:49.749464 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:57:50.270301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38C0C45F0>]}
[0m17:57:50.371923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38AF65580>]}
[0m17:57:50.372924 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:57:50.382890 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:57:50.500502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:50.500502 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m17:57:50.654037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m17:57:50.661057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38C28C320>]}
[0m17:57:50.673049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38C2F4B00>]}
[0m17:57:50.673049 [info ] [MainThread]: Found 10 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m17:57:50.674058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A4F1940>]}
[0m17:57:50.677045 [info ] [MainThread]: 
[0m17:57:50.678047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:57:50.680046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m17:57:50.696609 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m17:57:50.697606 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m17:57:50.698598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:52.281525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m17:57:52.283533 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m17:57:52.433234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m17:57:52.451202 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m17:57:52.451202 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m17:57:52.451202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:53.008752 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m17:57:53.012288 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m17:57:53.161797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m17:57:53.165797 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m17:57:53.165797 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m17:57:53.166797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:53.589347 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:57:53.593317 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m17:57:53.752227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A892480>]}
[0m17:57:53.754193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:53.755160 [info ] [MainThread]: 
[0m17:57:53.765414 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m17:57:53.766413 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m17:57:53.767416 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m17:57:53.768382 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m17:57:53.777415 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m17:57:53.779380 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 17:57:53.769384 => 17:57:53.778413
[0m17:57:53.779380 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m17:57:53.814997 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m17:57:53.817969 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m17:57:53.817969 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change
GROUP BY month
ORDER BY month
        );
[0m17:57:53.819028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:54.805256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:57:54.829803 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 17:57:53.779380 => 17:57:54.829803
[0m17:57:54.829803 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m17:57:54.973644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8526da5d-4596-4266-a551-91190fe098d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38C6D20F0>]}
[0m17:57:54.976583 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m17:57:54.980647 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m17:57:54.988642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:54.989644 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m17:57:54.989644 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m17:57:54.990607 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m17:57:54.990607 [info ] [MainThread]: 
[0m17:57:54.991573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m17:57:54.992603 [debug] [MainThread]: Command end result
[0m17:57:55.060147 [info ] [MainThread]: 
[0m17:57:55.061487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:55.062494 [info ] [MainThread]: 
[0m17:57:55.062494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:57:55.064528 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:55.064528 after 5.41 seconds
[0m17:57:55.064528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A0510A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3896EAC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38ADF70B0>]}
[0m17:57:55.065529 [debug] [MainThread]: Flushing usage events
[0m18:21:39.872011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FAF4297F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FAF429850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FAF428860>]}


============================== 18:21:39.886123 | 5c1d14eb-9133-43b0-befd-13de695a316d ==============================
[0m18:21:39.886123 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:21:39.888238 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:21:40.827905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FAF479250>]}
[0m18:21:40.930463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB0ECF380>]}
[0m18:21:40.931905 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:21:40.958809 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:21:42.257286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:21:42.258296 [debug] [MainThread]: Partial parsing: added file: mini_project_dbt://models\transform\nrr_grr.sql
[0m18:21:42.258296 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:21:42.415428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:21:42.422425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB1483F50>]}
[0m18:21:42.426424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB11A3F80>]}
[0m18:21:42.426424 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:21:42.427425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB11A3A10>]}
[0m18:21:42.429458 [info ] [MainThread]: 
[0m18:21:42.431426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:21:42.433438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m18:21:42.453432 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:21:42.454432 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:21:42.454432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:43.678539 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:21:43.680539 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:21:43.828991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m18:21:43.837948 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:21:43.838955 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:21:43.838955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:44.416139 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:21:44.419140 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:21:44.571029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c1d14eb-9133-43b0-befd-13de695a316d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB1397D10>]}
[0m18:21:44.572033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:44.572998 [info ] [MainThread]: 
[0m18:21:44.596560 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_country_region_table
[0m18:21:44.597591 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.staging_country_region_table'
[0m18:21:44.598593 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_country_region_table
[0m18:21:44.611140 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_country_region_table"
[0m18:21:44.614158 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (compile): 18:21:44.598593 => 18:21:44.613155
[0m18:21:44.614158 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_country_region_table
[0m18:21:44.615141 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_country_region_table (execute): 18:21:44.615141 => 18:21:44.615141
[0m18:21:44.616139 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_country_region_table
[0m18:21:44.617138 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_customers_table
[0m18:21:44.617138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_country_region_table, now model.mini_project_dbt.staging_customers_table)
[0m18:21:44.618139 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_customers_table
[0m18:21:44.622139 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_customers_table"
[0m18:21:44.624867 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (compile): 18:21:44.618139 => 18:21:44.623849
[0m18:21:44.625860 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_customers_table
[0m18:21:44.626860 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_customers_table (execute): 18:21:44.626860 => 18:21:44.626860
[0m18:21:44.627857 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_customers_table
[0m18:21:44.628855 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_products_table
[0m18:21:44.629855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_customers_table, now model.mini_project_dbt.staging_products_table)
[0m18:21:44.629855 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_products_table
[0m18:21:44.633854 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_products_table"
[0m18:21:44.635855 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (compile): 18:21:44.630855 => 18:21:44.634854
[0m18:21:44.635855 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_products_table
[0m18:21:44.636894 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_products_table (execute): 18:21:44.636894 => 18:21:44.636894
[0m18:21:44.637857 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_products_table
[0m18:21:44.638893 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.staging_transactions_table
[0m18:21:44.638893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_products_table, now model.mini_project_dbt.staging_transactions_table)
[0m18:21:44.639894 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.staging_transactions_table
[0m18:21:44.644891 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.staging_transactions_table"
[0m18:21:44.645857 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (compile): 18:21:44.639894 => 18:21:44.645857
[0m18:21:44.646857 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.staging_transactions_table
[0m18:21:44.646857 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.staging_transactions_table (execute): 18:21:44.646857 => 18:21:44.646857
[0m18:21:44.647857 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.staging_transactions_table
[0m18:21:44.649326 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.churn_new_customer
[0m18:21:44.650366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.staging_transactions_table, now model.mini_project_dbt.churn_new_customer)
[0m18:21:44.650366 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.churn_new_customer
[0m18:21:44.654366 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.churn_new_customer"
[0m18:21:44.655332 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (compile): 18:21:44.651335 => 18:21:44.655332
[0m18:21:44.656333 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.churn_new_customer
[0m18:21:44.656333 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.churn_new_customer (execute): 18:21:44.656333 => 18:21:44.656333
[0m18:21:44.657367 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.churn_new_customer
[0m18:21:44.658333 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.cross_sell_product_churn
[0m18:21:44.659367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.churn_new_customer, now model.mini_project_dbt.cross_sell_product_churn)
[0m18:21:44.659367 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.cross_sell_product_churn
[0m18:21:44.663367 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.cross_sell_product_churn"
[0m18:21:44.664366 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (compile): 18:21:44.659367 => 18:21:44.664366
[0m18:21:44.664366 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.cross_sell_product_churn
[0m18:21:44.665367 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.cross_sell_product_churn (execute): 18:21:44.665367 => 18:21:44.665367
[0m18:21:44.666367 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.cross_sell_product_churn
[0m18:21:44.667368 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.customer_revenue_ranking
[0m18:21:44.667368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.cross_sell_product_churn, now model.mini_project_dbt.customer_revenue_ranking)
[0m18:21:44.668366 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.customer_revenue_ranking
[0m18:21:44.671366 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.customer_revenue_ranking"
[0m18:21:44.672381 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (compile): 18:21:44.668366 => 18:21:44.672381
[0m18:21:44.673335 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.customer_revenue_ranking
[0m18:21:44.673335 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.customer_revenue_ranking (execute): 18:21:44.673335 => 18:21:44.673335
[0m18:21:44.675330 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.customer_revenue_ranking
[0m18:21:44.675330 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.new_logos_fiscal_year
[0m18:21:44.676330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.customer_revenue_ranking, now model.mini_project_dbt.new_logos_fiscal_year)
[0m18:21:44.676330 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.new_logos_fiscal_year
[0m18:21:44.680330 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.new_logos_fiscal_year"
[0m18:21:44.681330 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_logos_fiscal_year (compile): 18:21:44.677330 => 18:21:44.681330
[0m18:21:44.682330 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.new_logos_fiscal_year
[0m18:21:44.682330 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.new_logos_fiscal_year (execute): 18:21:44.682330 => 18:21:44.682330
[0m18:21:44.683331 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.new_logos_fiscal_year
[0m18:21:44.684330 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.product_revenue_ranking
[0m18:21:44.685366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.new_logos_fiscal_year, now model.mini_project_dbt.product_revenue_ranking)
[0m18:21:44.685366 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.product_revenue_ranking
[0m18:21:44.688368 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.product_revenue_ranking"
[0m18:21:44.690377 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (compile): 18:21:44.685366 => 18:21:44.689409
[0m18:21:44.690377 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.product_revenue_ranking
[0m18:21:44.691412 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.product_revenue_ranking (execute): 18:21:44.690377 => 18:21:44.690377
[0m18:21:44.692411 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.product_revenue_ranking
[0m18:21:44.692411 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:21:44.693408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project_dbt.product_revenue_ranking, now model.mini_project_dbt.revenue_loss)
[0m18:21:44.693408 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:21:44.697408 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:21:44.698409 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:21:44.694407 => 18:21:44.698409
[0m18:21:44.699374 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:21:44.699374 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:21:44.699374 => 18:21:44.699374
[0m18:21:44.701408 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:21:44.702391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:44.702391 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m18:21:44.702391 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:21:44.704972 [debug] [MainThread]: Command end result
[0m18:21:44.994448 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:21:44.994448 [info ] [MainThread]: Building catalog
[0m18:21:44.998487 [debug] [ThreadPool]: Acquiring new snowflake connection 'MINI_PROJECT_OUTPUT_DB.information_schema'
[0m18:21:45.069071 [debug] [ThreadPool]: Using snowflake connection "MINI_PROJECT_OUTPUT_DB.information_schema"
[0m18:21:45.070032 [debug] [ThreadPool]: On MINI_PROJECT_OUTPUT_DB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "MINI_PROJECT_OUTPUT_DB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MINI_PROJECT_OUTPUT_DB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_customers_table')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_products_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('product_revenue_ranking')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_transactions_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('revenue_loss')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('churn_new_customer')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_country_region_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('new_logos_fiscal_year')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('cross_sell_product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('customer_revenue_ranking')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MINI_PROJECT_OUTPUT_DB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_customers_table')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_products_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('product_revenue_ranking')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_transactions_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('revenue_loss')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('churn_new_customer')
                )
             or 
                (
                    upper("table_schema") = upper('staging')
                    and upper("table_name") = upper('staging_country_region_table')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('new_logos_fiscal_year')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('cross_sell_product_churn')
                )
             or 
                (
                    upper("table_schema") = upper('transform')
                    and upper("table_name") = upper('customer_revenue_ranking')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:21:45.071065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:48.797582 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 4.0 seconds
[0m18:21:48.848243 [debug] [ThreadPool]: On MINI_PROJECT_OUTPUT_DB.information_schema: Close
[0m18:21:49.001576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly MINI_PROJECT_OUTPUT_DB.information_schema, now raw_data.information_schema)
[0m18:21:49.009564 [debug] [ThreadPool]: Using snowflake connection "raw_data.information_schema"
[0m18:21:49.010566 [debug] [ThreadPool]: On raw_data.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "raw_data.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from raw_data.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('PRODUCTS_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('COUNTRY_REGION_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('CUSTOMERS_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('TRANSACTIONS_TABLE')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from raw_data.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('PRODUCTS_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('COUNTRY_REGION_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('CUSTOMERS_TABLE')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('TRANSACTIONS_TABLE')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:21:49.011566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:51.576272 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 3.0 seconds
[0m18:21:51.582272 [debug] [ThreadPool]: On raw_data.information_schema: Close
[0m18:21:51.746924 [info ] [MainThread]: Catalog written to C:\Users\TottaraDhanush\DBT\mini_project_dbt\target\catalog.json
[0m18:21:51.748927 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:21:51.747926 after 11.99 seconds
[0m18:21:51.748927 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:21:51.748927 [debug] [MainThread]: Connection 'raw_data.information_schema' was properly closed.
[0m18:21:51.749958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB146F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB0F8C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB0FB0A10>]}
[0m18:21:51.749958 [debug] [MainThread]: Flushing usage events
[0m18:22:06.040239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510D9874D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510D986AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510D9870E0>]}


============================== 18:22:06.054089 | 8b90801c-c373-465f-b8f1-a47faccd57c3 ==============================
[0m18:22:06.054089 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:22:06.055002 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:22:06.562469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b90801c-c373-465f-b8f1-a47faccd57c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510D9870E0>]}
[0m18:22:06.664096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b90801c-c373-465f-b8f1-a47faccd57c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510F51D280>]}
[0m18:22:33.273455 [error] [MainThread]: Encountered an error:

[0m18:22:33.375801 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "c:\Users\TottaraDhanush\DBT\.venv\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TottaraDhanush\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:22:33.377799 [debug] [MainThread]: Command `dbt docs serve` failed at 18:22:33.376764 after 27.42 seconds
[0m18:22:33.377799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510D9845C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510DA672C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001510F5A8A70>]}
[0m18:22:33.378799 [debug] [MainThread]: Flushing usage events
[0m18:37:38.088929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014681B5A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014681B5B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014681B5A900>]}


============================== 18:37:38.102270 | 6fce4baa-059b-46f0-97ba-b17fcf0dd908 ==============================
[0m18:37:38.102270 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:37:38.103759 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:37:39.005644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014682461220>]}
[0m18:37:39.105309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014681757EC0>]}
[0m18:37:39.107282 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:37:39.131678 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:37:40.432443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:37:40.433443 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:37:40.606919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:37:40.612952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014683BC74D0>]}
[0m18:37:40.641392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014683928230>]}
[0m18:37:40.642393 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:37:40.642393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014683AECBF0>]}
[0m18:37:40.645393 [info ] [MainThread]: 
[0m18:37:40.647394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:40.648392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:37:40.663393 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:37:40.664392 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:37:40.664392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:42.498114 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m18:37:42.500113 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:37:42.662462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m18:37:42.672462 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:37:42.673462 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:37:42.673462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:43.259460 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:37:43.261456 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:37:43.403026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m18:37:43.407056 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:37:43.408025 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:37:43.408025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:44.003011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:37:44.010012 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:37:44.161136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001468385AC30>]}
[0m18:37:44.162156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:44.162156 [info ] [MainThread]: 
[0m18:37:44.188992 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:37:44.188992 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:37:44.190995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:37:44.191990 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:37:44.202508 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:37:44.204547 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:37:44.191990 => 18:37:44.203511
[0m18:37:44.204547 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:37:44.241543 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:37:44.245013 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:37:44.246016 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
FROM revenue_change_lm
GROUP BY month 
UNION ALL
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_3_months
FROM revenue_change_l3t
GROUP BY month
UNION ALL
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_12_months
FROM revenue_change_ltm
GROUP BY month
ORDER BY month
        );
[0m18:37:44.246016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:45.602790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:45.627377 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:37:44.205543 => 18:37:45.626376
[0m18:37:45.627377 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:37:45.763719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fce4baa-059b-46f0-97ba-b17fcf0dd908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014683D40800>]}
[0m18:37:45.765719 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.57s]
[0m18:37:45.767682 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:37:45.772120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:45.772120 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:37:45.773120 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m18:37:45.774115 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:37:45.775120 [info ] [MainThread]: 
[0m18:37:45.776078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m18:37:45.777072 [debug] [MainThread]: Command end result
[0m18:37:45.837480 [info ] [MainThread]: 
[0m18:37:45.837480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:45.838530 [info ] [MainThread]: 
[0m18:37:45.839529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:37:45.840488 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:45.840488 after 7.87 seconds
[0m18:37:45.841515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146817090A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014681738230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014683784140>]}
[0m18:37:45.841515 [debug] [MainThread]: Flushing usage events
[0m18:39:18.486235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E1EA300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E1EA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E1E9D30>]}


============================== 18:39:18.491271 | e23b2cca-0faf-4d18-bc14-863f52f79632 ==============================
[0m18:39:18.491271 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:39:18.492235 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:39:19.094690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E26ABA0>]}
[0m18:39:19.198300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E24A060>]}
[0m18:39:19.200297 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:39:19.220308 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:39:20.502597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:20.503597 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:39:20.666175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:39:20.672142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C601C4EC0>]}
[0m18:39:20.698144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5FFC0920>]}
[0m18:39:20.699143 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:39:20.700142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5FA792B0>]}
[0m18:39:20.702176 [info ] [MainThread]: 
[0m18:39:20.703175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:39:20.704177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:39:20.720221 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:39:20.721217 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:39:20.721217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:21.833352 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:39:21.835351 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:39:21.971870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m18:39:21.982872 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:39:21.983872 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:39:21.983872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:22.497147 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:39:22.503155 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:39:22.648639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m18:39:22.652640 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:39:22.652640 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:39:22.653648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:23.071294 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:39:23.074265 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:39:23.220293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C6030DE20>]}
[0m18:39:23.221331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:23.222339 [info ] [MainThread]: 
[0m18:39:23.229223 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:39:23.230224 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:39:23.232741 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:39:23.232741 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:39:23.243786 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:39:23.245777 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:39:23.233793 => 18:39:23.244785
[0m18:39:23.246809 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:39:23.281753 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:39:23.286785 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:39:23.286785 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_12_months
FROM revenue_change_lm
GROUP BY month 
UNION ALL
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_12_months
FROM revenue_change_l3t
GROUP BY month
UNION ALL
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_12_months
FROM revenue_change_ltm
GROUP BY month
ORDER BY month
        );
[0m18:39:23.287785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:39:24.039271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b5-0001-087f-0000-50e90002adee
[0m18:39:24.040271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 4 unexpected 'SUM'.
syntax error line 51 at position 4 unexpected 'SUM'.
[0m18:39:24.041271 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:39:23.246809 => 18:39:24.040271
[0m18:39:24.041271 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:39:24.226025 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 51 at position 4 unexpected 'SUM'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:39:24.226025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23b2cca-0faf-4d18-bc14-863f52f79632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C603AFAA0>]}
[0m18:39:24.227027 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.99s]
[0m18:39:24.228027 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:39:24.232028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:24.232028 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:39:24.233028 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m18:39:24.233028 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:39:24.233028 [info ] [MainThread]: 
[0m18:39:24.235026 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m18:39:24.236045 [debug] [MainThread]: Command end result
[0m18:39:24.250555 [info ] [MainThread]: 
[0m18:39:24.251556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:24.252553 [info ] [MainThread]: 
[0m18:39:24.254553 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 51 at position 4 unexpected 'SUM'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:39:24.255578 [info ] [MainThread]: 
[0m18:39:24.256557 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:39:24.257569 [debug] [MainThread]: Command `dbt run` failed at 18:39:24.257569 after 5.89 seconds
[0m18:39:24.258553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5DF2CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E1E9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C5E1E9D30>]}
[0m18:39:24.258553 [debug] [MainThread]: Flushing usage events
[0m18:40:32.041089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DABE6A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DABE6A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DABE69D00>]}


============================== 18:40:32.047122 | dfaaedc7-b778-4ce1-a00d-45d6df0f03a4 ==============================
[0m18:40:32.047122 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:40:32.048086 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:40:32.562817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DAC900920>]}
[0m18:40:32.663442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DABE99E20>]}
[0m18:40:32.665084 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:40:32.673865 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:40:32.786518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:32.787519 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:40:32.946702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:40:32.952669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DAC8E2810>]}
[0m18:40:32.966670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DADC5C1A0>]}
[0m18:40:32.967674 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:40:32.968704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DADE0BDD0>]}
[0m18:40:32.970702 [info ] [MainThread]: 
[0m18:40:32.971668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:40:32.973702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:40:32.988705 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:40:32.989702 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:40:32.989702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:34.482499 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:40:34.488500 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:40:34.648751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m18:40:34.663788 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:40:34.663788 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:40:34.664788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:36.009954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:40:36.016968 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:40:36.175091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m18:40:36.189661 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:40:36.190661 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:40:36.192662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:36.893604 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:40:36.895637 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:40:37.036236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DADF5FFE0>]}
[0m18:40:37.037236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:37.038246 [info ] [MainThread]: 
[0m18:40:37.042236 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:40:37.042236 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:40:37.043241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:40:37.044240 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:40:37.055239 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:40:37.057239 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:40:37.044240 => 18:40:37.057239
[0m18:40:37.058238 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:40:37.093251 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:40:37.096238 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:40:37.097238 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss > 0 THEN revenue_loss ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm
join revenue_change_l3t
on revenue_change_lm.customer_id = revenue_change_l3t.customer_id
join revenue_change_ltm
on revenue_change_lm.customer_id = revenue_change_ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:40:37.098261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:40:37.715592 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b6-0001-086e-0000-50e900030706
[0m18:40:37.716626 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 4 unexpected 'SUM'.
syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
[0m18:40:37.717626 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:40:37.058238 => 18:40:37.716626
[0m18:40:37.717626 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:40:37.901867 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:40:37.908868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfaaedc7-b778-4ce1-a00d-45d6df0f03a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DADF21F70>]}
[0m18:40:37.909868 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.87s]
[0m18:40:37.910868 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:40:37.912869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:37.913865 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:40:37.913865 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m18:40:37.914868 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:40:37.914868 [info ] [MainThread]: 
[0m18:40:37.915866 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m18:40:37.916868 [debug] [MainThread]: Command end result
[0m18:40:37.929876 [info ] [MainThread]: 
[0m18:40:37.930876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:37.930876 [info ] [MainThread]: 
[0m18:40:37.931878 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:40:37.931878 [info ] [MainThread]: 
[0m18:40:37.933385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:40:37.934394 [debug] [MainThread]: Command `dbt run` failed at 18:40:37.934394 after 5.98 seconds
[0m18:40:37.935393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DAB8A8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DABEC1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DADF070B0>]}
[0m18:40:37.935393 [debug] [MainThread]: Flushing usage events
[0m18:42:21.081736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107E1B320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107E1A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107E19220>]}


============================== 18:42:21.087769 | 2b6c0c4b-58ce-4215-a671-45cda8e76770 ==============================
[0m18:42:21.087769 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:42:21.088737 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:42:21.604296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B10776A660>]}
[0m18:42:21.704456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107EFCD70>]}
[0m18:42:21.705989 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:42:21.715029 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:42:21.826736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:21.827771 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:42:21.982384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:42:21.988396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B109A85E20>]}
[0m18:42:22.003401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B109BEFDD0>]}
[0m18:42:22.003401 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:42:22.004921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B109962ED0>]}
[0m18:42:22.006929 [info ] [MainThread]: 
[0m18:42:22.007937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:42:22.009962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:42:22.025978 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:42:22.025978 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:42:22.026963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:23.190991 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:42:23.193024 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:42:23.386950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m18:42:23.408907 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:42:23.409905 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:42:23.410902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:23.992502 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:42:23.999515 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:42:24.151933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m18:42:24.165943 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:42:24.167921 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:42:24.169920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:24.578071 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:42:24.581070 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:42:24.737766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107F7AEA0>]}
[0m18:42:24.740749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:24.743768 [info ] [MainThread]: 
[0m18:42:24.753688 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:42:24.754722 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:42:24.756739 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:42:24.756739 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:42:24.767719 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:42:24.768719 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:42:24.757688 => 18:42:24.768719
[0m18:42:24.769719 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:42:24.804721 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:42:24.807720 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:42:24.808719 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm
join revenue_change_l3t
on revenue_change_lm.customer_id = revenue_change_l3t.customer_id
join revenue_change_ltm
on revenue_change_lm.customer_id = revenue_change_ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:42:24.808719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:25.379060 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b8-0001-085a-0000-50e90002f7aa
[0m18:42:25.379060 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 4 unexpected 'SUM'.
syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
[0m18:42:25.380093 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:42:24.769719 => 18:42:25.380093
[0m18:42:25.380093 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:42:25.542478 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:42:25.544493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b6c0c4b-58ce-4215-a671-45cda8e76770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B10A05A330>]}
[0m18:42:25.546480 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.79s]
[0m18:42:25.549481 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:42:25.554458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:25.555463 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:42:25.556457 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m18:42:25.557457 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:42:25.557457 [info ] [MainThread]: 
[0m18:42:25.559416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m18:42:25.561417 [debug] [MainThread]: Command end result
[0m18:42:25.574417 [info ] [MainThread]: 
[0m18:42:25.591769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:42:25.592760 [info ] [MainThread]: 
[0m18:42:25.593759 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'revenue_change_lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:42:25.594722 [info ] [MainThread]: 
[0m18:42:25.596728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:42:25.598728 [debug] [MainThread]: Command `dbt run` failed at 18:42:25.597724 after 4.60 seconds
[0m18:42:25.598728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107E18740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B107892DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B109A16D50>]}
[0m18:42:25.599753 [debug] [MainThread]: Flushing usage events
[0m18:44:29.545963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95ED0A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95ED0A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95ED082C0>]}


============================== 18:44:29.551964 | 87b5e70d-bf9b-475a-b7de-b2be244efb0f ==============================
[0m18:44:29.551964 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:44:29.552963 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:44:30.062989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F57B230>]}
[0m18:44:30.165613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96080C9B0>]}
[0m18:44:30.167358 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:44:30.176551 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:44:30.289767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:30.290769 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:44:30.443954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:44:30.450351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F960D67290>]}
[0m18:44:30.462493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F960AD7F20>]}
[0m18:44:30.463526 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:44:30.465490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95ECD5CD0>]}
[0m18:44:30.467553 [info ] [MainThread]: 
[0m18:44:30.468492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:30.470492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:44:30.486490 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:44:30.486490 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:44:30.487524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:31.423103 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:44:31.426089 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:44:31.569260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m18:44:31.581259 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:44:31.582259 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:44:31.582259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:31.974516 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:44:31.980499 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:44:32.125072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m18:44:32.137723 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:44:32.137723 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:44:32.137723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:32.834040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:44:32.840693 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:44:32.991529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F57BFB0>]}
[0m18:44:32.992583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:32.993582 [info ] [MainThread]: 
[0m18:44:32.999814 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:44:32.999814 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:44:33.001777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:44:33.002815 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:44:33.015814 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:44:33.017774 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:44:33.003777 => 18:44:33.017774
[0m18:44:33.018807 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:44:33.053389 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:44:33.056355 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:44:33.057357 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm lm
join revenue_change_l3t l3m
on lm.customer_id = l3t.customer_id
join revenue_change_ltm ltm
on lm.customer_id = ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:44:33.058359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:33.625554 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ba-0001-086e-0000-50e90003070e
[0m18:44:33.626543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 43 at position 4 unexpected 'SUM'.
syntax error line 47 at position 3 unexpected 'lm'.
[0m18:44:33.627543 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:44:33.018807 => 18:44:33.626543
[0m18:44:33.627543 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:44:33.773289 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:44:33.774289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5e70d-bf9b-475a-b7de-b2be244efb0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95DC78CB0>]}
[0m18:44:33.775290 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.77s]
[0m18:44:33.777327 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:44:33.781330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:33.781330 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:44:33.782328 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m18:44:33.782328 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:44:33.783325 [info ] [MainThread]: 
[0m18:44:33.784290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m18:44:33.786290 [debug] [MainThread]: Command end result
[0m18:44:33.802324 [info ] [MainThread]: 
[0m18:44:33.803286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:33.803286 [info ] [MainThread]: 
[0m18:44:33.804321 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 43 at position 4 unexpected 'SUM'.
  syntax error line 47 at position 3 unexpected 'lm'.
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:44:33.805286 [info ] [MainThread]: 
[0m18:44:33.806309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:44:33.808293 [debug] [MainThread]: Command `dbt run` failed at 18:44:33.807298 after 4.35 seconds
[0m18:44:33.808293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95E9FCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95E832B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F750560>]}
[0m18:44:33.809287 [debug] [MainThread]: Flushing usage events
[0m18:52:20.296876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA50B8ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA50B8A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA50B8A480>]}


============================== 18:52:20.302882 | 1ed4f55e-8985-4c06-a892-9cb318102721 ==============================
[0m18:52:20.302882 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:52:20.303845 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:52:20.836392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA51601DF0>]}
[0m18:52:20.938544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA4FD890A0>]}
[0m18:52:20.939864 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:52:20.948385 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:52:21.064424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:21.065423 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m18:52:21.224050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:52:21.230051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA5292C530>]}
[0m18:52:21.243058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA52960AD0>]}
[0m18:52:21.243058 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:52:21.244057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA52B644D0>]}
[0m18:52:21.245598 [info ] [MainThread]: 
[0m18:52:21.246605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:21.248639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:52:21.264640 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:52:21.264640 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:52:21.265639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:22.560749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:52:22.562740 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:52:22.719233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m18:52:22.745222 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:52:22.746222 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:52:22.746222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:23.465868 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:52:23.467904 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:52:23.613786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m18:52:23.616819 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:52:23.617820 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:52:23.617820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:24.152576 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:52:24.154576 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:52:24.308566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA51448230>]}
[0m18:52:24.312613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:24.314550 [info ] [MainThread]: 
[0m18:52:24.318464 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m18:52:24.319489 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m18:52:24.320464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m18:52:24.321491 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m18:52:24.330464 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m18:52:24.332466 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 18:52:24.321491 => 18:52:24.331465
[0m18:52:24.333499 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m18:52:24.367497 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m18:52:24.370507 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m18:52:24.371504 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id,
        SUM(revenue) AS total_revenue,
        CASE 
            WHEN MIN(is_new_customer) = 1 THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  -- Reference to the transactions staging table
    GROUP BY month, customer_id
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue)  -- Starting month
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  -- Assuming negative revenue indicates churn
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  -- Assuming positive revenue indicates expansion
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    month,
    starting_mrr,
    churned_mrr,
    expansion_mrr,
    (grr / NULLIF(starting_mrr, 0)) * 100 AS grr_percentage,
    (nrr / NULLIF(starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr
ORDER BY month;
[0m18:52:24.371504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:24.762265 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c2-0001-085a-0000-50e90002f7ba
[0m18:52:24.763268 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 14 unexpected ';'.
[0m18:52:24.764303 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 18:52:24.333499 => 18:52:24.763268
[0m18:52:24.764303 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m18:52:24.917930 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m18:52:24.919935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ed4f55e-8985-4c06-a892-9cb318102721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA52DAC4D0>]}
[0m18:52:24.920929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 0.60s]
[0m18:52:24.923913 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m18:52:24.927907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:24.928907 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:52:24.929911 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m18:52:24.929911 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m18:52:24.930908 [info ] [MainThread]: 
[0m18:52:24.931848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m18:52:24.933857 [debug] [MainThread]: Command end result
[0m18:52:24.946857 [info ] [MainThread]: 
[0m18:52:24.947891 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:52:24.948855 [info ] [MainThread]: 
[0m18:52:24.949803 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m18:52:24.956567 [info ] [MainThread]: 
[0m18:52:24.957601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:52:24.959565 [debug] [MainThread]: Command `dbt run` failed at 18:52:24.959565 after 4.75 seconds
[0m18:52:24.959565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA50A5B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA507DDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA507BC5F0>]}
[0m18:52:24.960600 [debug] [MainThread]: Flushing usage events
[0m18:53:50.905403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1CABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1CA630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1CA4E0>]}


============================== 18:53:50.910391 | ac03fb4e-75c0-4a61-ab5e-85444bc8b05c ==============================
[0m18:53:50.910391 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:53:50.911392 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:53:51.512688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ACA697F0>]}
[0m18:53:51.618313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ACBC67B0>]}
[0m18:53:51.619313 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:53:51.641286 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:53:52.983497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:52.984497 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:53:53.151245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:53:53.157245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AE2571A0>]}
[0m18:53:53.183282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4ADFB8380>]}
[0m18:53:53.184280 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:53:53.185251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AE17DC10>]}
[0m18:53:53.186280 [info ] [MainThread]: 
[0m18:53:53.188279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:53.189164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:53:53.205174 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:53:53.206173 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:53:53.206173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:54.242644 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:53:54.248728 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:53:54.398893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m18:53:54.409875 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:53:54.410875 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:53:54.410875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:54.853603 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:53:54.856563 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:53:55.004013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m18:53:55.013004 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:53:55.013004 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:53:55.014005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:55.620440 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:53:55.621435 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:53:55.772518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AE283830>]}
[0m18:53:55.776506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:55.778504 [info ] [MainThread]: 
[0m18:53:55.791617 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:53:55.794561 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:53:55.796556 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:53:55.797578 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:53:55.807542 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:53:55.809544 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:53:55.797578 => 18:53:55.808543
[0m18:53:55.809544 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:53:55.845576 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:53:55.848576 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:53:55.849544 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost,
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months,
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm lm
join revenue_change_l3t l3m
on lm.customer_id = l3t.customer_id
join revenue_change_ltm ltm
on lm.customer_id = ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:53:55.850543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:56.486419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c3-0001-085a-0000-50e90002f7c6
[0m18:53:56.486419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'MONTH'
[0m18:53:56.487420 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:53:55.809544 => 18:53:56.487420
[0m18:53:56.488432 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:53:56.655349 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'MONTH'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:53:56.656348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac03fb4e-75c0-4a61-ab5e-85444bc8b05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AE44A1B0>]}
[0m18:53:56.657349 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.86s]
[0m18:53:56.658348 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:53:56.661349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:56.662384 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:53:56.662384 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m18:53:56.663384 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:53:56.663384 [info ] [MainThread]: 
[0m18:53:56.664393 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m18:53:56.666349 [debug] [MainThread]: Command end result
[0m18:53:56.679897 [info ] [MainThread]: 
[0m18:53:56.680905 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:53:56.680905 [info ] [MainThread]: 
[0m18:53:56.681900 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'MONTH'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:53:56.682901 [info ] [MainThread]: 
[0m18:53:56.683866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:53:56.685900 [debug] [MainThread]: Command `dbt run` failed at 18:53:56.685900 after 5.90 seconds
[0m18:53:56.686901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1C9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1CA630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4AC1CABD0>]}
[0m18:53:56.687903 [debug] [MainThread]: Flushing usage events
[0m18:54:38.736842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D62A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D62A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D62A180>]}


============================== 18:54:38.749227 | 9f735bed-f1d5-426f-854a-c97baaaa77d7 ==============================
[0m18:54:38.749227 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:54:38.750222 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m18:54:39.571794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F277080>]}
[0m18:54:39.675421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D79AEA0>]}
[0m18:54:39.676920 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:54:39.691486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:54:39.832959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:39.832959 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:54:40.006899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:54:40.013115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F3A8F80>]}
[0m18:54:40.027079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F41BE30>]}
[0m18:54:40.027079 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:54:40.029083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F1ED700>]}
[0m18:54:40.031083 [info ] [MainThread]: 
[0m18:54:40.031838 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:40.033846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:54:40.048846 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:54:40.049889 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:54:40.050847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:41.331505 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:54:41.340559 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:54:41.506021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m18:54:41.517030 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:54:41.517030 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:54:41.518033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:42.120189 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:54:42.123159 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:54:42.266255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m18:54:42.276317 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:54:42.278319 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:54:42.279321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:42.689163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:54:42.691676 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:54:42.837134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F66F380>]}
[0m18:54:42.840188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:42.842149 [info ] [MainThread]: 
[0m18:54:42.870514 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:54:42.871554 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:54:42.873550 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:54:42.874551 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:54:42.885558 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:54:42.886590 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:54:42.874551 => 18:54:42.886590
[0m18:54:42.887558 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:54:42.922168 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:54:42.925171 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:54:42.926168 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost,
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months,
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm lm
join revenue_change_l3t l3m
on lm.customer_id = l3t.customer_id
join revenue_change_ltm ltm
on lm.customer_id = ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:54:42.927169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:43.386428 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c4-0001-086e-0000-50e90003071a
[0m18:54:43.387424 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 20
invalid identifier 'L3T.CUSTOMER_ID'
[0m18:54:43.388467 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:54:42.887558 => 18:54:43.387424
[0m18:54:43.389465 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:54:43.563634 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 45 at position 20
  invalid identifier 'L3T.CUSTOMER_ID'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:54:43.566644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f735bed-f1d5-426f-854a-c97baaaa77d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96F85B710>]}
[0m18:54:43.568643 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.revenue_loss ................... [[31mERROR[0m in 0.69s]
[0m18:54:43.572648 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:54:43.579685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:43.579685 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:54:43.580687 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m18:54:43.581685 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:54:43.582683 [info ] [MainThread]: 
[0m18:54:43.583635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m18:54:43.584634 [debug] [MainThread]: Command end result
[0m18:54:43.598462 [info ] [MainThread]: 
[0m18:54:43.599465 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:54:43.600463 [info ] [MainThread]: 
[0m18:54:43.601461 [error] [MainThread]:   Database Error in model revenue_loss (models\transform\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 45 at position 20
  invalid identifier 'L3T.CUSTOMER_ID'
  compiled Code at target\run\mini_project_dbt\models\transform\revenue_loss.sql
[0m18:54:43.602461 [info ] [MainThread]: 
[0m18:54:43.603095 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:54:43.604102 [debug] [MainThread]: Command `dbt run` failed at 18:54:43.604102 after 4.96 seconds
[0m18:54:43.605136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D5379B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D19B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96D62A900>]}
[0m18:54:43.605136 [debug] [MainThread]: Flushing usage events
[0m18:55:27.559405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5B679550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5B679A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5B678B00>]}


============================== 18:55:27.564438 | ec26fe5b-aa1b-4163-a2bc-cf6459d223e3 ==============================
[0m18:55:27.564438 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:55:27.565423 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m18:55:28.084843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5B7DAF00>]}
[0m18:55:28.187464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D16C350>]}
[0m18:55:28.189433 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:55:28.198465 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:55:28.311206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:28.312206 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m18:55:28.469450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m18:55:28.476451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D605370>]}
[0m18:55:28.488402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D4B4B00>]}
[0m18:55:28.488402 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m18:55:28.489437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D40E6F0>]}
[0m18:55:28.491401 [info ] [MainThread]: 
[0m18:55:28.493429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:28.494440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m18:55:28.510435 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m18:55:28.511434 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m18:55:28.511434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:29.465077 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:55:29.470078 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m18:55:29.618428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m18:55:29.630424 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m18:55:29.631423 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m18:55:29.631423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:30.215177 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:55:30.217173 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m18:55:30.373209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m18:55:30.376208 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m18:55:30.376208 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m18:55:30.377211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:30.927426 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:55:30.929461 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m18:55:31.075263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D6A37D0>]}
[0m18:55:31.076263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:31.077295 [info ] [MainThread]: 
[0m18:55:31.081239 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m18:55:31.082258 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m18:55:31.083228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m18:55:31.084263 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m18:55:31.095272 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m18:55:31.097272 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 18:55:31.085231 => 18:55:31.096272
[0m18:55:31.097272 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m18:55:31.132816 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m18:55:31.136816 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m18:55:31.136816 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost,
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months,
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm lm
join revenue_change_l3t l3m
on lm.customer_id = l3m.customer_id
join revenue_change_ltm ltm
on lm.customer_id = ltm.customer_id
GROUP BY month
ORDER BY month
        );
[0m18:55:31.137816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:55:32.898675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:55:32.944308 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 18:55:31.098272 => 18:55:32.943309
[0m18:55:32.944308 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m18:55:33.089286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec26fe5b-aa1b-4163-a2bc-cf6459d223e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5D8E8530>]}
[0m18:55:33.092290 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 2.01s]
[0m18:55:33.096314 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m18:55:33.104133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:33.106132 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m18:55:33.106132 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m18:55:33.107103 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m18:55:33.107103 [info ] [MainThread]: 
[0m18:55:33.107103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m18:55:33.109654 [debug] [MainThread]: Command end result
[0m18:55:33.171655 [info ] [MainThread]: 
[0m18:55:33.172619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:33.172619 [info ] [MainThread]: 
[0m18:55:33.173653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:33.175645 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:33.174665 after 5.70 seconds
[0m18:55:33.175645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5B1B2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5BA47C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A5BEE02F0>]}
[0m18:55:33.175645 [debug] [MainThread]: Flushing usage events
[0m19:00:25.746619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE61E9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE61E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE61E9850>]}


============================== 19:00:25.751650 | 91a8bd1b-a291-4671-84d0-bf4c65415ab9 ==============================
[0m19:00:25.751650 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:00:25.752663 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:00:26.287307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE5E92330>]}
[0m19:00:26.387829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE6B4E660>]}
[0m19:00:26.389227 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:00:26.397741 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:00:26.511744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:26.512746 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m19:00:26.669632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:00:26.675936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE817D220>]}
[0m19:00:26.688971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE8014B60>]}
[0m19:00:26.689971 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:00:26.689971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE7DE6F60>]}
[0m19:00:26.692971 [info ] [MainThread]: 
[0m19:00:26.693970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:26.695970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:00:26.711977 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:00:26.713009 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:00:26.713009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:27.934564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:00:27.936564 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:00:28.087843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m19:00:28.105816 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:00:28.106781 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:00:28.106781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:28.692343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:00:28.699339 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:00:28.896350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m19:00:28.899350 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:00:28.900351 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:00:28.901352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:29.475212 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:00:29.477173 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:00:29.686455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE82837D0>]}
[0m19:00:29.687458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:29.688459 [info ] [MainThread]: 
[0m19:00:29.692631 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m19:00:29.693659 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m19:00:29.694664 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m19:00:29.694664 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m19:00:29.703665 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m19:00:29.704685 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 19:00:29.695657 => 19:00:29.704685
[0m19:00:29.705631 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m19:00:29.740665 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m19:00:29.744635 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m19:00:29.745638 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3t AS (
    SELECT
        customer_id,
        month as month_l3t,
        total_revenue,
        LAG(total_revenue,3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month as month_ltm,
        total_revenue,
        LAG(total_revenue,12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (previous_revenue-total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    month,
    SUM(CASE WHEN revenue_loss_lm > 0 THEN revenue_loss_lm ELSE 0 END) AS total_revenue_lost,
    SUM(CASE WHEN revenue_loss_l3m > 0 THEN revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months,
    SUM(CASE WHEN revenue_loss_ltm > 0 THEN revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
from revenue_change_lm lm
join revenue_change_l3t l3m
on lm.customer_id = l3m.customer_id
join revenue_change_ltm ltm
on lm.customer_id = ltm.customer_id
GROUP BY month,month_l3t,month_ltm
ORDER BY month
        );
[0m19:00:29.745638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:33.345253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m19:00:33.371265 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 19:00:29.705631 => 19:00:33.371265
[0m19:00:33.371265 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m19:00:33.519794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91a8bd1b-a291-4671-84d0-bf4c65415ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE83F05C0>]}
[0m19:00:33.522794 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 3.83s]
[0m19:00:33.526793 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m19:00:33.534742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:33.536736 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:00:33.537741 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m19:00:33.539744 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m19:00:33.540742 [info ] [MainThread]: 
[0m19:00:33.543734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m19:00:33.546730 [debug] [MainThread]: Command end result
[0m19:00:33.617379 [info ] [MainThread]: 
[0m19:00:33.618377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:33.618377 [info ] [MainThread]: 
[0m19:00:33.619381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:33.621380 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:33.621380 after 7.96 seconds
[0m19:00:33.621380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE7E7A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE6580A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EE6B4E660>]}
[0m19:00:33.622378 [debug] [MainThread]: Flushing usage events
[0m19:03:52.122255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0878FA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0878FAE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0878F8DA0>]}


============================== 19:03:52.133254 | e1f92b5e-d838-4d70-a5ef-29cfccf54852 ==============================
[0m19:03:52.133254 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:03:52.134254 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m revenue_loss', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:03:52.919682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D089549F40>]}
[0m19:03:53.024175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08948FDD0>]}
[0m19:03:53.025494 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:03:53.036404 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:03:53.185883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:03:53.186885 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:03:53.187885 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\revenue_loss.sql
[0m19:03:53.357875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:03:53.364917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0895E9820>]}
[0m19:03:53.378679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0896B4080>]}
[0m19:03:53.378679 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:03:53.379712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D087A0BB90>]}
[0m19:03:53.381713 [info ] [MainThread]: 
[0m19:03:53.382562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:03:53.384605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:03:53.399622 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:03:53.399622 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:03:53.400626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:54.451821 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:03:54.452821 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:03:54.600203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m19:03:54.611201 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:03:54.611201 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:03:54.611201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:55.153422 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:03:55.155439 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:03:55.297021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m19:03:55.300063 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:03:55.301064 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:03:55.302062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:55.721281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:03:55.723246 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:03:55.864062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08961E870>]}
[0m19:03:55.865064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:55.865064 [info ] [MainThread]: 
[0m19:03:55.870061 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.revenue_loss
[0m19:03:55.871063 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.revenue_loss ............................ [RUN]
[0m19:03:55.872062 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.revenue_loss'
[0m19:03:55.873063 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.revenue_loss
[0m19:03:55.884065 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.revenue_loss"
[0m19:03:55.886061 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (compile): 19:03:55.873063 => 19:03:55.885063
[0m19:03:55.886061 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.revenue_loss
[0m19:03:55.922637 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.revenue_loss"
[0m19:03:55.926596 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.revenue_loss"
[0m19:03:55.927596 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.revenue_loss"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.revenue_loss
         as
        (

WITH customer_revenue AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', transaction_date) AS month,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table
    GROUP BY customer_id, month
),
revenue_change_lm AS (
    SELECT
        customer_id,
        month,
        total_revenue,
        LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (LAG(total_revenue) OVER (PARTITION BY customer_id ORDER BY month) - total_revenue) AS revenue_loss_lm
    FROM customer_revenue
),
revenue_change_l3m AS (
    SELECT
        customer_id,
        month AS month_l3m,
        total_revenue,
        LAG(total_revenue, 3) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (LAG(total_revenue, 3) OVER (PARTITION BY customer_id ORDER BY month) - total_revenue) AS revenue_loss_l3m
    FROM customer_revenue
),
revenue_change_ltm AS (
    SELECT
        customer_id,
        month AS month_ltm,
        total_revenue,
        LAG(total_revenue, 12) OVER (PARTITION BY customer_id ORDER BY month) AS previous_revenue,
        (LAG(total_revenue, 12) OVER (PARTITION BY customer_id ORDER BY month) - total_revenue) AS revenue_loss_ltm
    FROM customer_revenue
)
SELECT
    lm.month,
    SUM(CASE WHEN lm.revenue_loss_lm > 0 THEN lm.revenue_loss_lm ELSE 0 END) AS total_revenue_lost,
    SUM(CASE WHEN l3m.revenue_loss_l3m > 0 THEN l3m.revenue_loss_l3m ELSE 0 END) AS total_revenue_lost_3_months,
    SUM(CASE WHEN ltm.revenue_loss_ltm > 0 THEN ltm.revenue_loss_ltm ELSE 0 END) AS total_revenue_lost_12_months
FROM revenue_change_lm lm
LEFT JOIN revenue_change_l3m l3m ON lm.customer_id = l3m.customer_id AND lm.month = l3m.month_l3m
LEFT JOIN revenue_change_ltm ltm ON lm.customer_id = ltm.customer_id AND lm.month = ltm.month_ltm
GROUP BY lm.month
ORDER BY lm.month
        );
[0m19:03:55.928595 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:03:56.936367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:03:56.961358 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.revenue_loss (execute): 19:03:55.887063 => 19:03:56.961358
[0m19:03:56.962357 [debug] [Thread-1 (]: On model.mini_project_dbt.revenue_loss: Close
[0m19:03:57.106345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1f92b5e-d838-4d70-a5ef-29cfccf54852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D089AE44A0>]}
[0m19:03:57.108347 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.revenue_loss ....................... [[32mSUCCESS 1[0m in 1.23s]
[0m19:03:57.111348 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.revenue_loss
[0m19:03:57.116448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:57.117524 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:03:57.118524 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m19:03:57.119524 [debug] [MainThread]: Connection 'model.mini_project_dbt.revenue_loss' was properly closed.
[0m19:03:57.119524 [info ] [MainThread]: 
[0m19:03:57.120496 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m19:03:57.121526 [debug] [MainThread]: Command end result
[0m19:03:57.184458 [info ] [MainThread]: 
[0m19:03:57.185494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:57.186575 [info ] [MainThread]: 
[0m19:03:57.187582 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:03:57.188616 [debug] [MainThread]: Command `dbt run` succeeded at 19:03:57.188616 after 5.16 seconds
[0m19:03:57.188616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0877E9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0898A6E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0898A47D0>]}
[0m19:03:57.189619 [debug] [MainThread]: Flushing usage events
[0m19:06:27.777943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E01DA420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E01DA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E01D9DF0>]}


============================== 19:06:27.782975 | a15ef8ad-56c2-465d-99d1-0b5ad23ad503 ==============================
[0m19:06:27.782975 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:06:27.783976 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m19:06:28.310416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E001DF10>]}
[0m19:06:28.411040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E133A2D0>]}
[0m19:06:28.413006 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:06:28.422040 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:06:28.550328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:28.550328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:28.551328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:06:28.558368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E020B3B0>]}
[0m19:06:28.570883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E20341D0>]}
[0m19:06:28.570883 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:06:28.571917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E1DACD70>]}
[0m19:06:28.573915 [info ] [MainThread]: 
[0m19:06:28.575896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:06:28.577883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:06:28.594919 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:06:28.595915 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:06:28.595915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:29.606709 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:06:29.613710 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:06:29.762441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m19:06:29.772484 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:06:29.772484 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:06:29.773485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:30.324586 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:06:30.330586 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:06:30.483984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m19:06:30.493564 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:06:30.494566 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:06:30.495565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:31.091015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:06:31.098010 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:06:31.258544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E1E07680>]}
[0m19:06:31.259585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:06:31.259585 [info ] [MainThread]: 
[0m19:06:31.264549 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:06:31.264549 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:06:31.266578 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:06:31.266578 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:06:31.276599 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:06:31.277561 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:06:31.266578 => 19:06:31.277561
[0m19:06:31.278593 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:06:31.313176 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:06:31.316176 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:06:31.317175 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id,
        SUM(revenue) AS total_revenue,
        CASE 
            WHEN MIN(is_new_customer) = 1 THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY month, customer_id
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    month,
    starting_mrr,
    churned_mrr,
    expansion_mrr,
    (grr / NULLIF(starting_mrr, 0)) * 100 AS grr_percentage,
    (nrr / NULLIF(starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr
ORDER BY month
        );
[0m19:06:31.317175 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:31.830173 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d0-0001-087f-0000-50e90002ae42
[0m19:06:31.831177 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 21
invalid identifier 'IS_NEW_CUSTOMER'
[0m19:06:31.832174 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:06:31.278593 => 19:06:31.832174
[0m19:06:31.833168 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:06:32.005984 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 9 at position 21
  invalid identifier 'IS_NEW_CUSTOMER'
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:06:32.006983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15ef8ad-56c2-465d-99d1-0b5ad23ad503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E219A5A0>]}
[0m19:06:32.006983 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 0.74s]
[0m19:06:32.008950 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:06:32.010950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:32.011950 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:06:32.011950 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m19:06:32.011950 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:06:32.012949 [info ] [MainThread]: 
[0m19:06:32.013737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m19:06:32.014748 [debug] [MainThread]: Command end result
[0m19:06:32.026780 [info ] [MainThread]: 
[0m19:06:32.027743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:06:32.028747 [info ] [MainThread]: 
[0m19:06:32.029759 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 9 at position 21
  invalid identifier 'IS_NEW_CUSTOMER'
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:06:32.029759 [info ] [MainThread]: 
[0m19:06:32.030745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:06:32.032775 [debug] [MainThread]: Command `dbt run` failed at 19:06:32.031746 after 4.34 seconds
[0m19:06:32.032775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257DFBD90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E1DAC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E1E06CF0>]}
[0m19:06:32.032775 [debug] [MainThread]: Flushing usage events
[0m19:11:42.030451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318B5A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318B59DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318B597F0>]}


============================== 19:11:42.036107 | 625ce59e-5902-4696-9f5d-8988c68d5831 ==============================
[0m19:11:42.036107 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:11:42.037107 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:11:42.651918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3194B6930>]}
[0m19:11:42.775306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3193B03E0>]}
[0m19:11:42.776306 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:11:42.797307 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:11:44.146554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:44.147555 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:11:44.305772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:11:44.311806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31ABC70E0>]}
[0m19:11:44.339773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31A984770>]}
[0m19:11:44.340773 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:11:44.341774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31A7EA060>]}
[0m19:11:44.342808 [info ] [MainThread]: 
[0m19:11:44.343906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:11:44.345949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:11:44.360958 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:11:44.361955 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:11:44.361955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:45.533890 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:11:45.536906 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:11:45.680934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m19:11:45.691929 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:11:45.691929 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:11:45.692932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:46.086299 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:11:46.089296 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:11:46.229626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m19:11:46.234627 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:11:46.234627 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:11:46.235627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:46.800637 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:11:46.807698 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:11:46.961871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31AC2EC90>]}
[0m19:11:46.962872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:46.962872 [info ] [MainThread]: 
[0m19:11:46.966874 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:11:46.967873 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:11:46.968874 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:11:46.969874 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:11:46.979873 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:11:46.980873 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:11:46.969874 => 19:11:46.980873
[0m19:11:46.981874 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:11:47.018968 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:11:47.022995 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:11:47.022995 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id,
        SUM(revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', transaction_date) = DATE_TRUNC('month', first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    JOIN customer_first_purchase ON MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table.customer_id = customer_first_purchase.customer_id
    GROUP BY month, customer_id, first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    month,
    starting_mrr,
    churned_mrr,
    expansion_mrr,
    (grr / NULLIF(starting_mrr, 0)) * 100 AS grr_percentage,
    (nrr / NULLIF(starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr
ORDER BY month;
[0m19:11:47.023994 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:47.769152 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d5-0001-085a-0000-50e90002f832
[0m19:11:47.769152 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 69 at position 14 unexpected ';'.
[0m19:11:47.770152 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:11:46.981874 => 19:11:47.770152
[0m19:11:47.770152 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:11:47.954853 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:11:47.955857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625ce59e-5902-4696-9f5d-8988c68d5831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31AC7E450>]}
[0m19:11:47.955857 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 0.99s]
[0m19:11:47.957820 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:11:47.960816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:47.961816 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:11:47.961816 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m19:11:47.961816 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:11:47.962816 [info ] [MainThread]: 
[0m19:11:47.963815 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m19:11:47.964818 [debug] [MainThread]: Command end result
[0m19:11:47.976816 [info ] [MainThread]: 
[0m19:11:47.977817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:11:47.978817 [info ] [MainThread]: 
[0m19:11:47.979867 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 69 at position 14 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:11:47.980816 [info ] [MainThread]: 
[0m19:11:47.981815 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:11:47.983612 [debug] [MainThread]: Command `dbt run` failed at 19:11:47.982568 after 6.07 seconds
[0m19:11:47.983612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3189A5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3187DDCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318B264E0>]}
[0m19:11:47.984613 [debug] [MainThread]: Flushing usage events
[0m19:11:57.515035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94CBE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94CBE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94CBDC70>]}


============================== 19:11:57.520071 | 93818e03-70f7-4469-aac8-c19ff5f24155 ==============================
[0m19:11:57.520071 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:11:57.521071 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:11:58.028609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F9687CB00>]}
[0m19:11:58.131227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96826B10>]}
[0m19:11:58.133141 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:11:58.141782 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:11:58.252216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:58.253216 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:11:58.408125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:11:58.414437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96C6CEC0>]}
[0m19:11:58.426438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96B04BC0>]}
[0m19:11:58.427406 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:11:58.428403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96B048C0>]}
[0m19:11:58.429405 [info ] [MainThread]: 
[0m19:11:58.448383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:11:58.450379 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:11:58.465961 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:11:58.465961 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:11:58.467008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:59.113528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:11:59.114531 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:11:59.265766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m19:11:59.276828 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:11:59.276828 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:11:59.276828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:59.976036 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:11:59.983120 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:12:00.135500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m19:12:00.150501 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:12:00.152503 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:12:00.154498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:00.728052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:12:00.734067 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:12:00.890220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96D6F680>]}
[0m19:12:00.891246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:00.892245 [info ] [MainThread]: 
[0m19:12:00.896111 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:12:00.896111 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:12:00.897272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:12:00.898313 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:12:00.908280 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:12:00.909316 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:12:00.898313 => 19:12:00.909316
[0m19:12:00.910313 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:12:00.943312 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:12:00.947283 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:12:00.948278 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', transaction_date) AS month,
        customer_id,
        SUM(revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', transaction_date) = DATE_TRUNC('month', first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table 
    JOIN customer_first_purchase ON MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table.customer_id = customer_first_purchase.customer_id
    GROUP BY month, customer_id, first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    month,
    starting_mrr,
    churned_mrr,
    expansion_mrr,
    (grr / NULLIF(starting_mrr, 0)) * 100 AS grr_percentage,
    (nrr / NULLIF(starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr
ORDER BY month
        );
[0m19:12:00.948278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:01.410402 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d6-0001-086e-0000-50e90003075e
[0m19:12:01.411403 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m19:12:01.411403 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:12:00.910313 => 19:12:01.411403
[0m19:12:01.412403 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:12:01.568648 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:12:01.570639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93818e03-70f7-4469-aac8-c19ff5f24155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F96CFF9E0>]}
[0m19:12:01.571644 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 0.67s]
[0m19:12:01.573644 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:12:01.577639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:01.578640 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:12:01.578640 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m19:12:01.579642 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:12:01.580636 [info ] [MainThread]: 
[0m19:12:01.581634 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m19:12:01.582601 [debug] [MainThread]: Command end result
[0m19:12:01.599149 [info ] [MainThread]: 
[0m19:12:01.600154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:01.601155 [info ] [MainThread]: 
[0m19:12:01.602188 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:12:01.603180 [info ] [MainThread]: 
[0m19:12:01.604151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:01.606151 [debug] [MainThread]: Command `dbt run` failed at 19:12:01.606151 after 4.18 seconds
[0m19:12:01.606151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94D12B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94B38560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F94CE96D0>]}
[0m19:12:01.607189 [debug] [MainThread]: Flushing usage events
[0m19:17:14.668802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F2BA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F2BA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F2BA000>]}


============================== 19:17:14.673802 | 1c93681a-8dbf-45f8-aabf-1e8259c83765 ==============================
[0m19:17:14.673802 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:17:14.674767 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:17:15.201251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F31A5A0>]}
[0m19:17:15.314795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D190BAFBC0>]}
[0m19:17:15.315790 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:17:15.326791 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:17:15.444487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:15.445488 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:17:15.602879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:17:15.609242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D190F9A330>]}
[0m19:17:15.623250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D191104AD0>]}
[0m19:17:15.624243 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:17:15.624243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1912077A0>]}
[0m19:17:15.626243 [info ] [MainThread]: 
[0m19:17:15.628211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:15.629209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:17:15.645242 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:17:15.646243 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:17:15.646243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:16.871054 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:17:16.873086 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:17:17.024563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_transform'
[0m19:17:17.038549 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:17:17.038549 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:17:17.039552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:17.488282 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:17:17.492239 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:17:17.637437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_transform, now list_MINI_PROJECT_OUTPUT_DB_staging)
[0m19:17:17.641437 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:17:17.641437 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:17:17.642438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:18.229148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:17:18.232169 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:17:18.372531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1913718B0>]}
[0m19:17:18.373531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:18.374541 [info ] [MainThread]: 
[0m19:17:18.378530 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:17:18.378530 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:17:18.380531 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:17:18.380531 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:17:18.390575 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:17:18.392533 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:17:18.380531 => 19:17:18.392533
[0m19:17:18.393564 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:17:18.427156 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:17:18.432122 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:17:18.432122 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (

WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', t.transaction_date) AS month,
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', t.transaction_date) = DATE_TRUNC('month', cfp.first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table t
    JOIN customer_first_purchase cfp ON t.customer_id = cfp.customer_id
    GROUP BY month, t.customer_id, cfp.first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    n.month,
    n.starting_mrr,
    n.churned_mrr,
    n.expansion_mrr,
    (n.grr / NULLIF(n.starting_mrr, 0)) * 100 AS grr_percentage,
    (n.nrr / NULLIF(n.starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr n
ORDER BY n.month;
[0m19:17:18.433157 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:18.978426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00db-0001-086e-0000-50e900030762
[0m19:17:18.978426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 71 at position 16 unexpected ';'.
[0m19:17:18.979427 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:17:18.393564 => 19:17:18.979427
[0m19:17:18.980427 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:17:19.122983 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 71 at position 16 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:17:19.122983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c93681a-8dbf-45f8-aabf-1e8259c83765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D191500410>]}
[0m19:17:19.123984 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 0.74s]
[0m19:17:19.124984 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:17:19.128021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:19.129017 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:17:19.129017 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_staging' was properly closed.
[0m19:17:19.129017 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:17:19.130021 [info ] [MainThread]: 
[0m19:17:19.130983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m19:17:19.131985 [debug] [MainThread]: Command end result
[0m19:17:19.145036 [info ] [MainThread]: 
[0m19:17:19.145036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:17:19.145983 [info ] [MainThread]: 
[0m19:17:19.146983 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 71 at position 16 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:17:19.148047 [info ] [MainThread]: 
[0m19:17:19.148983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:19.149983 [debug] [MainThread]: Command `dbt run` failed at 19:17:19.149983 after 4.57 seconds
[0m19:17:19.150984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18F0BC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18EED1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18EE39F10>]}
[0m19:17:19.150984 [debug] [MainThread]: Flushing usage events
[0m19:17:30.613127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D057A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D057A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D0579D60>]}


============================== 19:17:30.618126 | cb0d4cf9-a551-4c95-a161-c1354322a9aa ==============================
[0m19:17:30.618126 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:17:30.619125 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:17:31.123081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D01F7530>]}
[0m19:17:31.222705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D05A8200>]}
[0m19:17:31.224672 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:17:31.233707 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:17:31.343225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:31.344225 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:17:31.497335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:17:31.503368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D2196960>]}
[0m19:17:31.515368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D23C4920>]}
[0m19:17:31.516370 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:17:31.517335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D252D6A0>]}
[0m19:17:31.519369 [info ] [MainThread]: 
[0m19:17:31.520392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:31.522336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:17:31.539370 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:17:31.539370 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:17:31.540370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:32.584610 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:17:32.590614 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:17:32.746059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m19:17:32.758061 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:17:32.759060 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:17:32.759060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:33.307794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:17:33.309786 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:17:33.451514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m19:17:33.454516 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:17:33.455516 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:17:33.455516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:33.869197 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:17:33.873154 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:17:34.018269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CFD82A80>]}
[0m19:17:34.020271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:34.021231 [info ] [MainThread]: 
[0m19:17:34.030219 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:17:34.031220 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:17:34.032221 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:17:34.033253 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:17:34.042253 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:17:34.044218 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:17:34.033253 => 19:17:34.043252
[0m19:17:34.044218 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:17:34.080294 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:17:34.084292 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:17:34.085293 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (

WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', t.transaction_date) AS month,
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', t.transaction_date) = DATE_TRUNC('month', cfp.first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table t
    JOIN customer_first_purchase cfp ON t.customer_id = cfp.customer_id
    GROUP BY month, t.customer_id, cfp.first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue < 0  
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(total_revenue) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' AND total_revenue > 0  
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    n.month,
    n.starting_mrr,
    n.churned_mrr,
    n.expansion_mrr,
    (n.grr / NULLIF(n.starting_mrr, 0)) * 100 AS grr_percentage,
    (n.nrr / NULLIF(n.starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr n
ORDER BY n.month
        );
[0m19:17:34.085293 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:35.655047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:17:35.677003 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:17:34.045219 => 19:17:35.676002
[0m19:17:35.677003 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:17:35.822261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb0d4cf9-a551-4c95-a161-c1354322a9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D27B0800>]}
[0m19:17:35.823217 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.nrr_grr ............................ [[32mSUCCESS 1[0m in 1.79s]
[0m19:17:35.824230 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:17:35.826797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:35.826797 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:17:35.827797 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m19:17:35.827797 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:17:35.827797 [info ] [MainThread]: 
[0m19:17:35.829119 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m19:17:35.830127 [debug] [MainThread]: Command end result
[0m19:17:35.893169 [info ] [MainThread]: 
[0m19:17:35.893875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:35.894885 [info ] [MainThread]: 
[0m19:17:35.894885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:17:35.896916 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:35.896916 after 5.39 seconds
[0m19:17:35.896916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D20AB740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D068B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D01835C0>]}
[0m19:17:35.897916 [debug] [MainThread]: Flushing usage events
[0m19:20:23.337729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1822A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1822A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF18229EE0>]}


============================== 19:20:23.342714 | 936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd ==============================
[0m19:20:23.342714 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:20:23.343533 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:20:23.853943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF19DEC170>]}
[0m19:20:23.954601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF182AACC0>]}
[0m19:20:23.956690 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:20:23.965349 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:20:24.078938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:24.078938 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:20:24.235568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:20:24.241356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF19FA9A00>]}
[0m19:20:24.255321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1A074950>]}
[0m19:20:24.256359 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:20:24.257322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1A1956A0>]}
[0m19:20:24.259323 [info ] [MainThread]: 
[0m19:20:24.260323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:24.262322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:20:24.281327 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:20:24.282324 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:20:24.283330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:25.381520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:20:25.384522 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:20:25.585590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m19:20:25.595589 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:20:25.596589 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:20:25.596589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:26.742430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:20:26.744428 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:20:26.908896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m19:20:26.912894 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:20:26.912894 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:20:26.913894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:27.792603 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m19:20:27.795624 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:20:27.947683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1A2501A0>]}
[0m19:20:27.947683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:27.949093 [info ] [MainThread]: 
[0m19:20:27.953843 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:20:27.953843 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:20:27.955844 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:20:27.955844 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:20:27.966854 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:20:27.967852 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:20:27.956861 => 19:20:27.967852
[0m19:20:27.968864 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:20:28.004368 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:20:28.008362 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:20:28.009365 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (

WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', t.transaction_date) AS month,
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', t.transaction_date) = DATE_TRUNC('month', cfp.first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table t
    JOIN customer_first_purchase cfp ON t.customer_id = cfp.customer_id
    GROUP BY month, t.customer_id, cfp.first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN total_revenue < 0 THEN total_revenue ELSE 0 END) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' 
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN total_revenue > 0 THEN total_revenue ELSE 0 END) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' 
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    n.month,
    n.starting_mrr,
    n.churned_mrr,
    n.expansion_mrr,
    (n.grr / NULLIF(n.starting_mrr, 0)) * 100 AS grr_percentage,
    (n.nrr / NULLIF(n.starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr n
ORDER BY n.month;
[0m19:20:28.009365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:28.934051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00de-0001-085a-0000-50e90002f8da
[0m19:20:28.935051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 71 at position 16 unexpected ';'.
[0m19:20:28.936051 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:20:27.968864 => 19:20:28.935051
[0m19:20:28.936051 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:20:29.123226 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 71 at position 16 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:20:29.124227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936a22d7-f5bd-4c77-a1df-d23d6f9ccfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1A2AF6E0>]}
[0m19:20:29.126193 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model transform.nrr_grr ........................ [[31mERROR[0m in 1.17s]
[0m19:20:29.128185 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:20:29.133221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:29.134184 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:20:29.134184 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m19:20:29.135221 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:20:29.136221 [info ] [MainThread]: 
[0m19:20:29.137182 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m19:20:29.139179 [debug] [MainThread]: Command end result
[0m19:20:29.154179 [info ] [MainThread]: 
[0m19:20:29.155215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:20:29.156213 [info ] [MainThread]: 
[0m19:20:29.157179 [error] [MainThread]:   Database Error in model nrr_grr (models\transform\nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 71 at position 16 unexpected ';'.
  compiled Code at target\run\mini_project_dbt\models\transform\nrr_grr.sql
[0m19:20:29.158176 [info ] [MainThread]: 
[0m19:20:29.158176 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:20:29.160179 [debug] [MainThread]: Command `dbt run` failed at 19:20:29.160179 after 5.91 seconds
[0m19:20:29.161177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF1812B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF19F40CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CF18A64C50>]}
[0m19:20:29.161177 [debug] [MainThread]: Flushing usage events
[0m19:20:39.663586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12F6A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12F6A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12F6A030>]}


============================== 19:20:39.669581 | 7ef08c69-d82d-4dae-843a-f00614bf0810 ==============================
[0m19:20:39.669581 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:20:39.670552 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m nrr_grr', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\TottaraDhanush\\DBT\\mini_project_dbt\\logs', 'profiles_dir': 'C:\\Users\\TottaraDhanush\\.dbt', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False'}
[0m19:20:40.182030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B142F0E00>]}
[0m19:20:40.282618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B14832480>]}
[0m19:20:40.284585 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:20:40.293618 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:20:40.404270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:40.405270 [debug] [MainThread]: Partial parsing: updated file: mini_project_dbt://models\transform\nrr_grr.sql
[0m19:20:40.559446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mini_project_dbt.mart
[0m19:20:40.565482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12F69A00>]}
[0m19:20:40.578483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B14D5C170>]}
[0m19:20:40.579445 [info ] [MainThread]: Found 11 models, 4 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:20:40.580447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B14B87B90>]}
[0m19:20:40.582480 [info ] [MainThread]: 
[0m19:20:40.583448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:40.586479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB'
[0m19:20:40.601526 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB"
[0m19:20:40.601526 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB"} */
show terse schemas in database MINI_PROJECT_OUTPUT_DB
    limit 10000
[0m19:20:40.602490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:41.653689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m19:20:41.659671 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB: Close
[0m19:20:41.809721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_OUTPUT_DB_staging'
[0m19:20:41.820720 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_staging"
[0m19:20:41.820720 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_staging"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.staging limit 10000
[0m19:20:41.821721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:42.649935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:20:42.656934 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_staging: Close
[0m19:20:42.856879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MINI_PROJECT_OUTPUT_DB_staging, now list_MINI_PROJECT_OUTPUT_DB_transform)
[0m19:20:42.859847 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_OUTPUT_DB_transform"
[0m19:20:42.859847 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "connection_name": "list_MINI_PROJECT_OUTPUT_DB_transform"} */
show terse objects in MINI_PROJECT_OUTPUT_DB.transform limit 10000
[0m19:20:42.860847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:43.264359 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m19:20:43.265360 [debug] [ThreadPool]: On list_MINI_PROJECT_OUTPUT_DB_transform: Close
[0m19:20:43.587107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B14FA33E0>]}
[0m19:20:43.588094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:43.589059 [info ] [MainThread]: 
[0m19:20:43.592610 [debug] [Thread-1 (]: Began running node model.mini_project_dbt.nrr_grr
[0m19:20:43.593610 [info ] [Thread-1 (]: 1 of 1 START sql table model transform.nrr_grr ................................. [RUN]
[0m19:20:43.594628 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project_dbt.nrr_grr'
[0m19:20:43.595610 [debug] [Thread-1 (]: Began compiling node model.mini_project_dbt.nrr_grr
[0m19:20:43.604610 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project_dbt.nrr_grr"
[0m19:20:43.606612 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (compile): 19:20:43.595610 => 19:20:43.605611
[0m19:20:43.607612 [debug] [Thread-1 (]: Began executing node model.mini_project_dbt.nrr_grr
[0m19:20:43.642682 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project_dbt.nrr_grr"
[0m19:20:43.647244 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project_dbt.nrr_grr"
[0m19:20:43.647244 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "mini_project_dbt", "target_name": "dev", "node_id": "model.mini_project_dbt.nrr_grr"} */
create or replace transient table MINI_PROJECT_OUTPUT_DB.transform.nrr_grr
         as
        (

WITH customer_first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table  
    GROUP BY customer_id
),
monthly_revenue AS (
    SELECT
        DATE_TRUNC('month', t.transaction_date) AS month,
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        CASE 
            WHEN DATE_TRUNC('month', t.transaction_date) = DATE_TRUNC('month', cfp.first_purchase_date) THEN 'new' 
            ELSE 'existing' 
        END AS customer_type
    FROM MINI_PROJECT_OUTPUT_DB.staging.staging_transactions_table t
    JOIN customer_first_purchase cfp ON t.customer_id = cfp.customer_id
    GROUP BY month, t.customer_id, cfp.first_purchase_date
),
starting_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN customer_type = 'existing' THEN total_revenue ELSE 0 END) AS starting_mrr,
        SUM(CASE WHEN customer_type = 'new' THEN total_revenue ELSE 0 END) AS new_mrr
    FROM monthly_revenue
    WHERE month = (SELECT MIN(month) FROM monthly_revenue) 
    GROUP BY month
),
churned_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN total_revenue < 0 THEN total_revenue ELSE 0 END) AS churned_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' 
    GROUP BY month
),
expansion_mrr AS (
    SELECT
        month,
        SUM(CASE WHEN total_revenue > 0 THEN total_revenue ELSE 0 END) AS expansion_mrr
    FROM monthly_revenue
    WHERE customer_type = 'existing' 
    GROUP BY month
),
nrr_grr AS (
    SELECT
        m.month,
        sm.starting_mrr,
        COALESCE(cm.churned_mrr, 0) AS churned_mrr,
        COALESCE(em.expansion_mrr, 0) AS expansion_mrr,
        (sm.starting_mrr - COALESCE(cm.churned_mrr, 0)) AS grr,
        (sm.starting_mrr + COALESCE(em.expansion_mrr, 0) - COALESCE(cm.churned_mrr, 0)) AS nrr
    FROM (SELECT DISTINCT month FROM monthly_revenue) m
    LEFT JOIN starting_mrr sm ON m.month = sm.month
    LEFT JOIN churned_mrr cm ON m.month = cm.month
    LEFT JOIN expansion_mrr em ON m.month = em.month
)
SELECT
    n.month,
    n.starting_mrr,
    n.churned_mrr,
    n.expansion_mrr,
    (n.grr / NULLIF(n.starting_mrr, 0)) * 100 AS grr_percentage,
    (n.nrr / NULLIF(n.starting_mrr, 0)) * 100 AS nrr_percentage
FROM nrr_grr n
ORDER BY n.month
        );
[0m19:20:43.648244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:45.177080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:20:45.202019 [debug] [Thread-1 (]: Timing info for model.mini_project_dbt.nrr_grr (execute): 19:20:43.607612 => 19:20:45.201050
[0m19:20:45.202019 [debug] [Thread-1 (]: On model.mini_project_dbt.nrr_grr: Close
[0m19:20:45.379937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ef08c69-d82d-4dae-843a-f00614bf0810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B15043830>]}
[0m19:20:45.380934 [info ] [Thread-1 (]: 1 of 1 OK created sql table model transform.nrr_grr ............................ [[32mSUCCESS 1[0m in 1.79s]
[0m19:20:45.381904 [debug] [Thread-1 (]: Finished running node model.mini_project_dbt.nrr_grr
[0m19:20:45.383856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:45.383856 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB' was properly closed.
[0m19:20:45.384858 [debug] [MainThread]: Connection 'list_MINI_PROJECT_OUTPUT_DB_transform' was properly closed.
[0m19:20:45.384858 [debug] [MainThread]: Connection 'model.mini_project_dbt.nrr_grr' was properly closed.
[0m19:20:45.385856 [info ] [MainThread]: 
[0m19:20:45.385856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m19:20:45.387859 [debug] [MainThread]: Command end result
[0m19:20:45.451862 [info ] [MainThread]: 
[0m19:20:45.452863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:45.453873 [info ] [MainThread]: 
[0m19:20:45.453873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:45.456473 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:45.455417 after 5.88 seconds
[0m19:20:45.456473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12AFEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12DFB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B12F9A1E0>]}
[0m19:20:45.457461 [debug] [MainThread]: Flushing usage events
